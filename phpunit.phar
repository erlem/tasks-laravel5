#!/usr/bin/env php
<?php
if (version_compare('5.6.0', PHP_VERSION, '>')) {
    fwrite(
        STDERR,
        'This version of PHPUnit requires PHP 5.6; using the latest version of PHP is highly recommended.' . PHP_EOL
    );

    die(1);
}

if (__FILE__ == realpath($GLOBALS['_SERVER']['SCRIPT_NAME'])) {
    $execute = true;
} else {
    $execute = false;
}

define('__PHPUNIT_PHAR__', str_replace(DIRECTORY_SEPARATOR, '/', __FILE__));
define('__PHPUNIT_PHAR_ROOT__', 'phar://phpunit-5.0.9.phar');

Phar::mapPhar('phpunit-5.0.9.phar');

require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/DeepCopy.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/Exception/CloneException.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/Filter/Filter.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/Filter/Doctrine/DoctrineCollectionFilter.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/Filter/Doctrine/DoctrineEmptyCollectionFilter.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/Filter/KeepFilter.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/Filter/ReplaceFilter.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/Filter/SetNullFilter.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/Matcher/Matcher.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/Matcher/PropertyMatcher.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/Matcher/PropertyNameMatcher.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/Matcher/PropertyTypeMatcher.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/Reflection/ReflectionHelper.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/TypeFilter/TypeFilter.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/TypeFilter/ReplaceFilter.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/TypeFilter/ShallowCopyFilter.php';
require 'phar://phpunit-5.0.9.phar' . '/myclabs-deep-copy/DeepCopy/TypeMatcher/TypeMatcher.php';
require 'phar://phpunit-5.0.9.phar' . '/doctrine-instantiator/Doctrine/Instantiator/Exception/ExceptionInterface.php';
require 'phar://phpunit-5.0.9.phar' . '/doctrine-instantiator/Doctrine/Instantiator/Exception/InvalidArgumentException.php';
require 'phar://phpunit-5.0.9.phar' . '/doctrine-instantiator/Doctrine/Instantiator/Exception/UnexpectedValueException.php';
require 'phar://phpunit-5.0.9.phar' . '/doctrine-instantiator/Doctrine/Instantiator/InstantiatorInterface.php';
require 'phar://phpunit-5.0.9.phar' . '/doctrine-instantiator/Doctrine/Instantiator/Instantiator.php';
require 'phar://phpunit-5.0.9.phar' . '/php-file-iterator/Iterator.php';
require 'phar://phpunit-5.0.9.phar' . '/php-file-iterator/Facade.php';
require 'phar://phpunit-5.0.9.phar' . '/php-file-iterator/Factory.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Exception.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/ITester.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/AbstractTester.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/SelfDescribing.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Constraint/DataSetIsEqual.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Constraint/TableIsEqual.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Constraint/TableRowCount.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/IDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/AbstractDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/DataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/IDatabaseConnection.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/DefaultDatabaseConnection.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/FilteredDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/IMetaData.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/MetaData.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/MetaData/Dblib.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/MetaData/Firebird.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/MetaData/InformationSchema.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/MetaData/MySQL.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/MetaData/Oci.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/MetaData/PgSQL.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/MetaData/SqlSrv.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/MetaData/Sqlite.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/ITable.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/AbstractTable.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/ResultSetTable.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/Table.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/ITableIterator.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/TableIterator.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/ITableMetaData.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/AbstractTableMetaData.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/DefaultTableMetaData.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DB/TableMetaData.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/AbstractXmlDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/ArrayDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/CompositeDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/CsvDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/DataSetFilter.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/DefaultDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/DefaultTable.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/DefaultTableIterator.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/FlatXmlDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/IPersistable.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/ISpec.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/IYamlParser.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/MysqlXmlDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/Persistors/Abstract.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/Persistors/Factory.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/Persistors/FlatXml.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/Persistors/MysqlXml.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/Persistors/Xml.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/Persistors/Yaml.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/QueryDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/QueryTable.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/ReplacementDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/ReplacementTable.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/ReplacementTableIterator.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/Specs/Csv.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/IDatabaseListConsumer.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/Specs/DbQuery.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/Specs/DbTable.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/Specs/IFactory.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/Specs/Factory.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/Specs/FlatXml.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/Specs/Xml.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/Specs/Yaml.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/SymfonyYamlParser.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/TableFilter.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/TableMetaDataFilter.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/XmlDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DataSet/YamlDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/DefaultTester.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Exception.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Operation/IDatabaseOperation.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Operation/Composite.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Operation/RowBased.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Operation/Delete.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Operation/DeleteAll.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Operation/Exception.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Operation/Factory.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Operation/Insert.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Operation/Null.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Operation/Replace.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Operation/Truncate.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/Operation/Update.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Test.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Assert.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/TestCase.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/TestCaseTrait.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/TestCase.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/UI/Command.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/UI/Context.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/UI/IMediumPrinter.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/UI/IMedium.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/UI/IMode.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/UI/IModeFactory.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/UI/InvalidModeException.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/UI/Mediums/Text.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/UI/ModeFactory.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/UI/Modes/ExportDataSet.php';
require 'phar://phpunit-5.0.9.phar' . '/dbunit/Extensions/Database/UI/Modes/ExportDataSet/Arguments.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/TestSuite.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Extensions/GroupTestSuite.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Extensions/PhptTestCase.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Extensions/PhptTestSuite.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Extensions/TestDecorator.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Extensions/RepeatedTest.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/TestListener.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Extensions/TicketListener.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Exception.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/AssertionFailedError.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/BaseTestListener.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/CodeCoverageException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/And.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/ArrayHasKey.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/ArraySubset.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/Composite.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/Attribute.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/Callback.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/ClassHasAttribute.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/ClassHasStaticAttribute.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/Count.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/Exception.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/ExceptionCode.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/ExceptionMessage.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/ExceptionMessageRegExp.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/FileExists.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/GreaterThan.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/IsAnything.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/IsEmpty.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/IsEqual.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/IsFalse.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/IsFinite.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/IsIdentical.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/IsInfinite.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/IsInstanceOf.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/IsJson.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/IsNan.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/IsNull.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/IsTrue.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/IsType.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/JsonMatches.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/JsonMatches/ErrorMessageProvider.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/LessThan.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/Not.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/ObjectHasAttribute.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/Or.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/PCREMatch.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/SameSize.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/StringContains.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/StringEndsWith.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/StringMatches.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/StringStartsWith.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/TraversableContains.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/TraversableContainsOnly.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Constraint/Xor.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Error.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Error/Deprecated.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Error/Notice.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Error/Warning.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/ExceptionWrapper.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/ExpectationFailedException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/IncompleteTest.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/IncompleteTestCase.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/IncompleteTestError.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/SkippedTest.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/InvalidCoversTargetError.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/InvalidCoversTargetException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Exception/Exception.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Exception/BadMethodCallException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Builder/Identity.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Builder/Stub.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Builder/Match.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Builder/ParametersMatch.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Builder/MethodNameMatch.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Builder/InvocationMocker.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Builder/Namespace.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Generator.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Invocation.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Stub/MatcherCollection.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Verifiable.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Invokable.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/InvocationMocker.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Invocation/Static.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Invocation/Object.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Matcher/Invocation.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Matcher.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Matcher/InvokedRecorder.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Matcher/AnyInvokedCount.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Matcher/StatelessInvocation.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Matcher/AnyParameters.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Matcher/ConsecutiveParameters.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Matcher/InvokedAtIndex.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Matcher/InvokedAtLeastCount.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Matcher/InvokedAtLeastOnce.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Matcher/InvokedAtMostCount.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Matcher/InvokedCount.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Matcher/MethodName.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Matcher/Parameters.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/MockBuilder.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/MockObject.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Exception/RuntimeException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Stub.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Stub/ConsecutiveCalls.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Stub/Exception.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Stub/Return.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Stub/ReturnArgument.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Stub/ReturnCallback.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Stub/ReturnSelf.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit-mock-objects/Framework/MockObject/Stub/ReturnValueMap.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/OutputError.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/RiskyTest.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/RiskyTestError.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/SkippedTestCase.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/SkippedTestError.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/SkippedTestSuiteError.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/SyntheticError.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/TestFailure.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/TestResult.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/TestSuite/DataProvider.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/UnintentionallyCoveredCodeError.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Framework/Warning.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Runner/BaseTestRunner.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Runner/Exception.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Runner/Filter/Factory.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Runner/Filter/Group.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Runner/Filter/Group/Exclude.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Runner/Filter/Group/Include.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Runner/Filter/Test.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Runner/TestSuiteLoader.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Runner/StandardTestSuiteLoader.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Runner/Version.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/TextUI/Command.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/Printer.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/TextUI/ResultPrinter.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/TextUI/TestRunner.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/Blacklist.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/Configuration.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/ErrorHandler.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/Fileloader.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/Filesystem.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/Filter.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/Getopt.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/GlobalState.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/InvalidArgumentHelper.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/Log/JSON.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/Log/JUnit.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/Log/TAP.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/Log/TeamCity.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/PHP.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/PHP/Default.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/PHP/Windows.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/Regex.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/String.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/Test.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/TestDox/NamePrettifier.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/TestDox/ResultPrinter.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/TestDox/ResultPrinter/HTML.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/TestDox/ResultPrinter/Text.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/TestSuiteIterator.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/Type.php';
require 'phar://phpunit-5.0.9.phar' . '/phpunit/Util/XML.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Driver.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Driver/Xdebug.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Driver/HHVM.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Driver/PHPDBG.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Exception/Exception.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Filter.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Exception/InvalidArgumentException.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/Clover.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/Crap4j.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/Factory.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/HTML.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/HTML/Renderer.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/HTML/Renderer/Dashboard.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/HTML/Renderer/Directory.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/HTML/Renderer/File.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/Node.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/Node/Directory.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/Node/File.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/Node/Iterator.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/PHP.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/Text.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/XML.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/XML/Node.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/XML/Directory.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/XML/File.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/XML/File/Coverage.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/XML/File/Method.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/XML/File/Report.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/XML/File/Unit.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/XML/Project.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/XML/Tests.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Report/XML/Totals.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Exception/RuntimeException.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Exception/UnintentionallyCoveredCodeException.php';
require 'phar://phpunit-5.0.9.phar' . '/php-code-coverage/CodeCoverage/Util.php';
require 'phar://phpunit-5.0.9.phar' . '/php-invoker/Invoker.php';
require 'phar://phpunit-5.0.9.phar' . '/php-invoker/TimeoutException.php';
require 'phar://phpunit-5.0.9.phar' . '/php-timer/Timer.php';
require 'phar://phpunit-5.0.9.phar' . '/php-token-stream/Token.php';
require 'phar://phpunit-5.0.9.phar' . '/php-token-stream/Token/Stream.php';
require 'phar://phpunit-5.0.9.phar' . '/php-token-stream/Token/Stream/CachingFactory.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/ArgumentsWildcard.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/Token/TokenInterface.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/Token/AnyValueToken.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/Token/AnyValuesToken.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/Token/ArrayCountToken.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/Token/ArrayEntryToken.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/Token/ArrayEveryEntryToken.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/Token/CallbackToken.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/Token/ExactValueToken.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/Token/IdenticalValueToken.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/Token/LogicalAndToken.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/Token/LogicalNotToken.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/Token/ObjectStateToken.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/Token/StringContainsToken.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Argument/Token/TypeToken.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Call/Call.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Call/CallCenter.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/Comparator.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Comparator/ClosureComparator.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/Factory.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Comparator/Factory.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/Doubler.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/CachedDoubler.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/ClassPatch/ClassPatchInterface.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/ClassPatch/DisableConstructorPatch.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/ClassPatch/HhvmExceptionPatch.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/ClassPatch/KeywordPatch.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/ClassPatch/MagicCallPatch.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/ClassPatch/ProphecySubjectPatch.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/ClassPatch/ReflectionClassNewInstancePatch.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/ClassPatch/SplFileInfoPatch.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/ClassPatch/TraversablePatch.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/DoubleInterface.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/Generator/ClassCodeGenerator.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/Generator/ClassCreator.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/Generator/ClassMirror.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/Generator/Node/ArgumentNode.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/Generator/Node/ClassNode.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/Generator/Node/MethodNode.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/Generator/ReflectionInterface.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/LazyDouble.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Doubler/NameGenerator.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Exception.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Prophecy/ProphecyException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Prophecy/ObjectProphecyException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Call/UnexpectedCallException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Doubler/DoublerException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Doubler/ClassCreatorException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Doubler/ClassMirrorException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Doubler/DoubleException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Doubler/ClassNotFoundException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Doubler/InterfaceNotFoundException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Doubler/MethodNotFoundException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Doubler/ReturnByReferenceException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/InvalidArgumentException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Prediction/PredictionException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Prediction/AggregateException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Prediction/FailedPredictionException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Prophecy/MethodProphecyException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Prediction/NoCallsException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Prediction/UnexpectedCallsException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Exception/Prediction/UnexpectedCallsCountException.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Prediction/PredictionInterface.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Prediction/CallPrediction.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Prediction/CallTimesPrediction.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Prediction/CallbackPrediction.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Prediction/NoCallsPrediction.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Promise/PromiseInterface.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Promise/CallbackPromise.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Promise/ReturnArgumentPromise.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Promise/ReturnPromise.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Promise/ThrowPromise.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Prophecy/MethodProphecy.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Prophecy/ProphecyInterface.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Prophecy/ObjectProphecy.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Prophecy/ProphecySubjectInterface.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Prophecy/RevealerInterface.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Prophecy/Revealer.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Prophet.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Util/ExportUtil.php';
require 'phar://phpunit-5.0.9.phar' . '/phpspec-prophecy/Prophecy/Util/StringUtil.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/ArrayComparator.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/ComparisonFailure.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/ObjectComparator.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/DOMNodeComparator.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/DateTimeComparator.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/ScalarComparator.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/NumericComparator.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/DoubleComparator.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/ExceptionComparator.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/MockObjectComparator.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/ResourceComparator.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/SplObjectStorageComparator.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-comparator/TypeComparator.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-diff/Chunk.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-diff/Diff.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-diff/Differ.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-diff/LCS/LongestCommonSubsequence.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-diff/LCS/MemoryEfficientLongestCommonSubsequenceImplementation.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-diff/LCS/TimeEfficientLongestCommonSubsequenceImplementation.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-diff/Line.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-diff/Parser.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-environment/Console.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-environment/Runtime.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-exporter/Exporter.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-global-state/Blacklist.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-global-state/CodeExporter.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-global-state/Exception.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-global-state/Restorer.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-global-state/RuntimeException.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-global-state/Snapshot.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-recursion-context/Context.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-recursion-context/Exception.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-recursion-context/InvalidArgumentException.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-resource-operations/ResourceOperations.php';
require 'phar://phpunit-5.0.9.phar' . '/sebastian-version/Version.php';
require 'phar://phpunit-5.0.9.phar' . '/symfony/yaml/Dumper.php';
require 'phar://phpunit-5.0.9.phar' . '/symfony/yaml/Escaper.php';
require 'phar://phpunit-5.0.9.phar' . '/symfony/yaml/Exception/ExceptionInterface.php';
require 'phar://phpunit-5.0.9.phar' . '/symfony/yaml/Exception/RuntimeException.php';
require 'phar://phpunit-5.0.9.phar' . '/symfony/yaml/Exception/DumpException.php';
require 'phar://phpunit-5.0.9.phar' . '/symfony/yaml/Exception/ParseException.php';
require 'phar://phpunit-5.0.9.phar' . '/symfony/yaml/Inline.php';
require 'phar://phpunit-5.0.9.phar' . '/symfony/yaml/Parser.php';
require 'phar://phpunit-5.0.9.phar' . '/symfony/yaml/Unescaper.php';
require 'phar://phpunit-5.0.9.phar' . '/symfony/yaml/Yaml.php';
require 'phar://phpunit-5.0.9.phar' . '/php-text-template/Template.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Context.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Description.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Location.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Serializer.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/AuthorTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/SeeTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/CoversTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/VersionTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/DeprecatedTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/SourceTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/ExampleTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/LinkTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/ReturnTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/MethodTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/ParamTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/PropertyTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/PropertyReadTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/PropertyWriteTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/SinceTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/ThrowsTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/UsesTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/VarTag.php';
require 'phar://phpunit-5.0.9.phar' . '/phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Type/Collection.php';

if ($execute) {
    if (isset($_SERVER['argv'][1]) && $_SERVER['argv'][1] == '--manifest') {
        print file_get_contents(__PHPUNIT_PHAR_ROOT__ . '/manifest.txt');
        exit;
    }

    PHPUnit_TextUI_Command::main();
}

__HALT_COMPILER(); ?>
Y¶           phpunit-5.0.9.phar    $   sebastian-global-state/Exception.php?  lgBV?  …∂      #   sebastian-global-state/Snapshot.phpÂ%  lgBVÂ%  √ñS›∂         sebastian-global-state/LICENSE
  lgBV
  è`∂      #   sebastian-global-state/Restorer.phpß  lgBVß  ”ì;\∂      $   sebastian-global-state/Blacklist.php[  lgBV[  :Æ∂      +   sebastian-global-state/RuntimeException.phpq  lgBVq  ø~]!∂      '   sebastian-global-state/CodeExporter.phpõ  lgBVõ  `÷(C∂         php-text-template/LICENSE  lgBV  SÒ:¸∂         php-text-template/Template.phpî  lgBVî  Øw4Ø∂         sebastian-diff/LICENSE  lgBV  vEv√∂      /   sebastian-diff/LCS/LongestCommonSubsequence.php∫  lgBV∫  ªÿõ∂      L   sebastian-diff/LCS/MemoryEfficientLongestCommonSubsequenceImplementation.phpÙ
  lgBVÙ
  É”g8∂      J   sebastian-diff/LCS/TimeEfficientLongestCommonSubsequenceImplementation.php·  lgBV·  äΩ∏r∂         sebastian-diff/Line.phpÈ  lgBVÈ  ¸ºÈŒ∂         sebastian-diff/Differ.php  lgBV  ∫å<6∂         sebastian-diff/Parser.phps  lgBVs  v⁄^∂         sebastian-diff/Diff.php  lgBV  ≤™∂         sebastian-diff/Chunk.php  lgBV  9LKÈ∂         myclabs-deep-copy/LICENSE5  lgBV5   ≠ÀÑ∂      '   myclabs-deep-copy/DeepCopy/DeepCopy.php"  lgBV"  °llí∂      L   myclabs-deep-copy/DeepCopy/Filter/Doctrine/DoctrineEmptyCollectionFilter.phpe  lgBVe  +®÷∂      G   myclabs-deep-copy/DeepCopy/Filter/Doctrine/DoctrineCollectionFilter.php÷  lgBV÷  ∆xk–∂      3   myclabs-deep-copy/DeepCopy/Filter/ReplaceFilter.php  lgBV  Ãé|ˆ∂      3   myclabs-deep-copy/DeepCopy/Filter/SetNullFilter.php≤  lgBV≤  ØM‰ß∂      ,   myclabs-deep-copy/DeepCopy/Filter/Filter.phpS  lgBVS  ks¿k∂      0   myclabs-deep-copy/DeepCopy/Filter/KeepFilter.php˘   lgBV˘   ´ﬂù´∂      7   myclabs-deep-copy/DeepCopy/Exception/CloneException.php`   lgBV`   .⁄ù¸∂      6   myclabs-deep-copy/DeepCopy/TypeMatcher/TypeMatcher.php‰  lgBV‰   ®ö˘∂      :   myclabs-deep-copy/DeepCopy/Reflection/ReflectionHelper.php  lgBV  &‘ã∂      .   myclabs-deep-copy/DeepCopy/Matcher/Matcher.phpÎ   lgBVÎ   (ú(Ì∂      6   myclabs-deep-copy/DeepCopy/Matcher/PropertyMatcher.phpù  lgBVù  u÷÷Ö∂      :   myclabs-deep-copy/DeepCopy/Matcher/PropertyNameMatcher.php‡  lgBV‡  y„ªû∂      :   myclabs-deep-copy/DeepCopy/Matcher/PropertyTypeMatcher.phpí  lgBVí  oÑ¯˘∂      4   myclabs-deep-copy/DeepCopy/TypeFilter/TypeFilter.phpπ   lgBVπ   9ò4·∂      7   myclabs-deep-copy/DeepCopy/TypeFilter/ReplaceFilter.php˙  lgBV˙  µ;If∂      ;   myclabs-deep-copy/DeepCopy/TypeFilter/ShallowCopyFilter.phpÕ   lgBVÕ   ÿ™˛Ü∂         php-timer/Timer.phpE	  lgBVE	  *E˜∂         php-timer/LICENSE  lgBV  «®AE∂         sebastian-comparator/LICENSE	  lgBV	  î:∂      #   sebastian-comparator/Comparator.phpP  lgBVP  !Pã=∂      3   sebastian-comparator/SplObjectStorageComparator.phpù
  lgBVù
  ÁM’Q∂      '   sebastian-comparator/TypeComparator.phpß  lgBVß  ÀQ∂      )   sebastian-comparator/ObjectComparator.php°  lgBV°  ÉËÌw∂      +   sebastian-comparator/ResourceComparator.phpÒ  lgBVÒ  &§w∂      (   sebastian-comparator/ArrayComparator.phpÈ  lgBVÈ  vÀx∂      +   sebastian-comparator/DateTimeComparator.phpì  lgBVì  Ï‰∂      ,   sebastian-comparator/ExceptionComparator.php◊  lgBV◊  †kf ∂      *   sebastian-comparator/DOMNodeComparator.phpì  lgBVì  ≈Ÿ>%∂      )   sebastian-comparator/ScalarComparator.php>  lgBV>  æªB(∂      -   sebastian-comparator/MockObjectComparator.php¥  lgBV¥  ñçÓO∂      *   sebastian-comparator/NumericComparator.php~
  lgBV~
  á7ﬁ‡∂          sebastian-comparator/Factory.phpd  lgBVd  Ÿá1∂      )   sebastian-comparator/DoubleComparator.php7  lgBV7  S¨tŸ∂      *   sebastian-comparator/ComparisonFailure.phpÄ  lgBVÄ  èV∂         phpspec-prophecy/LICENSE}  lgBV}  Ú≈6∂      8   phpspec-prophecy/Prophecy/Prophecy/RevealerInterface.phpH  lgBVH  ágZ∂∂      ?   phpspec-prophecy/Prophecy/Prophecy/ProphecySubjectInterface.phpﬂ  lgBVﬂ  i≤∂      /   phpspec-prophecy/Prophecy/Prophecy/Revealer.phpê  lgBVê  j……∏∂      8   phpspec-prophecy/Prophecy/Prophecy/ProphecyInterface.php,  lgBV,  °W∂      5   phpspec-prophecy/Prophecy/Prophecy/ObjectProphecy.phpk  lgBVk  kÑ ∂      5   phpspec-prophecy/Prophecy/Prophecy/MethodProphecy.php_,  lgBV_,  ¢K»¡∂      :   phpspec-prophecy/Prophecy/Comparator/ClosureComparator.phpK  lgBVK  )RQ„∂      0   phpspec-prophecy/Prophecy/Comparator/Factory.php°  lgBV°  AÍœ∂      &   phpspec-prophecy/Prophecy/Argument.php^  lgBV^  lî∂      %   phpspec-prophecy/Prophecy/Prophet.php  lgBV  Ávqé∂      1   phpspec-prophecy/Prophecy/Exception/Exception.php+  lgBV+  ∏µë∂      H   phpspec-prophecy/Prophecy/Exception/Prophecy/ObjectProphecyException.php  lgBV  Ü:ÇF∂      B   phpspec-prophecy/Prophecy/Exception/Prophecy/ProphecyException.phpô  lgBVô  ‹Í$œ∂      H   phpspec-prophecy/Prophecy/Exception/Prophecy/MethodProphecyException.php)  lgBV)  F˘¢4∂      J   phpspec-prophecy/Prophecy/Exception/Doubler/InterfaceNotFoundException.php‡  lgBV‡  ı°Ö˝∂      D   phpspec-prophecy/Prophecy/Exception/Doubler/ClassMirrorException.php™  lgBV™  €â?∂      ?   phpspec-prophecy/Prophecy/Exception/Doubler/DoubleException.php©  lgBV©  zÈFÉ∂      @   phpspec-prophecy/Prophecy/Exception/Doubler/DoublerException.phpó  lgBVó  √Z^∂      G   phpspec-prophecy/Prophecy/Exception/Doubler/MethodNotFoundException.php÷  lgBV÷  iﬁhÛ∂      J   phpspec-prophecy/Prophecy/Exception/Doubler/ReturnByReferenceException.phpç  lgBVç  ˝™∂      E   phpspec-prophecy/Prophecy/Exception/Doubler/ClassCreatorException.phpµ  lgBVµ  77/%∂      F   phpspec-prophecy/Prophecy/Exception/Doubler/ClassNotFoundException.php≈  lgBV≈  h+Ó§∂      K   phpspec-prophecy/Prophecy/Exception/Prediction/UnexpectedCallsException.php,  lgBV,  èêıa∂      F   phpspec-prophecy/Prophecy/Exception/Prediction/PredictionException.phpù  lgBVù  2T¢—∂      L   phpspec-prophecy/Prophecy/Exception/Prediction/FailedPredictionException.phpJ  lgBVJ  ~–„D∂      C   phpspec-prophecy/Prophecy/Exception/Prediction/NoCallsException.php⁄  lgBV⁄  ¡l<ç∂      E   phpspec-prophecy/Prophecy/Exception/Prediction/AggregateException.phpª  lgBVª  ?D<Œ∂      P   phpspec-prophecy/Prophecy/Exception/Prediction/UnexpectedCallsCountException.php  lgBV  Ê	∆∂      D   phpspec-prophecy/Prophecy/Exception/Call/UnexpectedCallException.php÷  lgBV÷  £¡Û∏∂      @   phpspec-prophecy/Prophecy/Exception/InvalidArgumentException.phpï  lgBVï  ®gÏ∂      3   phpspec-prophecy/Prophecy/Doubler/CachedDoubler.phpÉ  lgBVÉ  ÃágË∂      5   phpspec-prophecy/Prophecy/Doubler/DoubleInterface.php‚  lgBV‚  8dçj∂      -   phpspec-prophecy/Prophecy/Doubler/Doubler.phpè  lgBVè  8]’^∂      B   phpspec-prophecy/Prophecy/Doubler/Generator/ClassCodeGenerator.phpÆ
  lgBVÆ
  ú£ô`∂      <   phpspec-prophecy/Prophecy/Doubler/Generator/ClassCreator.php‘  lgBV‘  ‰?Br∂      C   phpspec-prophecy/Prophecy/Doubler/Generator/ReflectionInterface.phpÚ  lgBVÚ  Á˚™Â∂      ;   phpspec-prophecy/Prophecy/Doubler/Generator/ClassMirror.php”  lgBV”  õ"¸∂      A   phpspec-prophecy/Prophecy/Doubler/Generator/Node/ArgumentNode.phpö  lgBVö  ^û∂      ?   phpspec-prophecy/Prophecy/Doubler/Generator/Node/MethodNode.phpÒ  lgBVÒ  
Î∂      >   phpspec-prophecy/Prophecy/Doubler/Generator/Node/ClassNode.phpP
  lgBVP
  M∞-ä∂      0   phpspec-prophecy/Prophecy/Doubler/LazyDouble.phpF  lgBVF  ºÎl¶∂      =   phpspec-prophecy/Prophecy/Doubler/ClassPatch/KeywordPatch.phpΩ  lgBVΩ  ˚/@»∂      E   phpspec-prophecy/Prophecy/Doubler/ClassPatch/ProphecySubjectPatch.phpÙ
  lgBVÙ
  ¬nñi∂      ?   phpspec-prophecy/Prophecy/Doubler/ClassPatch/MagicCallPatch.php‚  lgBV‚  ¡y˙∂      A   phpspec-prophecy/Prophecy/Doubler/ClassPatch/TraversablePatch.php	  lgBV	  ßÄjN∂      A   phpspec-prophecy/Prophecy/Doubler/ClassPatch/SplFileInfoPatch.phpç  lgBVç  !h^∂      H   phpspec-prophecy/Prophecy/Doubler/ClassPatch/DisableConstructorPatch.phpí  lgBVí  :0`Ú∂      C   phpspec-prophecy/Prophecy/Doubler/ClassPatch/HhvmExceptionPatch.php—  lgBV—  xì¬^∂      P   phpspec-prophecy/Prophecy/Doubler/ClassPatch/ReflectionClassNewInstancePatch.phpp  lgBVp  x§øà∂      D   phpspec-prophecy/Prophecy/Doubler/ClassPatch/ClassPatchInterface.phpl  lgBVl  )ä5:∂      3   phpspec-prophecy/Prophecy/Doubler/NameGenerator.phpä  lgBVä  ı—7∂      <   phpspec-prophecy/Prophecy/Prediction/CallTimesPrediction.phpì  lgBVì  Xä¸∂      :   phpspec-prophecy/Prophecy/Prediction/NoCallsPrediction.phpÂ  lgBVÂ  L9%∂      <   phpspec-prophecy/Prophecy/Prediction/PredictionInterface.phpü  lgBVü  `IE∂      ;   phpspec-prophecy/Prophecy/Prediction/CallbackPrediction.phpì  lgBVì  Vb{Œ∂      7   phpspec-prophecy/Prophecy/Prediction/CallPrediction.phpQ	  lgBVQ	  IÊìÈ∂      '   phpspec-prophecy/Prophecy/Call/Call.php”	  lgBV”	  {:Â%∂      -   phpspec-prophecy/Prophecy/Call/CallCenter.phpm  lgBVm  ö[µ9∂      2   phpspec-prophecy/Prophecy/Promise/ThrowPromise.php9
  lgBV9
  òΩcu∂      ;   phpspec-prophecy/Prophecy/Promise/ReturnArgumentPromise.php  lgBV  ®Ù%A∂      3   phpspec-prophecy/Prophecy/Promise/ReturnPromise.php  lgBV  Áÿè‰∂      5   phpspec-prophecy/Prophecy/Promise/CallbackPromise.phpç  lgBVç  [û‹∂      6   phpspec-prophecy/Prophecy/Promise/PromiseInterface.phpK  lgBVK  æ¨ÖÎ∂      8   phpspec-prophecy/Prophecy/Argument/ArgumentsWildcard.php4	  lgBV4	  A;K2∂      :   phpspec-prophecy/Prophecy/Argument/Token/AnyValueToken.php´  lgBV´  Fèh∂      A   phpspec-prophecy/Prophecy/Argument/Token/ArrayEveryEntryToken.phpí  lgBVí  pb¯ç∂      <   phpspec-prophecy/Prophecy/Argument/Token/LogicalAndToken.php¯  lgBV¯   N„v∂      ;   phpspec-prophecy/Prophecy/Argument/Token/TokenInterface.phpê  lgBVê  Ÿ∞äº∂      <   phpspec-prophecy/Prophecy/Argument/Token/ArrayEntryToken.phpî  lgBVî  ﬁJ˙:∂      <   phpspec-prophecy/Prophecy/Argument/Token/ArrayCountToken.php·  lgBV·  Ç4ÆÃ∂      ;   phpspec-prophecy/Prophecy/Argument/Token/AnyValuesToken.php⁄  lgBV⁄  ÷bN/∂      @   phpspec-prophecy/Prophecy/Argument/Token/StringContainsToken.php¸  lgBV¸  â— >∂      <   phpspec-prophecy/Prophecy/Argument/Token/ExactValueToken.php°  lgBV°   Ö3ê∂      =   phpspec-prophecy/Prophecy/Argument/Token/ObjectStateToken.php9
  lgBV9
  _€Jg∂      :   phpspec-prophecy/Prophecy/Argument/Token/CallbackToken.php,  lgBV,  cR Ã∂      @   phpspec-prophecy/Prophecy/Argument/Token/IdenticalValueToken.phpÊ  lgBVÊ  ùØ ˝∂      <   phpspec-prophecy/Prophecy/Argument/Token/LogicalNotToken.php  lgBV  ‹ºr∂      6   phpspec-prophecy/Prophecy/Argument/Token/TypeToken.php•  lgBV•  ÆnÊ\∂      -   phpspec-prophecy/Prophecy/Util/ExportUtil.phpÑ  lgBVÑ  —™zH∂      -   phpspec-prophecy/Prophecy/Util/StringUtil.phpÏ	  lgBVÏ	  %¯∂         sebastian-exporter/LICENSE  lgBV  A™e)∂         sebastian-exporter/Exporter.php["  lgBV["  ‡TúÂ∂         php-file-iterator/LICENSE  lgBV  ∂…sâ∂         php-file-iterator/Iterator.phpa  lgBVa  ◊‰“Â∂         php-file-iterator/Facade.phpª  lgBVª  Àœ0é∂         php-file-iterator/Factory.phpÜ	  lgBVÜ	  ©yß≥∂         manifest.txt}  lgBV}  ‰¶ÒX∂      )   sebastian-recursion-context/Exception.phpJ  lgBVJ  »Ù≥Ò∂      #   sebastian-recursion-context/LICENSE  lgBV  …Œ∂      '   sebastian-recursion-context/Context.phpµ  lgBVµ  ü?∂      8   sebastian-recursion-context/InvalidArgumentException.phpí  lgBVí  mH∂      %   sebastian-resource-operations/LICENSE  lgBV  I¨ä∂      4   sebastian-resource-operations/ResourceOperations.phpíU  lgBVíU  ÿh’∂      '   php-code-coverage/CodeCoverage/Util.php4  lgBV4  ËJÚZ∂      7   php-code-coverage/CodeCoverage/Report/HTML/Renderer.php!  lgBV!  _nßÊ∂      A   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Dashboard.phpê&  lgBVê&   X®Ü∂      <   php-code-coverage/CodeCoverage/Report/HTML/Renderer/File.php	L  lgBV	L  »w0Ö∂      P   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/dashboard.html.dist  lgBV  ˝Ú{∂      P   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/directory.html.diste  lgBVe  «ê•Ù∂      S   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/coverage_bar.html.dist1  lgBV1  itLÏ∂      P   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/js/bootstrap.min.jsoå  lgBVoå  ;¶ù†∂      I   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/js/d3.min.jsUN lgBVUN ;¡Î1∂      N   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/js/respond.min.js  lgBV  Ì{∂      P   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/js/html5shiv.min.jsL
  lgBVL
  F®∂      M   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/js/holder.min.js†m  lgBV†m  JÎs—∂      L   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/js/nv.d3.min.js˙] lgBV˙] '¬]4∂      M   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/js/jquery.min.js’v lgBV’v Üeì∂      P   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/file_item.html.distg  lgBVg  V≥P∂      R   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/method_item.html.distx  lgBVx  *ˆå∂      U   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/directory_item.html.dist5  lgBV5  ÒZà]∂      K   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/file.html.dist˛
  lgBV˛
  ¯˝äD∂      J   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/css/style.css+  lgBV+  Y`¸g∂      N   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/css/nv.d3.min.cssX%  lgBVX%  Å0,∂      R   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/css/bootstrap.min.css9  lgBV9  ‹õ2¯∂      c   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/fonts/glyphicons-halflings-regular.ttf\±  lgBV\±  ö<ú∂      e   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/fonts/glyphicons-halflings-regular.woff2lF  lgBVlF  vË√a∂      d   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/fonts/glyphicons-halflings-regular.woffÄ[  lgBVÄ[  Í{ı∂      c   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/fonts/glyphicons-halflings-regular.eotüN  lgBVüN  X«±ú∂      c   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Template/fonts/glyphicons-halflings-regular.svg¬® lgBV¬® |Ó∆…∂      A   php-code-coverage/CodeCoverage/Report/HTML/Renderer/Directory.phpr  lgBVr  ‘E2L∂      0   php-code-coverage/CodeCoverage/Report/Crap4j.php)  lgBV)  Ê¿ˇ´∂      3   php-code-coverage/CodeCoverage/Report/XML/Tests.php—  lgBV—  ^*ñõ∂      2   php-code-coverage/CodeCoverage/Report/XML/File.php0  lgBV0  ä‰ù⁄∂      2   php-code-coverage/CodeCoverage/Report/XML/Node.php^  lgBV^  ∏N∂      5   php-code-coverage/CodeCoverage/Report/XML/Project.php]  lgBV]  ◊h>µ∂      4   php-code-coverage/CodeCoverage/Report/XML/Totals.php«  lgBV«  o∑F∂      7   php-code-coverage/CodeCoverage/Report/XML/Directory.phpâ  lgBVâ  —“ÁZ∂      9   php-code-coverage/CodeCoverage/Report/XML/File/Method.phpu  lgBVu  ËÓ ∂      9   php-code-coverage/CodeCoverage/Report/XML/File/Report.phpC  lgBVC  ®Y{»∂      ;   php-code-coverage/CodeCoverage/Report/XML/File/Coverage.php<  lgBV<  `ÃÓ√∂      7   php-code-coverage/CodeCoverage/Report/XML/File/Unit.phpB
  lgBVB
  kr∂      .   php-code-coverage/CodeCoverage/Report/Node.phpÂ  lgBVÂ  Œë„˛∂      7   php-code-coverage/CodeCoverage/Report/Node/Iterator.phpÇ  lgBVÇ  M∂q∂      3   php-code-coverage/CodeCoverage/Report/Node/File.phpÍJ  lgBVÍJ   Îˇ∂      8   php-code-coverage/CodeCoverage/Report/Node/Directory.php_(  lgBV_(  ÁIß\∂      0   php-code-coverage/CodeCoverage/Report/Clover.php∑'  lgBV∑'  ·:û∂      .   php-code-coverage/CodeCoverage/Report/HTML.phpR  lgBVR  @â*∂      1   php-code-coverage/CodeCoverage/Report/Factory.phpf  lgBVf  W}´n∂      -   php-code-coverage/CodeCoverage/Report/XML.phpà  lgBVà  &µõ}∂      -   php-code-coverage/CodeCoverage/Report/PHP.php§  lgBV§  ìùﬂo∂      .   php-code-coverage/CodeCoverage/Report/Text.php_!  lgBV_!  }ñ ∂      6   php-code-coverage/CodeCoverage/Exception/Exception.phpó  lgBVó   ÒI∂      P   php-code-coverage/CodeCoverage/Exception/UnintentionallyCoveredCodeException.phpﬁ  lgBVﬁ  ˆ¡ú∂      =   php-code-coverage/CodeCoverage/Exception/RuntimeException.phpõ  lgBVõ  Îc"\∂      E   php-code-coverage/CodeCoverage/Exception/InvalidArgumentException.phpå  lgBVå  .Ωˆ-∂      )   php-code-coverage/CodeCoverage/Driver.phpª  lgBVª  ß0∂      )   php-code-coverage/CodeCoverage/Filter.phpƒ  lgBVƒ  óŸ Ï∂      .   php-code-coverage/CodeCoverage/Driver/HHVM.php^  lgBV^  ≈7bß∂      0   php-code-coverage/CodeCoverage/Driver/PHPDBG.php  lgBV  Jí=∂      0   php-code-coverage/CodeCoverage/Driver/Xdebug.phpÜ	  lgBVÜ	  >ä#<∂         php-code-coverage/LICENSE  lgBV  –âxZ∂      "   php-code-coverage/CodeCoverage.phpUi  lgBVUi  ê∂         symfony/LICENSE)  lgBV)  Î&ï∂         symfony/yaml/Inline.phptM  lgBVtM  G∑∑»∂         symfony/yaml/Unescaper.php◊  lgBV◊  Õè*∂         symfony/yaml/Yaml.php˚  lgBV˚  ¿[Ì}∂      )   symfony/yaml/Exception/ParseException.php˙  lgBV˙  à©!´∂      (   symfony/yaml/Exception/DumpException.php«  lgBV«  å∂      +   symfony/yaml/Exception/RuntimeException.phpÂ  lgBVÂ  Ù_q¶∂      -   symfony/yaml/Exception/ExceptionInterface.phpª  lgBVª  ﬁ^KA∂         symfony/yaml/Parser.phpk  lgBVk  ãÚÇ ∂         symfony/yaml/Dumper.phpÅ	  lgBVÅ	  l£D∂         symfony/yaml/Escaper.php  lgBV  Kã„∂         ca.pemÒ  lgBVÒ  ãbyÎ∂         doctrine-instantiator/LICENSE$  lgBV$  
ÕÇÂ∂      E   doctrine-instantiator/Doctrine/Instantiator/InstantiatorInterface.php~  lgBV~  ∂ˇÃ:∂      L   doctrine-instantiator/Doctrine/Instantiator/Exception/ExceptionInterface.php•  lgBV•  Û.√∂      R   doctrine-instantiator/Doctrine/Instantiator/Exception/InvalidArgumentException.phpÙ  lgBVÙ  h≈7I∂      R   doctrine-instantiator/Doctrine/Instantiator/Exception/UnexpectedValueException.phpŒ
  lgBVŒ
  "üË ∂      <   doctrine-instantiator/Doctrine/Instantiator/Instantiator.php√   lgBV√   ¸&‡∂         php-token-stream/LICENSE  lgBV  É-& ∂      0   php-token-stream/Token/Stream/CachingFactory.php  lgBV  _∂      !   php-token-stream/Token/Stream.php˛@  lgBV˛@  ‹Ó‹ú∂         php-token-stream/Token.php:b  lgBV:b  Ó#0!∂      ,   dbunit/Extensions/Database/TestCaseTrait.php6!  lgBV6!  X#ÓK∂      (   dbunit/Extensions/Database/Exception.php  lgBV  mé-`∂      0   dbunit/Extensions/Database/UI/IMediumPrinter.php¶  lgBV¶  º}Ÿ0∂      )   dbunit/Extensions/Database/UI/Command.phpI  lgBVI  πTô∂      .   dbunit/Extensions/Database/UI/Mediums/Text.phpü	  lgBVü	  o4ƒa∂      6   dbunit/Extensions/Database/UI/InvalidModeException.php  lgBV  è*,Â∂      '   dbunit/Extensions/Database/UI/IMode.php‹  lgBV‹  º∂d∂      )   dbunit/Extensions/Database/UI/Context.php  lgBV  °G∂      ?   dbunit/Extensions/Database/UI/Modes/ExportDataSet/Arguments.php 
  lgBV 
  ñ:YÑ∂      5   dbunit/Extensions/Database/UI/Modes/ExportDataSet.php≠  lgBV≠  “Xãq∂      )   dbunit/Extensions/Database/UI/IMedium.phpP  lgBVP  å∏‘ö∂      -   dbunit/Extensions/Database/UI/ModeFactory.php=
  lgBV=
  Ût≠=∂      .   dbunit/Extensions/Database/UI/IModeFactory.php
  lgBV
  üΩ«¯∂      4   dbunit/Extensions/Database/IDatabaseListConsumer.php;  lgBV;  4o∂      2   dbunit/Extensions/Database/Operation/Exception.php/  lgBV/  £Jæ∂      0   dbunit/Extensions/Database/Operation/Replace.php`  lgBV`  ùdÁ∂∂      /   dbunit/Extensions/Database/Operation/Insert.php—  lgBV—  td∂      /   dbunit/Extensions/Database/Operation/Delete.php  lgBV  ⁄Z>0∂      ;   dbunit/Extensions/Database/Operation/IDatabaseOperation.php‘  lgBV‘  "≈Ò∂      -   dbunit/Extensions/Database/Operation/Null.phpá  lgBVá  ¶˚0”∂      2   dbunit/Extensions/Database/Operation/DeleteAll.phpñ  lgBVñ  Â}^∂      /   dbunit/Extensions/Database/Operation/Update.phpú  lgBVú  W":À∂      1   dbunit/Extensions/Database/Operation/RowBased.php+  lgBV+  âcÚX∂      0   dbunit/Extensions/Database/Operation/Factory.php  lgBV  p{UÌ∂      2   dbunit/Extensions/Database/Operation/Composite.phpÉ  lgBVÉ  ∂€M∂      1   dbunit/Extensions/Database/Operation/Truncate.php¥	  lgBV¥	  ë;¢i∂      '   dbunit/Extensions/Database/TestCase.php  lgBV  œÈ[i∂      -   dbunit/Extensions/Database/AbstractTester.php  lgBV  C÷Y∂      1   dbunit/Extensions/Database/DB/MetaData/Sqlite.php
  lgBV
  áá¿∂      0   dbunit/Extensions/Database/DB/MetaData/Dblib.php˘
  lgBV˘
  #j*-∂      0   dbunit/Extensions/Database/DB/MetaData/MySQL.phpΩ  lgBVΩ  ä∂±∂      <   dbunit/Extensions/Database/DB/MetaData/InformationSchema.phpA  lgBVA  4ÔC"∂      3   dbunit/Extensions/Database/DB/MetaData/Firebird.phpÂ  lgBVÂ  ç]Y∂      .   dbunit/Extensions/Database/DB/MetaData/Oci.phpI  lgBVI  UWKª∂      0   dbunit/Extensions/Database/DB/MetaData/PgSQL.phpñ  lgBVñ  Aœ.Ø∂      1   dbunit/Extensions/Database/DB/MetaData/SqlSrv.phpÉ  lgBVÉ  y€D∂      '   dbunit/Extensions/Database/DB/Table.php¢  lgBV¢  8k8o∂      1   dbunit/Extensions/Database/DB/FilteredDataSet.phpF  lgBVF   (˜e∂      5   dbunit/Extensions/Database/DB/IDatabaseConnection.php  lgBV  ®d ∂      /   dbunit/Extensions/Database/DB/TableMetaData.php  lgBV  ™;–ï∂      *   dbunit/Extensions/Database/DB/MetaData.php•  lgBV•  √Pp∂      ;   dbunit/Extensions/Database/DB/DefaultDatabaseConnection.php}  lgBV}  Ù£Œ¯∂      +   dbunit/Extensions/Database/DB/IMetaData.php3  lgBV3  @GâÆ∂      /   dbunit/Extensions/Database/DB/TableIterator.php}
  lgBV}
  0Wä6∂      )   dbunit/Extensions/Database/DB/DataSet.phpC  lgBVC  ‘ç∂      0   dbunit/Extensions/Database/DB/ResultSetTable.php„  lgBV„   O&∂      ,   dbunit/Extensions/Database/DefaultTester.php®  lgBV®  ⁄X`˛∂      6   dbunit/Extensions/Database/Constraint/TableIsEqual.php  lgBV  7ä
∂      8   dbunit/Extensions/Database/Constraint/DataSetIsEqual.phpç  lgBVç  MÔ±∂      7   dbunit/Extensions/Database/Constraint/TableRowCount.phpì  lgBVì  IÂX”∂      &   dbunit/Extensions/Database/ITester.php£  lgBV£  Ç”#û∂      6   dbunit/Extensions/Database/DataSet/MysqlXmlDataSet.php  lgBV  ∆±§¬∂      3   dbunit/Extensions/Database/DataSet/QueryDataSet.php´	  lgBV´	  'å7u∂      2   dbunit/Extensions/Database/DataSet/YamlDataSet.php|  lgBV|  IöK∂      6   dbunit/Extensions/Database/DataSet/AbstractDataSet.php  lgBV  È^úÔ∂      ,   dbunit/Extensions/Database/DataSet/ISpec.phpß  lgBVß  ›ÇÔó∂      2   dbunit/Extensions/Database/DataSet/TableFilter.php◊  lgBV◊  )≈∂      <   dbunit/Extensions/Database/DataSet/AbstractTableMetaData.php·  lgBV·  ;¢cº∂      7   dbunit/Extensions/Database/DataSet/CompositeDataSet.php5
  lgBV5
   ®4O∂      ;   dbunit/Extensions/Database/DataSet/DefaultTableIterator.phpò	  lgBVò	  4Ÿ∂      4   dbunit/Extensions/Database/DataSet/DataSetFilter.phpG  lgBVG  1¨ÔÖ∂      2   dbunit/Extensions/Database/DataSet/IYamlParser.php  lgBV  @€à[∂      1   dbunit/Extensions/Database/DataSet/XmlDataSet.phpt  lgBVt  é†∞D∂      5   dbunit/Extensions/Database/DataSet/DefaultDataSet.php∫  lgBV∫  ¯Áwä∂      8   dbunit/Extensions/Database/DataSet/SymfonyYamlParser.phpO  lgBVO  PW∏∂      /   dbunit/Extensions/Database/DataSet/IDataSet.php  lgBV  µZﬂ∂      5   dbunit/Extensions/Database/DataSet/ITableMetaData.php1  lgBV1  ,»+;∂      :   dbunit/Extensions/Database/DataSet/Persistors/Abstract.php
  lgBV
  D:„∂      5   dbunit/Extensions/Database/DataSet/Persistors/Xml.php5  lgBV5  áâ.∂∂      9   dbunit/Extensions/Database/DataSet/Persistors/FlatXml.phpä  lgBVä  TœZ,∂      6   dbunit/Extensions/Database/DataSet/Persistors/Yaml.phpÿ  lgBVÿ  *ñÔ©∂      :   dbunit/Extensions/Database/DataSet/Persistors/MysqlXml.php›  lgBV›  äOÏ”∂      9   dbunit/Extensions/Database/DataSet/Persistors/Factory.php  lgBV  ⁄(˝∂      1   dbunit/Extensions/Database/DataSet/CsvDataSet.php˝  lgBV˝  lÙŸ‰∂      ?   dbunit/Extensions/Database/DataSet/ReplacementTableIterator.php“  lgBV“  ◊ÓNs∂      9   dbunit/Extensions/Database/DataSet/ReplacementDataSet.phpÄ
  lgBVÄ
  „ÁÑO∂      3   dbunit/Extensions/Database/DataSet/ArrayDataSet.phpo  lgBVo  πï||∂      3   dbunit/Extensions/Database/DataSet/DefaultTable.phpt  lgBVt  ìƒœ∂      5   dbunit/Extensions/Database/DataSet/ITableIterator.php  lgBV  Æ!-∂      5   dbunit/Extensions/Database/DataSet/FlatXmlDataSet.php@  lgBV@  „ËÄÄ∂      3   dbunit/Extensions/Database/DataSet/IPersistable.phpé  lgBVé  ï±àá∂      9   dbunit/Extensions/Database/DataSet/AbstractXmlDataSet.phpÙ  lgBVÙ  ñF!∂      :   dbunit/Extensions/Database/DataSet/TableMetaDataFilter.php9  lgBV9  52P∂      7   dbunit/Extensions/Database/DataSet/ReplacementTable.phph  lgBVh  /îÁw∂      4   dbunit/Extensions/Database/DataSet/Specs/DbQuery.php¸  lgBV¸  Ï ƒ∂      0   dbunit/Extensions/Database/DataSet/Specs/Xml.php   lgBV   ïTZ∂      4   dbunit/Extensions/Database/DataSet/Specs/FlatXml.phpË  lgBVË  ΩﬂÜ∂      1   dbunit/Extensions/Database/DataSet/Specs/Yaml.php—  lgBV—  {;>‡∂      5   dbunit/Extensions/Database/DataSet/Specs/IFactory.phpl  lgBVl  ’óΩ+∂      0   dbunit/Extensions/Database/DataSet/Specs/Csv.phpÄ
  lgBVÄ
  :Öd=∂      4   dbunit/Extensions/Database/DataSet/Specs/DbTable.phpù  lgBVù  Òîˇv∂      4   dbunit/Extensions/Database/DataSet/Specs/Factory.php⁄  lgBV⁄  A‰ÇÃ∂      1   dbunit/Extensions/Database/DataSet/QueryTable.phpV  lgBVV  lN∏ä∂      4   dbunit/Extensions/Database/DataSet/AbstractTable.phpS  lgBVS  XlöŸ∂      -   dbunit/Extensions/Database/DataSet/ITable.php  lgBV  »ÉNî∂      ;   dbunit/Extensions/Database/DataSet/DefaultTableMetaData.phpì  lgBVì  .ˆF∂         php-invoker/Invoker.phpÔ  lgBVÔ  w‡∂          php-invoker/TimeoutException.phpp  lgBVp  ~™¯∂         phpunit-mock-objects/LICENSE  lgBV  C>©∂      5   phpunit-mock-objects/Framework/MockObject/Matcher.php∆   lgBV∆   mSG∂      8   phpunit-mock-objects/Framework/MockObject/Verifiable.php≤  lgBV≤  î'L∂      7   phpunit-mock-objects/Framework/MockObject/Invokable.php9  lgBV9  Ÿˇ~Ü∂      9   phpunit-mock-objects/Framework/MockObject/MockBuilder.php  lgBV  Jë¿—∂      A   phpunit-mock-objects/Framework/MockObject/Exception/Exception.php¶  lgBV¶  ]√T∂      N   phpunit-mock-objects/Framework/MockObject/Exception/BadMethodCallException.php¡  lgBV¡  •“).∂      H   phpunit-mock-objects/Framework/MockObject/Exception/RuntimeException.phpµ  lgBVµ  Y∑n4∂      8   phpunit-mock-objects/Framework/MockObject/Invocation.phpÚ  lgBVÚ  9TÇ∑∂      8   phpunit-mock-objects/Framework/MockObject/MockObject.phpã  lgBVã  ®0“¨∂      >   phpunit-mock-objects/Framework/MockObject/InvocationMocker.phpó  lgBVó  ,J™™∂      @   phpunit-mock-objects/Framework/MockObject/Matcher/MethodName.php   lgBV   v¥ä∂      H   phpunit-mock-objects/Framework/MockObject/Matcher/InvokedAtLeastOnce.php–  lgBV–  cÓ˛I∂      C   phpunit-mock-objects/Framework/MockObject/Matcher/AnyParameters.phpC  lgBVC  π£∂      @   phpunit-mock-objects/Framework/MockObject/Matcher/Parameters.php•  lgBV•  -EıY∂      E   phpunit-mock-objects/Framework/MockObject/Matcher/AnyInvokedCount.php‡  lgBV‡  ìDs$∂      I   phpunit-mock-objects/Framework/MockObject/Matcher/InvokedAtLeastCount.php¸  lgBV¸  RÅ∂      @   phpunit-mock-objects/Framework/MockObject/Matcher/Invocation.php  lgBV  KÙb∂      K   phpunit-mock-objects/Framework/MockObject/Matcher/ConsecutiveParameters.phpû  lgBVû  0^◊z∂      D   phpunit-mock-objects/Framework/MockObject/Matcher/InvokedAtIndex.php	  lgBV	  ïÂY©∂      B   phpunit-mock-objects/Framework/MockObject/Matcher/InvokedCount.php†  lgBV†  SûG∂      H   phpunit-mock-objects/Framework/MockObject/Matcher/InvokedAtMostCount.phpÒ  lgBVÒ  √À˜∂      E   phpunit-mock-objects/Framework/MockObject/Matcher/InvokedRecorder.php[  lgBV[  Ò⁄≠\∂      I   phpunit-mock-objects/Framework/MockObject/Matcher/StatelessInvocation.phpk  lgBVk  ˚ïœ∂      7   phpunit-mock-objects/Framework/MockObject/Generator.php}ú  lgBV}ú  Sü≈â∂      H   phpunit-mock-objects/Framework/MockObject/Generator/wsdl_method.tpl.dist<   lgBV<   æ–iâ∂      K   phpunit-mock-objects/Framework/MockObject/Generator/unmocked_clone.tpl.distü   lgBVü   8W}ÿ∂      I   phpunit-mock-objects/Framework/MockObject/Generator/mocked_class.tpl.dist^  lgBV^  °Ç!„∂      I   phpunit-mock-objects/Framework/MockObject/Generator/mocked_clone.tpl.distÑ   lgBVÑ   úaT∂      K   phpunit-mock-objects/Framework/MockObject/Generator/proxied_method.tpl.dist   lgBV   óÂ…∂      G   phpunit-mock-objects/Framework/MockObject/Generator/wsdl_class.tpl.dist≥   lgBV≥   w&S∂      H   phpunit-mock-objects/Framework/MockObject/Generator/trait_class.tpl.dist7   lgBV7   ≤[$~∂      J   phpunit-mock-objects/Framework/MockObject/Generator/mocked_method.tpl.dist∏  lgBV∏  Z éﬂ∂      P   phpunit-mock-objects/Framework/MockObject/Generator/mocked_class_method.tpl.distÌ   lgBVÌ   ⁄4ﬁ∂      Q   phpunit-mock-objects/Framework/MockObject/Generator/mocked_static_method.tpl.dist≤   lgBV≤   œ™^b∂      ;   phpunit-mock-objects/Framework/MockObject/Builder/Match.phpW  lgBVW  EÉA∂      >   phpunit-mock-objects/Framework/MockObject/Builder/Identity.phpî  lgBVî  (≤4„∂      F   phpunit-mock-objects/Framework/MockObject/Builder/InvocationMocker.php\  lgBV\  ë∏w,∂      E   phpunit-mock-objects/Framework/MockObject/Builder/ParametersMatch.php   lgBV   s“ëŒ∂      ?   phpunit-mock-objects/Framework/MockObject/Builder/Namespace.php≤  lgBV≤  MÏâî∂      E   phpunit-mock-objects/Framework/MockObject/Builder/MethodNameMatch.php)  lgBV)  sÚı∂      :   phpunit-mock-objects/Framework/MockObject/Builder/Stub.phpo  lgBVo  hr‚ ∂      ?   phpunit-mock-objects/Framework/MockObject/Invocation/Object.php‹  lgBV‹  ›˜∂      ?   phpunit-mock-objects/Framework/MockObject/Invocation/Static.php3  lgBV3  F§∂      2   phpunit-mock-objects/Framework/MockObject/Stub.php\  lgBV\  f+F–∂      <   phpunit-mock-objects/Framework/MockObject/Stub/Exception.phpÕ  lgBVÕ  <˜‡∂      9   phpunit-mock-objects/Framework/MockObject/Stub/Return.php§  lgBV§  L¢f+∂      =   phpunit-mock-objects/Framework/MockObject/Stub/ReturnSelf.php¬  lgBV¬  ´§ÅI∂      A   phpunit-mock-objects/Framework/MockObject/Stub/ReturnValueMap.php|  lgBV|  uB	Ë∂      C   phpunit-mock-objects/Framework/MockObject/Stub/ConsecutiveCalls.phpì  lgBVì  2	∆∂      D   phpunit-mock-objects/Framework/MockObject/Stub/MatcherCollection.php:  lgBV:  µYä∂      A   phpunit-mock-objects/Framework/MockObject/Stub/ReturnCallback.phpï  lgBVï  gâ¥`∂      A   phpunit-mock-objects/Framework/MockObject/Stub/ReturnArgument.phpˇ  lgBVˇ  9)ç`∂         phpunit/Exception.phps  lgBVs  y:É€∂         phpunit/Framework/Test.phpî  lgBVî  Ö‰£%∂         phpunit/Framework/Exception.php	  lgBV	  ‡~bı∂      !   phpunit/Framework/OutputError.phpÁ  lgBVÁ  j‘Ã∂         phpunit/Framework/Assert.phpWX lgBVWX p[êµ∂      +   phpunit/Framework/CodeCoverageException.phpq  lgBVq  E¥ïÌ∂         phpunit/Framework/TestSuite.php*s  lgBV*s  ˆ¨ŸÌ∂         phpunit/Framework/RiskyTest.phpÆ  lgBVÆ  ≈\∂      $   phpunit/Framework/SelfDescribing.php  lgBV  :ã|∂      &   phpunit/Framework/Assert/Functions.php¯ﬁ  lgBV¯ﬁ  4-∂      $   phpunit/Framework/SyntheticError.php	  lgBV	  äKÁ∂      $   phpunit/Framework/RiskyTestError.php  lgBV  ?üv∂      "   phpunit/Framework/TestListener.phpn
  lgBVn
  {_µV∂      &   phpunit/Framework/ExceptionWrapper.phpò  lgBVò  ˘ì∂      !   phpunit/Framework/SkippedTest.phpì  lgBVì  „_ $∂      2   phpunit/Framework/InvalidCoversTargetException.phpÑ  lgBVÑ  %M◊‡∂         phpunit/Framework/TestCase.phpû lgBVû ÿys∂      0   phpunit/Framework/ExpectationFailedException.phpô  lgBVô  _Sı;∂         phpunit/Framework/Error.php$  lgBV$  X%yW∂          phpunit/Framework/Constraint.php:  lgBV:  ˙5L∂      *   phpunit/Framework/AssertionFailedError.php{  lgBV{  +¡˛∂      (   phpunit/Framework/IncompleteTestCase.php5  lgBV5  .ñSû∂      ,   phpunit/Framework/TestSuite/DataProvider.phpÉ  lgBVÉ  Ç<Us∂      &   phpunit/Framework/Error/Deprecated.phpF  lgBVF  ¥¢V∂      "   phpunit/Framework/Error/Notice.php0  lgBV0  ‹Iäõ∂      #   phpunit/Framework/Error/Warning.php3  lgBV3  mOë§∂      )   phpunit/Framework/IncompleteTestError.php  lgBV  Ht∫∂      .   phpunit/Framework/InvalidCoversTargetError.phpB  lgBVB  áˇ|∂      +   phpunit/Framework/SkippedTestSuiteError.php  lgBV  ‡’7<∂          phpunit/Framework/TestResult.php∏s  lgBV∏s  ±Ío·∂      !   phpunit/Framework/TestFailure.php  lgBV  ¯öî∂      $   phpunit/Framework/IncompleteTest.php‰  lgBV‰  ÚJÏ∂      %   phpunit/Framework/SkippedTestCase.phpÍ  lgBVÍ  `¨u‡∂      2   phpunit/Framework/Constraint/ClassHasAttribute.php√  lgBV√  Áb∂      4   phpunit/Framework/Constraint/TraversableContains.php´  lgBV´  jÏ∞î∂      .   phpunit/Framework/Constraint/ExceptionCode.php[  lgBV[  §¯∂      *   phpunit/Framework/Constraint/Exception.phpö  lgBVö  ∂+∏∂      )   phpunit/Framework/Constraint/SameSize.phpS  lgBVS  /#œS∂      ,   phpunit/Framework/Constraint/JsonMatches.php   lgBV   ˆ∑“∂      -   phpunit/Framework/Constraint/IsInstanceOf.phpæ  lgBVæ  ù˛`—∂      3   phpunit/Framework/Constraint/ObjectHasAttribute.phpù  lgBVù  Ç£/∂      '   phpunit/Framework/Constraint/IsType.phpo  lgBVo  F&°{∂      )   phpunit/Framework/Constraint/LessThan.phpæ  lgBVæ  4§wœ∂      ,   phpunit/Framework/Constraint/ArraySubset.phpI  lgBVI  ∑cáÍ∂      '   phpunit/Framework/Constraint/IsTrue.phpq  lgBVq  *%œˆ∂      '   phpunit/Framework/Constraint/IsJson.php5  lgBV5  C7—F∂      (   phpunit/Framework/Constraint/IsEqual.php!  lgBV!  	(Q∂      $   phpunit/Framework/Constraint/Xor.phpœ  lgBVœ  ¶ï…f∂      A   phpunit/Framework/Constraint/JsonMatches/ErrorMessageProvider.phpØ  lgBVØ  d¬òç∂      )   phpunit/Framework/Constraint/IsFinite.php~  lgBV~  ZIRä∂      &   phpunit/Framework/Constraint/IsNan.phpr  lgBVr  ≥D≠â∂      .   phpunit/Framework/Constraint/StringMatches.php	  lgBV	  ÷;R-∂      $   phpunit/Framework/Constraint/Not.phpè  lgBVè  #F}#∂      7   phpunit/Framework/Constraint/ExceptionMessageRegExp.php`  lgBV`  ”√0}∂      ,   phpunit/Framework/Constraint/GreaterThan.php«  lgBV«  ≈O∫R∂      1   phpunit/Framework/Constraint/ExceptionMessage.phpC  lgBVC  Ê¯îÄ∂      )   phpunit/Framework/Constraint/Callback.php3  lgBV3  •„Ì∂      ,   phpunit/Framework/Constraint/ArrayHasKey.php∏  lgBV∏  VÜÀ∂      /   phpunit/Framework/Constraint/StringContains.php2  lgBV2  õ]„.∂      +   phpunit/Framework/Constraint/IsInfinite.phpÜ  lgBVÜ  ÕûêR∂      8   phpunit/Framework/Constraint/TraversableContainsOnly.php≠	  lgBV≠	  g|s∂      (   phpunit/Framework/Constraint/IsEmpty.php&  lgBV&  ˝ç˘v∂      *   phpunit/Framework/Constraint/PCREMatch.phpΩ  lgBVΩ  πé™à∂      '   phpunit/Framework/Constraint/IsNull.phpq  lgBVq  ú^Ù`∂      *   phpunit/Framework/Constraint/Attribute.phpö	  lgBVö	  lõ¯Ï∂      (   phpunit/Framework/Constraint/IsFalse.phpu  lgBVu  ÷ª¨	∂      8   phpunit/Framework/Constraint/ClassHasStaticAttribute.phpÑ  lgBVÑ  °  ë∂      #   phpunit/Framework/Constraint/Or.php\  lgBV\  FñÄ∂      ,   phpunit/Framework/Constraint/IsIdentical.php’  lgBV’  FyØ;∂      +   phpunit/Framework/Constraint/FileExists.php≥  lgBV≥  +ì2∂      *   phpunit/Framework/Constraint/Composite.phpƒ  lgBVƒ  √4~)∂      1   phpunit/Framework/Constraint/StringStartsWith.php∆  lgBV∆  ≠‚É[∂      /   phpunit/Framework/Constraint/StringEndsWith.php◊  lgBV◊  vó>g∂      +   phpunit/Framework/Constraint/IsAnything.phpp  lgBVp  ˘ñV∂      &   phpunit/Framework/Constraint/Count.phpÂ	  lgBVÂ	  uÒ‚∂      $   phpunit/Framework/Constraint/And.php,  lgBV,  ∆Ÿs∂      &   phpunit/Framework/BaseTestListener.phpp  lgBVp  K8X4∂      &   phpunit/Framework/SkippedTestError.php	  lgBV	  êT∂      5   phpunit/Framework/UnintentionallyCoveredCodeError.php  lgBV  d^S∂         phpunit/Framework/Warning.php¡  lgBV¡  ˛Jk∂      %   phpunit/Extensions/GroupTestSuite.phpÇ  lgBVÇ  0¢™˙∂      $   phpunit/Extensions/PhptTestSuite.php  lgBV  	≤Ç‹∂      #   phpunit/Extensions/RepeatedTest.php˜  lgBV˜  Ä˚˚∂      %   phpunit/Extensions/TicketListener.php  lgBV  Ø´∂      $   phpunit/Extensions/TestDecorator.php@	  lgBV@	  Õ¿9∂      #   phpunit/Extensions/PhptTestCase.php  lgBV  ]BUJ∂         phpunit/TextUI/Command.phpƒà  lgBVƒà  ∑¯°≥∂         phpunit/TextUI/TestRunner.phpq•  lgBVq•  ÖˆI˙∂          phpunit/TextUI/ResultPrinter.phpaF  lgBVaF  †=æÀ∂         phpunit/Util/Test.phpÑ  lgBVÑ  |øº∂         phpunit/Util/Filesystem.phpå  lgBVå  8©∂         phpunit/Util/Getopt.phpâ  lgBVâ  ı€ÈÎ∂         phpunit/Util/ErrorHandler.php}  lgBV}  *î£z∂         phpunit/Util/String.php  lgBV  áÌ‡d∂      &   phpunit/Util/InvalidArgumentHelper.phpS  lgBVS  (Qœ©∂         phpunit/Util/Printer.phpW  lgBVW  1ö‡î∂         phpunit/Util/Configuration.php5Å  lgBV5Å  ;Âò¢∂         phpunit/Util/GlobalState.php%  lgBV%  ÿﬁ´∂         phpunit/Util/Log/JSON.php©  lgBV©  8ÑÑV∂         phpunit/Util/Log/TeamCity.php)  lgBV)  ågA∂         phpunit/Util/Log/TAP.phpˇ  lgBVˇ  k˛∂∂         phpunit/Util/Log/JUnit.php 1  lgBV 1  ’úÁ∂         phpunit/Util/Blacklist.php»  lgBV»  ‹√D‘∂      "   phpunit/Util/TestSuiteIterator.php˚  lgBV˚  œ‚çò∂         phpunit/Util/Filter.php«  lgBV«  …Î£∂      +   phpunit/Util/TestDox/ResultPrinter/HTML.php™  lgBV™  pfµ ∂      +   phpunit/Util/TestDox/ResultPrinter/Text.phpw  lgBVw  	;ˇõ∂      &   phpunit/Util/TestDox/ResultPrinter.phpa  lgBVa  ,À∂      '   phpunit/Util/TestDox/NamePrettifier.phpL  lgBVL  ∂∂         phpunit/Util/Regex.phpÂ  lgBVÂ  ±Pœd∂         phpunit/Util/Type.php  lgBV  á)∂         phpunit/Util/PHP/Default.phpq  lgBVq  &	C∂      1   phpunit/Util/PHP/Template/TestCaseMethod.tpl.dist‰	  lgBV‰	  ı˙∫∂         phpunit/Util/PHP/Windows.phpE
  lgBVE
  ΩF¿á∂         phpunit/Util/Fileloader.php‚  lgBV‚  ≈…˙∂         phpunit/Util/XML.phpı  lgBVı  ∞O·∂         phpunit/Util/PHP.php‘  lgBV‘  Úx∂∂         phpunit/Runner/Exception.phpt  lgBVt  Ädßø∂         phpunit/Runner/Filter/Test.php  lgBV  aüé∂      '   phpunit/Runner/Filter/Group/Exclude.php‚  lgBV‚  Ñ PF∂      '   phpunit/Runner/Filter/Group/Include.php·  lgBV·  Ve∂      !   phpunit/Runner/Filter/Factory.php“  lgBV“  º·ºï∂         phpunit/Runner/Filter/Group.php˚  lgBV˚  km1º∂      "   phpunit/Runner/TestSuiteLoader.php‰  lgBV‰  å˜∂      !   phpunit/Runner/BaseTestRunner.phpZ  lgBVZ  ¡◊¯c∂      *   phpunit/Runner/StandardTestSuiteLoader.phpÃ  lgBVÃ  ñ¿â	∂         phpunit/Runner/Version.phpì  lgBVì  õ=û*∂         sebastian-environment/LICENSE
  lgBV
  ∂Ó·ﬂ∂      !   sebastian-environment/Runtime.php@  lgBV@  “é!À∂      !   sebastian-environment/Console.phpp  lgBVp   .·Q∂      )   phpdocumentor-reflection-docblock/LICENSE8  lgBV8  ·â ∂      G   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock.phpc6  lgBVc6  ıÀq∂      P   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Location.phpq  lgBVq  u¡/∂      T   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/SinceTag.php|  lgBV|  t¯˚R∂      R   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/SeeTag.phpˇ  lgBVˇ  i‡?$∂      V   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/VersionTag.phpx
  lgBVx
  ”ÀE∆∂      W   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/PropertyTag.phpO  lgBVO  ´Œ#m∂      U   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/ReturnTag.phpŸ  lgBVŸ  pSùû∂      Y   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/DeprecatedTag.phpÜ  lgBVÜ  Kß∂      U   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/ThrowsTag.phpL  lgBVL  ú"‚∂      U   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/CoversTag.phpI  lgBVI  9π{∂      U   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/SourceTag.phpê  lgBVê  ‰Ÿn*∂      S   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/UsesTag.phpE  lgBVE  .ÅÑÀ∂      U   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/MethodTag.php~  lgBV~  Â!kÕ∂      [   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/PropertyReadTag.php[  lgBV[  Õ<=∂      U   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/AuthorTag.phpM  lgBVM  1Ù˙∂      R   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/VarTag.phpE  lgBVE  Éï¸Õ∂      S   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/LinkTag.phpL  lgBVL  è™F∂      V   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/ExampleTag.phpô  lgBVô  £
Ô∂      T   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/ParamTag.phpH  lgBVH  ±Ò∂      \   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag/PropertyWriteTag.php]  lgBV]  Rp∂      R   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Serializer.php  lgBV  Úr–∂      O   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Context.php5  lgBV5  l.%∂      W   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Type/Collection.phpè  lgBVè  +=4∂      K   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Tag.php€(  lgBV€(  åE6∂      S   phpdocumentor-reflection-docblock/phpDocumentor/Reflection/DocBlock/Description.phpó  lgBVó  Ò‘≤ÿ∂         sebastian-version/LICENSE  lgBV  n∂         sebastian-version/Version.php2  lgBV2  Bü‚Z∂      <?php
/*
 * This file is part of the GlobalState package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\GlobalState;

/**
 */
interface Exception
{
}
<?php
/*
 * This file is part of the GlobalState package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\GlobalState;

use ReflectionClass;
use Serializable;

/**
 * A snapshot of global state.
 */
class Snapshot
{
    /**
     * @var Blacklist
     */
    private $blacklist;

    /**
     * @var array
     */
    private $globalVariables = array();

    /**
     * @var array
     */
    private $superGlobalArrays = array();

    /**
     * @var array
     */
    private $superGlobalVariables = array();

    /**
     * @var array
     */
    private $staticAttributes = array();

    /**
     * @var array
     */
    private $iniSettings = array();

    /**
     * @var array
     */
    private $includedFiles = array();

    /**
     * @var array
     */
    private $constants = array();

    /**
     * @var array
     */
    private $functions = array();

    /**
     * @var array
     */
    private $interfaces = array();

    /**
     * @var array
     */
    private $classes = array();

    /**
     * @var array
     */
    private $traits = array();

    /**
     * Creates a snapshot of the current global state.
     *
     * @param Blacklist $blacklist
     * @param bool      $includeGlobalVariables
     * @param bool      $includeStaticAttributes
     * @param bool      $includeConstants
     * @param bool      $includeFunctions
     * @param bool      $includeClasses
     * @param bool      $includeInterfaces
     * @param bool      $includeTraits
     * @param bool      $includeIniSettings
     * @param bool      $includeIncludedFiles
     */
    public function __construct(Blacklist $blacklist = null, $includeGlobalVariables = true, $includeStaticAttributes = true, $includeConstants = true, $includeFunctions = true, $includeClasses = true, $includeInterfaces = true, $includeTraits = true, $includeIniSettings = true, $includeIncludedFiles = true)
    {
        if ($blacklist === null) {
            $blacklist = new Blacklist;
        }

        $this->blacklist = $blacklist;

        if ($includeConstants) {
            $this->snapshotConstants();
        }

        if ($includeFunctions) {
            $this->snapshotFunctions();
        }

        if ($includeClasses || $includeStaticAttributes) {
            $this->snapshotClasses();
        }

        if ($includeInterfaces) {
            $this->snapshotInterfaces();
        }

        if ($includeGlobalVariables) {
            $this->setupSuperGlobalArrays();
            $this->snapshotGlobals();
        }

        if ($includeStaticAttributes) {
            $this->snapshotStaticAttributes();
        }

        if ($includeIniSettings) {
            $this->iniSettings = ini_get_all(null, false);
        }

        if ($includeIncludedFiles) {
            $this->includedFiles = get_included_files();
        }

        if (function_exists('get_declared_traits')) {
            $this->traits = get_declared_traits();
        }
    }

    /**
     * @return Blacklist
     */
    public function blacklist()
    {
        return $this->blacklist;
    }

    /**
     * @return array
     */
    public function globalVariables()
    {
        return $this->globalVariables;
    }

    /**
     * @return array
     */
    public function superGlobalVariables()
    {
        return $this->superGlobalVariables;
    }

    /**
     * Returns a list of all super-global variable arrays.
     *
     * @return array
     */
    public function superGlobalArrays()
    {
        return $this->superGlobalArrays;
    }

    /**
     * @return array
     */
    public function staticAttributes()
    {
        return $this->staticAttributes;
    }

    /**
     * @return array
     */
    public function iniSettings()
    {
        return $this->iniSettings;
    }

    /**
     * @return array
     */
    public function includedFiles()
    {
        return $this->includedFiles;
    }

    /**
     * @return array
     */
    public function constants()
    {
        return $this->constants;
    }

    /**
     * @return array
     */
    public function functions()
    {
        return $this->functions;
    }

    /**
     * @return array
     */
    public function interfaces()
    {
        return $this->interfaces;
    }

    /**
     * @return array
     */
    public function classes()
    {
        return $this->classes;
    }

    /**
     * @return array
     */
    public function traits()
    {
        return $this->traits;
    }

    /**
     * Creates a snapshot user-defined constants.
     */
    private function snapshotConstants()
    {
        $constants = get_defined_constants(true);

        if (isset($constants['user'])) {
            $this->constants = $constants['user'];
        }
    }

    /**
     * Creates a snapshot user-defined functions.
     */
    private function snapshotFunctions()
    {
        $functions = get_defined_functions();

        $this->functions = $functions['user'];
    }

    /**
     * Creates a snapshot user-defined classes.
     */
    private function snapshotClasses()
    {
        foreach (array_reverse(get_declared_classes()) as $className) {
            $class = new ReflectionClass($className);

            if (!$class->isUserDefined()) {
                break;
            }

            $this->classes[] = $className;
        }

        $this->classes = array_reverse($this->classes);
    }

    /**
     * Creates a snapshot user-defined interfaces.
     */
    private function snapshotInterfaces()
    {
        foreach (array_reverse(get_declared_interfaces()) as $interfaceName) {
            $class = new ReflectionClass($interfaceName);

            if (!$class->isUserDefined()) {
                break;
            }

            $this->interfaces[] = $interfaceName;
        }

        $this->interfaces = array_reverse($this->interfaces);
    }

    /**
     * Creates a snapshot of all global and super-global variables.
     */
    private function snapshotGlobals()
    {
        $superGlobalArrays = $this->superGlobalArrays();

        foreach ($superGlobalArrays as $superGlobalArray) {
            $this->snapshotSuperGlobalArray($superGlobalArray);
        }

        foreach (array_keys($GLOBALS) as $key) {
            if ($key != 'GLOBALS' &&
                !in_array($key, $superGlobalArrays) &&
                $this->canBeSerialized($GLOBALS[$key]) &&
                !$this->blacklist->isGlobalVariableBlacklisted($key)) {
                $this->globalVariables[$key] = unserialize(serialize($GLOBALS[$key]));
            }
        }
    }

    /**
     * Creates a snapshot a super-global variable array.
     *
     * @param $superGlobalArray
     */
    private function snapshotSuperGlobalArray($superGlobalArray)
    {
        $this->superGlobalVariables[$superGlobalArray] = array();

        if (isset($GLOBALS[$superGlobalArray]) && is_array($GLOBALS[$superGlobalArray])) {
            foreach ($GLOBALS[$superGlobalArray] as $key => $value) {
                $this->superGlobalVariables[$superGlobalArray][$key] = unserialize(serialize($value));
            }
        }
    }

    /**
     * Creates a snapshot of all static attributes in user-defined classes.
     */
    private function snapshotStaticAttributes()
    {
        foreach ($this->classes as $className) {
            $class    = new ReflectionClass($className);
            $snapshot = array();

            foreach ($class->getProperties() as $attribute) {
                if ($attribute->isStatic()) {
                    $name = $attribute->getName();

                    if ($this->blacklist->isStaticAttributeBlacklisted($className, $name)) {
                        continue;
                    }

                    $attribute->setAccessible(true);
                    $value = $attribute->getValue();

                    if ($this->canBeSerialized($value)) {
                        $snapshot[$name] = unserialize(serialize($value));
                    }
                }
            }

            if (!empty($snapshot)) {
                $this->staticAttributes[$className] = $snapshot;
            }
        }
    }

    /**
     * Returns a list of all super-global variable arrays.
     *
     * @return array
     */
    private function setupSuperGlobalArrays()
    {
        $this->superGlobalArrays = array(
            '_ENV',
            '_POST',
            '_GET',
            '_COOKIE',
            '_SERVER',
            '_FILES',
            '_REQUEST'
        );

        if (ini_get('register_long_arrays') == '1') {
            $this->superGlobalArrays = array_merge(
                $this->superGlobalArrays,
                array(
                    'HTTP_ENV_VARS',
                    'HTTP_POST_VARS',
                    'HTTP_GET_VARS',
                    'HTTP_COOKIE_VARS',
                    'HTTP_SERVER_VARS',
                    'HTTP_POST_FILES'
                )
            );
        }
    }

    /**
     * @param  mixed $variable
     * @return bool
     * @todo   Implement this properly
     */
    private function canBeSerialized($variable)
    {
        if (!is_object($variable)) {
            return !is_resource($variable);
        }

        if ($variable instanceof \stdClass) {
            return true;
        }

        $class = new ReflectionClass($variable);

        do {
            if ($class->isInternal()) {
                return $variable instanceof Serializable;
            }
        } while ($class = $class->getParentClass());

        return true;
    }
}
GlobalState

Copyright (c) 2001-2015, Sebastian Bergmann <sebastian@phpunit.de>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

 * Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in
   the documentation and/or other materials provided with the
   distribution.

 * Neither the name of Sebastian Bergmann nor the names of his
   contributors may be used to endorse or promote products derived
   from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.
<?php
/*
 * This file is part of the GlobalState package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\GlobalState;

use ReflectionProperty;

/**
 * Restorer of snapshots of global state.
 */
class Restorer
{
    /**
     * Deletes function definitions that are not defined in a snapshot.
     *
     * @param  Snapshot         $snapshot
     * @throws RuntimeException when the uopz_delete() function is not available
     * @see    https://github.com/krakjoe/uopz
     */
    public function restoreFunctions(Snapshot $snapshot)
    {
        if (!function_exists('uopz_delete')) {
            throw new RuntimeException('The uopz_delete() function is required for this operation');
        }

        $functions = get_defined_functions();

        foreach (array_diff($functions['user'], $snapshot->functions()) as $function) {
            uopz_delete($function);
        }
    }

    /**
     * Restores all global and super-global variables from a snapshot.
     *
     * @param Snapshot $snapshot
     */
    public function restoreGlobalVariables(Snapshot $snapshot)
    {
        $superGlobalArrays = $snapshot->superGlobalArrays();

        foreach ($superGlobalArrays as $superGlobalArray) {
            $this->restoreSuperGlobalArray($snapshot, $superGlobalArray);
        }

        $globalVariables = $snapshot->globalVariables();

        foreach (array_keys($GLOBALS) as $key) {
            if ($key != 'GLOBALS' &&
                !in_array($key, $superGlobalArrays) &&
                !$snapshot->blacklist()->isGlobalVariableBlacklisted($key)) {
                if (isset($globalVariables[$key])) {
                    $GLOBALS[$key] = $globalVariables[$key];
                } else {
                    unset($GLOBALS[$key]);
                }
            }
        }
    }

    /**
     * Restores all static attributes in user-defined classes from this snapshot.
     *
     * @param Snapshot $snapshot
     */
    public function restoreStaticAttributes(Snapshot $snapshot)
    {
        $current    = new Snapshot($snapshot->blacklist(), false, false, false, false, true, false, false, false, false);
        $newClasses = array_diff($current->classes(), $snapshot->classes());
        unset($current);

        foreach ($snapshot->staticAttributes() as $className => $staticAttributes) {
            foreach ($staticAttributes as $name => $value) {
                $reflector = new ReflectionProperty($className, $name);
                $reflector->setAccessible(true);
                $reflector->setValue($value);
            }
        }

        foreach ($newClasses as $className) {
            $class    = new \ReflectionClass($className);
            $defaults = $class->getDefaultProperties();

            foreach ($class->getProperties() as $attribute) {
                if (!$attribute->isStatic()) {
                    continue;
                }

                $name = $attribute->getName();

                if ($snapshot->blacklist()->isStaticAttributeBlacklisted($className, $name)) {
                    continue;
                }

                if (!isset($defaults[$name])) {
                    continue;
                }

                $attribute->setAccessible(true);
                $attribute->setValue($defaults[$name]);
            }
        }
    }

    /**
     * Restores a super-global variable array from this snapshot.
     *
     * @param Snapshot $snapshot
     * @param $superGlobalArray
     */
    private function restoreSuperGlobalArray(Snapshot $snapshot, $superGlobalArray)
    {
        $superGlobalVariables = $snapshot->superGlobalVariables();

        if (isset($GLOBALS[$superGlobalArray]) &&
            is_array($GLOBALS[$superGlobalArray]) &&
            isset($superGlobalVariables[$superGlobalArray])) {
            $keys = array_keys(
                array_merge(
                    $GLOBALS[$superGlobalArray],
                    $superGlobalVariables[$superGlobalArray]
                )
            );

            foreach ($keys as $key) {
                if (isset($superGlobalVariables[$superGlobalArray][$key])) {
                    $GLOBALS[$superGlobalArray][$key] = $superGlobalVariables[$superGlobalArray][$key];
                } else {
                    unset($GLOBALS[$superGlobalArray][$key]);
                }
            }
        }
    }
}
<?php
/*
 * This file is part of the GlobalState package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\GlobalState;

use ReflectionClass;

/**
 * A blacklist for global state elements that should not be snapshotted.
 */
class Blacklist
{
    /**
     * @var array
     */
    private $globalVariables = array();

    /**
     * @var array
     */
    private $classes = array();

    /**
     * @var array
     */
    private $classNamePrefixes = array();

    /**
     * @var array
     */
    private $parentClasses = array();

    /**
     * @var array
     */
    private $interfaces = array();

    /**
     * @var array
     */
    private $staticAttributes = array();

    /**
     * @param string $variableName
     */
    public function addGlobalVariable($variableName)
    {
        $this->globalVariables[$variableName] = true;
    }

    /**
     * @param string $className
     */
    public function addClass($className)
    {
        $this->classes[] = $className;
    }

    /**
     * @param string $className
     */
    public function addSubclassesOf($className)
    {
        $this->parentClasses[] = $className;
    }

    /**
     * @param string $interfaceName
     */
    public function addImplementorsOf($interfaceName)
    {
        $this->interfaces[] = $interfaceName;
    }

    /**
     * @param string $classNamePrefix
     */
    public function addClassNamePrefix($classNamePrefix)
    {
        $this->classNamePrefixes[] = $classNamePrefix;
    }

    /**
     * @param string $className
     * @param string $attributeName
     */
    public function addStaticAttribute($className, $attributeName)
    {
        if (!isset($this->staticAttributes[$className])) {
            $this->staticAttributes[$className] = array();
        }

        $this->staticAttributes[$className][$attributeName] = true;
    }

    /**
     * @param  string $variableName
     * @return bool
     */
    public function isGlobalVariableBlacklisted($variableName)
    {
        return isset($this->globalVariables[$variableName]);
    }

    /**
     * @param  string $className
     * @param  string $attributeName
     * @return bool
     */
    public function isStaticAttributeBlacklisted($className, $attributeName)
    {
        if (in_array($className, $this->classes)) {
            return true;
        }

        foreach ($this->classNamePrefixes as $prefix) {
            if (strpos($className, $prefix) === 0) {
                return true;
            }
        }

        $class = new ReflectionClass($className);

        foreach ($this->parentClasses as $type) {
            if ($class->isSubclassOf($type)) {
                return true;
            }
        }

        foreach ($this->interfaces as $type) {
            if ($class->implementsInterface($type)) {
                return true;
            }
        }

        if (isset($this->staticAttributes[$className][$attributeName])) {
            return true;
        }

        return false;
    }
}
<?php
/*
 * This file is part of the GlobalState package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\GlobalState;

/**
 */
class RuntimeException extends \RuntimeException implements Exception
{
}
<?php
/*
 * This file is part of the GlobalState package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\GlobalState;

/**
 * Exports parts of a Snapshot as PHP code.
 */
class CodeExporter
{
    /**
     * @param  Snapshot $snapshot
     * @return string
     */
    public function constants(Snapshot $snapshot)
    {
        $result = '';

        foreach ($snapshot->constants() as $name => $value) {
            $result .= sprintf(
                'if (!defined(\'%s\')) define(\'%s\', %s);' . "\n",
                $name,
                $name,
                $this->exportVariable($value)
            );
        }

        return $result;
    }

    /**
     * @param  Snapshot $snapshot
     * @return string
     */
    public function iniSettings(Snapshot $snapshot)
    {
        $result = '';

        foreach ($snapshot->iniSettings() as $key => $value) {
            $result .= sprintf(
                '@ini_set(%s, %s);' . "\n",
                $this->exportVariable($key),
                $this->exportVariable($value)
            );
        }

        return $result;
    }

    /**
     * @param  mixed  $variable
     * @return string
     */
    private function exportVariable($variable)
    {
        if (is_scalar($variable) || is_null($variable) ||
            (is_array($variable) && $this->arrayOnlyContainsScalars($variable))) {
            return var_export($variable, true);
        }

        return 'unserialize(' . var_export(serialize($variable), true) . ')';
    }

    /**
     * @param  array $array
     * @return bool
     */
    private function arrayOnlyContainsScalars(array $array)
    {
        $result = true;

        foreach ($array as $element) {
            if (is_array($element)) {
                $result = self::arrayOnlyContainsScalars($element);
            } elseif (!is_scalar($element) && !is_null($element)) {
                $result = false;
            }

            if ($result === false) {
                break;
            }
        }

        return $result;
    }
}
Text_Template

Copyright (c) 2009-2015, Sebastian Bergmann <sebastian@phpunit.de>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

 * Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in
   the documentation and/or other materials provided with the
   distribution.

 * Neither the name of Sebastian Bergmann nor the names of his
   contributors may be used to endorse or promote products derived
   from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.
<?php
/*
 * This file is part of the Text_Template package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

/**
 * A simple template engine.
 *
 * @since Class available since Release 1.0.0
 */
class Text_Template
{
    /**
     * @var string
     */
    protected $template = '';

    /**
     * @var string
     */
    protected $openDelimiter = '{';

    /**
     * @var string
     */
    protected $closeDelimiter = '}';

    /**
     * @var array
     */
    protected $values = array();

    /**
     * Constructor.
     *
     * @param  string                   $file
     * @throws InvalidArgumentException
     */
    public function __construct($file = '', $openDelimiter = '{', $closeDelimiter = '}')
    {
        $this->setFile($file);
        $this->openDelimiter  = $openDelimiter;
        $this->closeDelimiter = $closeDelimiter;
    }

    /**
     * Sets the template file.
     *
     * @param  string                   $file
     * @throws InvalidArgumentException
     */
    public function setFile($file)
    {
        $distFile = $file . '.dist';

        if (file_exists($file)) {
            $this->template = file_get_contents($file);
        }

        else if (file_exists($distFile)) {
            $this->template = file_get_contents($distFile);
        }

        else {
            throw new InvalidArgumentException(
              'Template file could not be loaded.'
            );
        }
    }

    /**
     * Sets one or more template variables.
     *
     * @param array $values
     * @param bool  $merge
     */
    public function setVar(array $values, $merge = TRUE)
    {
        if (!$merge || empty($this->values)) {
            $this->values = $values;
        } else {
            $this->values = array_merge($this->values, $values);
        }
    }

    /**
     * Renders the template and returns the result.
     *
     * @return string
     */
    public function render()
    {
        $keys = array();

        foreach ($this->values as $key => $value) {
            $keys[] = $this->openDelimiter . $key . $this->closeDelimiter;
        }

        return str_replace($keys, $this->values, $this->template);
    }

    /**
     * Renders the template and writes the result to a file.
     *
     * @param string $target
     */
    public function renderTo($target)
    {
        $fp = @fopen($target, 'wt');

        if ($fp) {
            fwrite($fp, $this->render());
            fclose($fp);
        } else {
            $error = error_get_last();

            throw new RuntimeException(
              sprintf(
                'Could not write to %s: %s',
                $target,
                substr(
                  $error['message'],
                  strpos($error['message'], ':') + 2
                )
              )
            );
        }
    }
}

Diff

Copyright (c) 2002-2015, Sebastian Bergmann <sebastian@phpunit.de>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

 * Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in
   the documentation and/or other materials provided with the
   distribution.

 * Neither the name of Sebastian Bergmann nor the names of his
   contributors may be used to endorse or promote products derived
   from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.
<?php
/*
 * This file is part of the Diff package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Diff\LCS;

/**
 * Interface for implementations of longest common subsequence calculation.
 *
 * @package    Diff
 * @author     Sebastian Bergmann <sebastian@phpunit.de>
 * @author     Kore Nordmann <mail@kore-nordmann.de>
 * @copyright  Sebastian Bergmann <sebastian@phpunit.de>
 * @license    http://www.opensource.org/licenses/BSD-3-Clause  The BSD 3-Clause License
 * @link       http://www.github.com/sebastianbergmann/diff
 */
interface LongestCommonSubsequence
{
    /**
     * Calculates the longest common subsequence of two arrays.
     *
     * @param  array $from
     * @param  array $to
     * @return array
     */
    public function calculate(array $from, array $to);
}
<?php
/*
 * This file is part of the Diff package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Diff\LCS;

/**
 * Memory-efficient implementation of longest common subsequence calculation.
 *
 * @package    Diff
 * @author     Sebastian Bergmann <sebastian@phpunit.de>
 * @author     Denes Lados <lados.denes@gmail.com>
 * @copyright  Sebastian Bergmann <sebastian@phpunit.de>
 * @license    http://www.opensource.org/licenses/BSD-3-Clause  The BSD 3-Clause License
 * @link       http://www.github.com/sebastianbergmann/diff
 */
class MemoryEfficientImplementation implements LongestCommonSubsequence
{
    /**
     * Calculates the longest common subsequence of two arrays.
     *
     * @param  array $from
     * @param  array $to
     * @return array
     */
    public function calculate(array $from, array $to)
    {
        $cFrom = count($from);
        $cTo   = count($to);

        if ($cFrom == 0) {
            return array();
        } elseif ($cFrom == 1) {
            if (in_array($from[0], $to)) {
                return array($from[0]);
            } else {
                return array();
            }
        } else {
            $i         = intval($cFrom / 2);
            $fromStart = array_slice($from, 0, $i);
            $fromEnd   = array_slice($from, $i);
            $llB       = $this->length($fromStart, $to);
            $llE       = $this->length(array_reverse($fromEnd), array_reverse($to));
            $jMax      = 0;
            $max       = 0;

            for ($j = 0; $j <= $cTo; $j++) {
                $m = $llB[$j] + $llE[$cTo - $j];

                if ($m >= $max) {
                    $max  = $m;
                    $jMax = $j;
                }
            }

            $toStart = array_slice($to, 0, $jMax);
            $toEnd   = array_slice($to, $jMax);

            return array_merge(
                $this->calculate($fromStart, $toStart),
                $this->calculate($fromEnd, $toEnd)
            );
        }
    }

    /**
     * @param array $from
     * @param array $to
     * @return array
     */
    private function length(array $from, array $to)
    {
        $current = array_fill(0, count($to) + 1, 0);
        $cFrom   = count($from);
        $cTo     = count($to);

        for ($i = 0; $i < $cFrom; $i++) {
            $prev = $current;

            for ($j = 0; $j < $cTo; $j++) {
                if ($from[$i] == $to[$j]) {
                    $current[$j + 1] = $prev[$j] + 1;
                } else {
                    $current[$j + 1] = max($current[$j], $prev[$j + 1]);
                }
            }
        }

        return $current;
    }
}
<?php
/*
 * This file is part of the Diff package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Diff\LCS;

/**
 * Time-efficient implementation of longest common subsequence calculation.
 *
 * @package    Diff
 * @author     Sebastian Bergmann <sebastian@phpunit.de>
 * @author     Kore Nordmann <mail@kore-nordmann.de>
 * @copyright  Sebastian Bergmann <sebastian@phpunit.de>
 * @license    http://www.opensource.org/licenses/BSD-3-Clause  The BSD 3-Clause License
 * @link       http://www.github.com/sebastianbergmann/diff
 */
class TimeEfficientImplementation implements LongestCommonSubsequence
{
    /**
     * Calculates the longest common subsequence of two arrays.
     *
     * @param  array $from
     * @param  array $to
     * @return array
     */
    public function calculate(array $from, array $to)
    {
        $common     = array();
        $fromLength = count($from);
        $toLength   = count($to);
        $width      = $fromLength + 1;
        $matrix     = new \SplFixedArray($width * ($toLength + 1));

        for ($i = 0; $i <= $fromLength; ++$i) {
            $matrix[$i] = 0;
        }

        for ($j = 0; $j <= $toLength; ++$j) {
            $matrix[$j * $width] = 0;
        }

        for ($i = 1; $i <= $fromLength; ++$i) {
            for ($j = 1; $j <= $toLength; ++$j) {
                $o = ($j * $width) + $i;
                $matrix[$o] = max(
                    $matrix[$o - 1],
                    $matrix[$o - $width],
                    $from[$i - 1] === $to[$j - 1] ? $matrix[$o - $width - 1] + 1 : 0
                );
            }
        }

        $i = $fromLength;
        $j = $toLength;

        while ($i > 0 && $j > 0) {
            if ($from[$i-1] === $to[$j-1]) {
                $common[] = $from[$i-1];
                --$i;
                --$j;
            } else {
                $o = ($j * $width) + $i;
                if ($matrix[$o - $width] > $matrix[$o - 1]) {
                    --$j;
                } else {
                    --$i;
                }
            }
        }

        return array_reverse($common);
    }
}
<?php
/*
 * This file is part of the Diff package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Diff;

/**
 * @package    Diff
 * @author     Sebastian Bergmann <sebastian@phpunit.de>
 * @author     Kore Nordmann <mail@kore-nordmann.de>
 * @copyright  Sebastian Bergmann <sebastian@phpunit.de>
 * @license    http://www.opensource.org/licenses/BSD-3-Clause  The BSD 3-Clause License
 * @link       http://www.github.com/sebastianbergmann/diff
 */
class Line
{
    const ADDED = 1;
    const REMOVED = 2;
    const UNCHANGED = 3;

    /**
     * @var int
     */
    private $type;

    /**
     * @var string
     */
    private $content;

    /**
     * @param int    $type
     * @param string $content
     */
    public function __construct($type = self::UNCHANGED, $content = '')
    {
        $this->type    = $type;
        $this->content = $content;
    }

    /**
     * @return string
     */
    public function getContent()
    {
        return $this->content;
    }

    /**
     * @return int
     */
    public function getType()
    {
        return $this->type;
    }
}
<?php
/*
 * This file is part of the Diff package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Diff;

use SebastianBergmann\Diff\LCS\LongestCommonSubsequence;
use SebastianBergmann\Diff\LCS\TimeEfficientImplementation;
use SebastianBergmann\Diff\LCS\MemoryEfficientImplementation;

/**
 * Diff implementation.
 *
 * @package    Diff
 * @author     Sebastian Bergmann <sebastian@phpunit.de>
 * @author     Kore Nordmann <mail@kore-nordmann.de>
 * @copyright  Sebastian Bergmann <sebastian@phpunit.de>
 * @license    http://www.opensource.org/licenses/BSD-3-Clause  The BSD 3-Clause License
 * @link       http://www.github.com/sebastianbergmann/diff
 */
class Differ
{
    /**
     * @var string
     */
    private $header;

    /**
     * @param string $header
     */
    public function __construct($header = "--- Original\n+++ New\n")
    {
        $this->header = $header;
    }

    /**
     * Returns the diff between two arrays or strings as string.
     *
     * @param  array|string             $from
     * @param  array|string             $to
     * @param  LongestCommonSubsequence $lcs
     * @return string
     */
    public function diff($from, $to, LongestCommonSubsequence $lcs = null)
    {
        if (!is_array($from) && !is_string($from)) {
            $from = (string) $from;
        }

        if (!is_array($to) && !is_string($to)) {
            $to = (string) $to;
        }

        $buffer = $this->header;
        $diff   = $this->diffToArray($from, $to, $lcs);

        $inOld = false;
        $i     = 0;
        $old   = array();

        foreach ($diff as $line) {
            if ($line[1] ===  0 /* OLD */) {
                if ($inOld === false) {
                    $inOld = $i;
                }
            } elseif ($inOld !== false) {
                if (($i - $inOld) > 5) {
                    $old[$inOld] = $i - 1;
                }

                $inOld = false;
            }

            ++$i;
        }

        $start = isset($old[0]) ? $old[0] : 0;
        $end   = count($diff);

        if ($tmp = array_search($end, $old)) {
            $end = $tmp;
        }

        $newChunk = true;

        for ($i = $start; $i < $end; $i++) {
            if (isset($old[$i])) {
                $buffer  .= "\n";
                $newChunk = true;
                $i        = $old[$i];
            }

            if ($newChunk) {
                $buffer  .= "@@ @@\n";
                $newChunk = false;
            }

            if ($diff[$i][1] === 1 /* ADDED */) {
                $buffer .= '+' . $diff[$i][0] . "\n";
            } elseif ($diff[$i][1] === 2 /* REMOVED */) {
                $buffer .= '-' . $diff[$i][0] . "\n";
            } else {
                $buffer .= ' ' . $diff[$i][0] . "\n";
            }
        }

        return $buffer;
    }

    /**
     * Returns the diff between two arrays or strings as array.
     *
     * Each array element contains two elements:
     *   - [0] => string $token
     *   - [1] => 2|1|0
     *
     * - 2: REMOVED: $token was removed from $from
     * - 1: ADDED: $token was added to $from
     * - 0: OLD: $token is not changed in $to
     *
     * @param  array|string             $from
     * @param  array|string             $to
     * @param  LongestCommonSubsequence $lcs
     * @return array
     */
    public function diffToArray($from, $to, LongestCommonSubsequence $lcs = null)
    {
        preg_match_all('(\r\n|\r|\n)', $from, $fromMatches);
        preg_match_all('(\r\n|\r|\n)', $to, $toMatches);

        if (is_string($from)) {
            $from = preg_split('(\r\n|\r|\n)', $from);
        }

        if (is_string($to)) {
            $to = preg_split('(\r\n|\r|\n)', $to);
        }

        $start      = array();
        $end        = array();
        $fromLength = count($from);
        $toLength   = count($to);
        $length     = min($fromLength, $toLength);

        for ($i = 0; $i < $length; ++$i) {
            if ($from[$i] === $to[$i]) {
                $start[] = $from[$i];
                unset($from[$i], $to[$i]);
            } else {
                break;
            }
        }

        $length -= $i;

        for ($i = 1; $i < $length; ++$i) {
            if ($from[$fromLength - $i] === $to[$toLength - $i]) {
                array_unshift($end, $from[$fromLength - $i]);
                unset($from[$fromLength - $i], $to[$toLength - $i]);
            } else {
                break;
            }
        }

        if ($lcs === null) {
            $lcs = $this->selectLcsImplementation($from, $to);
        }

        $common = $lcs->calculate(array_values($from), array_values($to));
        $diff   = array();

        if (isset($fromMatches[0]) && $toMatches[0] &&
            count($fromMatches[0]) === count($toMatches[0]) &&
            $fromMatches[0] !== $toMatches[0]) {
            $diff[] = array(
              '#Warning: Strings contain different line endings!', 0
            );
        }

        foreach ($start as $token) {
            $diff[] = array($token, 0 /* OLD */);
        }

        reset($from);
        reset($to);

        foreach ($common as $token) {
            while ((($fromToken = reset($from)) !== $token)) {
                $diff[] = array(array_shift($from), 2 /* REMOVED */);
            }

            while ((($toToken = reset($to)) !== $token)) {
                $diff[] = array(array_shift($to), 1 /* ADDED */);
            }

            $diff[] = array($token, 0 /* OLD */);

            array_shift($from);
            array_shift($to);
        }

        while (($token = array_shift($from)) !== null) {
            $diff[] = array($token, 2 /* REMOVED */);
        }

        while (($token = array_shift($to)) !== null) {
            $diff[] = array($token, 1 /* ADDED */);
        }

        foreach ($end as $token) {
            $diff[] = array($token, 0 /* OLD */);
        }

        return $diff;
    }

    /**
     * @param  array $from
     * @param  array $to
     * @return LongestCommonSubsequence
     */
    private function selectLcsImplementation(array $from, array $to)
    {
        // We do not want to use the time-efficient implementation if its memory
        // footprint will probably exceed this value. Note that the footprint
        // calculation is only an estimation for the matrix and the LCS method
        // will typically allocate a bit more memory than this.
        $memoryLimit = 100 * 1024 * 1024;

        if ($this->calculateEstimatedFootprint($from, $to) > $memoryLimit) {
            return new MemoryEfficientImplementation;
        }

        return new TimeEfficientImplementation;
    }

    /**
     * Calculates the estimated memory footprint for the DP-based method.
     *
     * @param  array $from
     * @param  array $to
     * @return integer
     */
    private function calculateEstimatedFootprint(array $from, array $to)
    {
        $itemSize = PHP_INT_SIZE == 4 ? 76 : 144;

        return $itemSize * pow(min(count($from), count($to)), 2);
    }
}
<?php
/*
 * This file is part of the Diff package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Diff;

/**
 * Unified diff parser.
 *
 * @package    Diff
 * @author     Sebastian Bergmann <sebastian@phpunit.de>
 * @author     Kore Nordmann <mail@kore-nordmann.de>
 * @copyright  Sebastian Bergmann <sebastian@phpunit.de>
 * @license    http://www.opensource.org/licenses/BSD-3-Clause  The BSD 3-Clause License
 * @link       http://www.github.com/sebastianbergmann/diff
 */
class Parser
{
    /**
     * @param  string $string
     * @return Diff[]
     */
    public function parse($string)
    {
        $lines     = preg_split('(\r\n|\r|\n)', $string);
        $lineCount = count($lines);
        $diffs     = array();
        $diff      = null;
        $collected = array();

        for ($i = 0; $i < $lineCount; ++$i) {
            if (preg_match('(^---\\s+(?P<file>\\S+))', $lines[$i], $fromMatch) &&
                preg_match('(^\\+\\+\\+\\s+(?P<file>\\S+))', $lines[$i + 1], $toMatch)) {
                if ($diff !== null) {
                    $this->parseFileDiff($diff, $collected);
                    $diffs[]   = $diff;
                    $collected = array();
                }

                $diff = new Diff($fromMatch['file'], $toMatch['file']);
                ++$i;
            } else {
                if (preg_match('/^(?:diff --git |index [\da-f\.]+|[+-]{3} [ab])/', $lines[$i])) {
                    continue;
                }
                $collected[] = $lines[$i];
            }
        }

        if (count($collected) && ($diff !== null)) {
            $this->parseFileDiff($diff, $collected);
            $diffs[] = $diff;
        }

        return $diffs;
    }

    /**
     * @param Diff  $diff
     * @param array $lines
     */
    private function parseFileDiff(Diff $diff, array $lines)
    {
        $chunks = array();

        foreach ($lines as $line) {
            if (preg_match('/^@@\s+-(?P<start>\d+)(?:,\s*(?P<startrange>\d+))?\s+\+(?P<end>\d+)(?:,\s*(?P<endrange>\d+))?\s+@@/', $line, $match)) {
                $chunk = new Chunk(
                    $match['start'],
                    isset($match['startrange']) ? max(1, $match['startrange']) : 1,
                    $match['end'],
                    isset($match['endrange']) ? max(1, $match['endrange']) : 1
                );

                $chunks[] = $chunk;
                $diffLines = array();
                continue;
            }

            if (preg_match('/^(?P<type>[+ -])?(?P<line>.*)/', $line, $match)) {
                $type = Line::UNCHANGED;

                if ($match['type'] == '+') {
                    $type = Line::ADDED;
                } elseif ($match['type'] == '-') {
                    $type = Line::REMOVED;
                }

                $diffLines[] = new Line($type, $match['line']);

                if (isset($chunk)) {
                    $chunk->setLines($diffLines);
                }
            }
        }

        $diff->setChunks($chunks);
    }
}
<?php
/*
 * This file is part of the Diff package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Diff;

/**
 * @package    Diff
 * @author     Sebastian Bergmann <sebastian@phpunit.de>
 * @author     Kore Nordmann <mail@kore-nordmann.de>
 * @copyright  Sebastian Bergmann <sebastian@phpunit.de>
 * @license    http://www.opensource.org/licenses/BSD-3-Clause  The BSD 3-Clause License
 * @link       http://www.github.com/sebastianbergmann/diff
 */
class Diff
{
    /**
     * @var string
     */
    private $from;

    /**
     * @var string
     */
    private $to;

    /**
     * @var Chunk[]
     */
    private $chunks;

    /**
     * @param string  $from
     * @param string  $to
     * @param Chunk[] $chunks
     */
    public function __construct($from, $to, array $chunks = array())
    {
        $this->from   = $from;
        $this->to     = $to;
        $this->chunks = $chunks;
    }

    /**
     * @return string
     */
    public function getFrom()
    {
        return $this->from;
    }

    /**
     * @return string
     */
    public function getTo()
    {
        return $this->to;
    }

    /**
     * @return Chunk[]
     */
    public function getChunks()
    {
        return $this->chunks;
    }

    /**
     * @param Chunk[] $chunks
     */
    public function setChunks(array $chunks)
    {
        $this->chunks = $chunks;
    }
}
<?php
/*
 * This file is part of the Diff package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Diff;

/**
 * @package    Diff
 * @author     Sebastian Bergmann <sebastian@phpunit.de>
 * @author     Kore Nordmann <mail@kore-nordmann.de>
 * @copyright  Sebastian Bergmann <sebastian@phpunit.de>
 * @license    http://www.opensource.org/licenses/BSD-3-Clause  The BSD 3-Clause License
 * @link       http://www.github.com/sebastianbergmann/diff
 */
class Chunk
{
    /**
     * @var int
     */
    private $start;

    /**
     * @var int
     */
    private $startRange;

    /**
     * @var int
     */
    private $end;
    /**
     * @var int
     */
    private $endRange;

    /**
     * @var array
     */
    private $lines;

    /**
     * @param int   $start
     * @param int   $startRange
     * @param int   $end
     * @param int   $endRange
     * @param array $lines
     */
    public function __construct($start = 0, $startRange = 1, $end = 0, $endRange = 1, array $lines = array())
    {
        $this->start      = (int) $start;
        $this->startRange = (int) $startRange;
        $this->end        = (int) $end;
        $this->endRange   = (int) $endRange;
        $this->lines      = $lines;
    }

    /**
     * @return int
     */
    public function getStart()
    {
        return $this->start;
    }

    /**
     * @return int
     */
    public function getStartRange()
    {
        return $this->startRange;
    }

    /**
     * @return int
     */
    public function getEnd()
    {
        return $this->end;
    }

    /**
     * @return int
     */
    public function getEndRange()
    {
        return $this->endRange;
    }

    /**
     * @return array
     */
    public function getLines()
    {
        return $this->lines;
    }

    /**
     * @param array $lines
     */
    public function setLines(array $lines)
    {
        $this->lines = $lines;
    }
}
The MIT License (MIT)

Copyright (c) 2013 My C-Sense

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
<?php

namespace DeepCopy;

use DeepCopy\Exception\CloneException;
use DeepCopy\Filter\Filter;
use DeepCopy\Matcher\Matcher;
use DeepCopy\TypeFilter\TypeFilter;
use DeepCopy\TypeMatcher\TypeMatcher;
use ReflectionProperty;
use DeepCopy\Reflection\ReflectionHelper;

/**
 * DeepCopy
 */
class DeepCopy
{
    /**
     * @var array
     */
    private $hashMap = [];

    /**
     * Filters to apply.
     * @var array
     */
    private $filters = [];

    /**
     * Type Filters to apply.
     * @var array
     */
    private $typeFilters = [];

    private $skipUncloneable = false;

    /**
     * Cloning uncloneable properties won't throw exception.
     * @param $skipUncloneable
     * @return $this
     */
    public function skipUncloneable($skipUncloneable = true)
    {
        $this->skipUncloneable = $skipUncloneable;
        return $this;
    }

    /**
     * Perform a deep copy of the object.
     * @param mixed $object
     * @return mixed
     */
    public function copy($object)
    {
        $this->hashMap = [];

        return $this->recursiveCopy($object);
    }

    public function addFilter(Filter $filter, Matcher $matcher)
    {
        $this->filters[] = [
            'matcher' => $matcher,
            'filter'  => $filter,
        ];
    }

    public function addTypeFilter(TypeFilter $filter, TypeMatcher $matcher)
    {
        $this->typeFilters[] = [
            'matcher' => $matcher,
            'filter'  => $filter,
        ];
    }


    private function recursiveCopy($var)
    {
        // Matches Type Filter
        if ($filter = $this->getFirstMatchedTypeFilter($this->typeFilters, $var)) {
            return $filter->apply($var);
        }

        // Resource
        if (is_resource($var)) {
            return $var;
        }
        // Array
        if (is_array($var)) {
            return $this->copyArray($var);
        }
        // Scalar
        if (! is_object($var)) {
            return $var;
        }
        // Object
        return $this->copyObject($var);
    }

    /**
     * Copy an array
     * @param array $array
     * @return array
     */
    private function copyArray(array $array)
    {
        $copier = function($item) {
            return $this->recursiveCopy($item);
        };

        return array_map($copier, $array);
    }

    /**
     * Copy an object
     * @param object $object
     * @return object
     */
    private function copyObject($object)
    {
        $objectHash = spl_object_hash($object);

        if (isset($this->hashMap[$objectHash])) {
            return $this->hashMap[$objectHash];
        }

        $reflectedObject = new \ReflectionObject($object);

        if (false === $isCloneable = $reflectedObject->isCloneable() and $this->skipUncloneable) {
            $this->hashMap[$objectHash] = $object;
            return $object;
        }

        if (false === $isCloneable) {
            throw new CloneException(sprintf(
                'Class "%s" is not cloneable.',
                $object->getName()
            ));
        }

        $newObject = clone $object;
        $this->hashMap[$objectHash] = $newObject;

        foreach (ReflectionHelper::getProperties($reflectedObject) as $property) {
            $this->copyObjectProperty($newObject, $property);
        }

        return $newObject;
    }

    private function copyObjectProperty($object, ReflectionProperty $property)
    {
        // Ignore static properties
        if ($property->isStatic()) {
            return;
        }

        // Apply the filters
        foreach ($this->filters as $item) {
            /** @var Matcher $matcher */
            $matcher = $item['matcher'];
            /** @var Filter $filter */
            $filter = $item['filter'];

            if ($matcher->matches($object, $property->getName())) {
                $filter->apply(
                    $object,
                    $property->getName(),
                    function ($object) {
                        return $this->recursiveCopy($object);
                    }
                );
                // If a filter matches, we stop processing this property
                return;
            }
        }

        $property->setAccessible(true);
        $propertyValue = $property->getValue($object);

        // Copy the property
        $property->setValue($object, $this->recursiveCopy($propertyValue));
    }

    /**
     * Returns first filter that matches variable, NULL if no such filter found.
     * @param array $filterRecords Associative array with 2 members: 'filter' with value of type {@see TypeFilter} and
     *                             'matcher' with value of type {@see TypeMatcher}
     * @param mixed $var
     * @return TypeFilter|null
     */
    private function getFirstMatchedTypeFilter(array $filterRecords, $var)
    {
        $matched = $this->first(
            $filterRecords,
            function (array $record) use ($var) {
                /* @var TypeMatcher $matcher */
                $matcher = $record['matcher'];

                return $matcher->matches($var);
            }
        );

        return isset($matched) ? $matched['filter'] : null;
    }

    /**
     * Returns first element that matches predicate, NULL if no such element found.
     * @param array    $elements
     * @param callable $predicate Predicate arguments are: element.
     * @return mixed|null
     */
    private function first(array $elements, callable $predicate)
    {
        foreach ($elements as $element) {
            if (call_user_func($predicate, $element)) {
                return $element;
            }
        }

        return null;
    }
}
<?php

namespace DeepCopy\Filter\Doctrine;

use DeepCopy\Filter\Filter;
use Doctrine\Common\Collections\ArrayCollection;

class DoctrineEmptyCollectionFilter implements Filter
{
    /**
     * Apply the filter to the object.
     *
     * @param object   $object
     * @param string   $property
     * @param callable $objectCopier
     */
    public function apply($object, $property, $objectCopier)
    {
        $reflectionProperty = new \ReflectionProperty($object, $property);
        $reflectionProperty->setAccessible(true);

        $reflectionProperty->setValue($object, new ArrayCollection());
    }
} <?php

namespace DeepCopy\Filter\Doctrine;

use DeepCopy\Filter\Filter;
use ReflectionProperty;

/**
 * Set a null value for a property
 */
class DoctrineCollectionFilter implements Filter
{
    /**
     * {@inheritdoc}
     */
    public function apply($object, $property, $objectCopier)
    {
        $reflectionProperty = new ReflectionProperty($object, $property);

        $reflectionProperty->setAccessible(true);
        $oldCollection = $reflectionProperty->getValue($object);

        $newCollection = $oldCollection->map(
            function ($item) use ($objectCopier) {
                return $objectCopier($item);
            }
        );

        $reflectionProperty->setValue($object, $newCollection);
    }
}
<?php

namespace DeepCopy\Filter;

/**
 * Replace the value of a property
 */
class ReplaceFilter implements Filter
{
    /**
     * @var callable
     */
    protected $callback;

    /**
     * @param callable $callable Will be called to get the new value for each property to replace
     */
    public function __construct(callable $callable)
    {
        $this->callback = $callable;
    }

    /**
     * {@inheritdoc}
     */
    public function apply($object, $property, $objectCopier)
    {
        $reflectionProperty = new \ReflectionProperty($object, $property);
        $reflectionProperty->setAccessible(true);

        $value = call_user_func($this->callback, $reflectionProperty->getValue($object));

        $reflectionProperty->setValue($object, $value);
    }
}
<?php

namespace DeepCopy\Filter;

use ReflectionProperty;

/**
 * Set a null value for a property
 */
class SetNullFilter implements Filter
{
    /**
     * {@inheritdoc}
     */
    public function apply($object, $property, $objectCopier)
    {
        $reflectionProperty = new ReflectionProperty($object, $property);

        $reflectionProperty->setAccessible(true);
        $reflectionProperty->setValue($object, null);
    }
}
<?php

namespace DeepCopy\Filter;

/**
 * Filter to apply to a property while copying an object
 */
interface Filter
{
    /**
     * Apply the filter to the object.
     * @param object   $object
     * @param string   $property
     * @param callable $objectCopier
     */
    public function apply($object, $property, $objectCopier);
}
<?php

namespace DeepCopy\Filter;

/**
 * Keep the value of a property
 */
class KeepFilter implements Filter
{
    /**
     * {@inheritdoc}
     */
    public function apply($object, $property, $objectCopier)
    {
        // Nothing to do
    }
}
<?php
namespace DeepCopy\Exception;

class CloneException extends \UnexpectedValueException
{
} <?php

namespace DeepCopy\TypeMatcher;

/**
 * TypeMatcher class
 */
class TypeMatcher
{
    /**
     * @var string
     */
    private $type;

    /**
     * @param string $type
     */
    public function __construct($type)
    {
        $this->type = $type;
    }

    /**
     * @param $element
     * @return boolean
     */
    public function matches($element)
    {
        return is_object($element) ? is_a($element, $this->type) : gettype($element) === $this->type;
    }
}
<?php

namespace DeepCopy\Reflection;

class ReflectionHelper
{
    /**
     * Retrieves all properties (including private ones), from object and all its ancestors.
     *
     * Standard \ReflectionClass->getProperties() does not return private properties from ancestor classes.
     *
     * @author muratyaman@gmail.com
     * @see http://php.net/manual/en/reflectionclass.getproperties.php
     *
     * @param \ReflectionClass $ref
     * @return \ReflectionProperty[]
     */
    public static function getProperties(\ReflectionClass $ref)
    {
        $props = $ref->getProperties();
        $propsArr = array();

        foreach ($props as $prop) {
            $f = $prop->getName();
            $propsArr[$f] = $prop;
        }

        if ($parentClass = $ref->getParentClass()) {
            $parentPropsArr = self::getProperties($parentClass);
            if (count($parentPropsArr) > 0) {
                $propsArr = array_merge($parentPropsArr, $propsArr);
            }
        }
        return $propsArr;
    }
}
<?php

namespace DeepCopy\Matcher;

/**
 * Matcher interface
 */
interface Matcher
{
    /**
     * @param object $object
     * @param string $property
     * @return boolean
     */
    public function matches($object, $property);
}
<?php

namespace DeepCopy\Matcher;

/**
 * Match a specific property of a specific class
 */
class PropertyMatcher implements Matcher
{
    /**
     * @var string
     */
    private $class;

    /**
     * @var string
     */
    private $property;

    /**
     * @param string $class    Class name
     * @param string $property Property name
     */
    public function __construct($class, $property)
    {
        $this->class = $class;
        $this->property = $property;
    }

    /**
     * {@inheritdoc}
     */
    public function matches($object, $property)
    {
        return ($object instanceof $this->class) && ($property == $this->property);
    }
}
<?php

namespace DeepCopy\Matcher;

/**
 * Match a property by its name
 */
class PropertyNameMatcher implements Matcher
{
    /**
     * @var string
     */
    private $property;

    /**
     * @param string $property Property name
     */
    public function __construct($property)
    {
        $this->property = $property;
    }

    /**
     * {@inheritdoc}
     */
    public function matches($object, $property)
    {
        return $property == $this->property;
    }
}
<?php

namespace DeepCopy\Matcher;

use ReflectionProperty;

/**
 * Match a property by its type
 *
 * @deprecated It is recommended to use {@see DeepCopy\TypeFilter\TypeFilter} instead, as it applies on all occurrences
 *             of given type in copied context (eg. array elements), not just on object properties.
 */
class PropertyTypeMatcher implements Matcher
{
    /**
     * @var string
     */
    private $propertyType;

    /**
     * @param string $propertyType Property type
     */
    public function __construct($propertyType)
    {
        $this->propertyType = $propertyType;
    }

    /**
     * {@inheritdoc}
     */
    public function matches($object, $property)
    {
        $reflectionProperty = new ReflectionProperty($object, $property);
        $reflectionProperty->setAccessible(true);

        return $reflectionProperty->getValue($object) instanceof $this->propertyType;
    }
}
<?php

namespace DeepCopy\TypeFilter;

interface TypeFilter
{
    /**
     * Apply the filter to the object.
     * @param mixed $element
     */
    public function apply($element);
}
<?php

namespace DeepCopy\TypeFilter;

class ReplaceFilter implements TypeFilter
{
    /**
     * @var callable
     */
    protected $callback;

    /**
     * @param callable $callable Will be called to get the new value for each element to replace
     */
    public function __construct(callable $callable)
    {
        $this->callback = $callable;
    }

    /**
     * {@inheritdoc}
     */
    public function apply($element)
    {
        return call_user_func($this->callback, $element);
    }
}
<?php

namespace DeepCopy\TypeFilter;

class ShallowCopyFilter implements TypeFilter
{
    /**
     * {@inheritdoc}
     */
    public function apply($element)
    {
        return clone $element;
    }
}
<?php
/*
 * This file is part of the PHP_Timer package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

/**
 * Utility class for timing.
 *
 * @since      Class available since Release 1.0.0
 */
class PHP_Timer
{
    /**
     * @var array
     */
    private static $times = array(
      'hour'   => 3600000,
      'minute' => 60000,
      'second' => 1000
    );

    /**
     * @var array
     */
    private static $startTimes = array();

    /**
     * @var float
     */
    public static $requestTime;

    /**
     * Starts the timer.
     */
    public static function start()
    {
        array_push(self::$startTimes, microtime(true));
    }

    /**
     * Stops the timer and returns the elapsed time.
     *
     * @return float
     */
    public static function stop()
    {
        return microtime(true) - array_pop(self::$startTimes);
    }

    /**
     * Formats the elapsed time as a string.
     *
     * @param  float  $time
     * @return string
     */
    public static function secondsToTimeString($time)
    {
        $ms = round($time * 1000);

        foreach (self::$times as $unit => $value) {
            if ($ms >= $value) {
                $time = floor($ms / $value * 100.0) / 100.0;

                return $time . ' ' . ($time == 1 ? $unit : $unit . 's');
            }
        }

        return $ms . ' ms';
    }

    /**
     * Formats the elapsed time since the start of the request as a string.
     *
     * @return string
     */
    public static function timeSinceStartOfRequest()
    {
        return self::secondsToTimeString(microtime(true) - self::$requestTime);
    }

    /**
     * Returns the resources (time, memory) of the request as a string.
     *
     * @return string
     */
    public static function resourceUsage()
    {
        return sprintf(
            'Time: %s, Memory: %4.2fMb',
            self::timeSinceStartOfRequest(),
            memory_get_peak_usage(true) / 1048576
        );
    }
}

if (isset($_SERVER['REQUEST_TIME_FLOAT'])) {
    PHP_Timer::$requestTime = $_SERVER['REQUEST_TIME_FLOAT'];
} elseif (isset($_SERVER['REQUEST_TIME'])) {
    PHP_Timer::$requestTime = $_SERVER['REQUEST_TIME'];
} else {
    PHP_Timer::$requestTime = microtime(true);
}
PHP_Timer

Copyright (c) 2010-2015, Sebastian Bergmann <sebastian@phpunit.de>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

 * Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in
   the documentation and/or other materials provided with the
   distribution.

 * Neither the name of Sebastian Bergmann nor the names of his
   contributors may be used to endorse or promote products derived
   from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.
Comparator

Copyright (c) 2002-2015, Sebastian Bergmann <sebastian@phpunit.de>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

 * Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in
   the documentation and/or other materials provided with the
   distribution.

 * Neither the name of Sebastian Bergmann nor the names of his
   contributors may be used to endorse or promote products derived
   from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.
<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

use SebastianBergmann\Exporter\Exporter;

/**
 * Abstract base class for comparators which compare values for equality.
 */
abstract class Comparator
{
    /**
     * @var Factory
     */
    protected $factory;

    /**
     * @var Exporter
     */
    protected $exporter;

    public function __construct()
    {
        $this->exporter = new Exporter;
    }

    /**
     * @param Factory $factory
     */
    public function setFactory(Factory $factory)
    {
        $this->factory = $factory;
    }

    /**
     * Returns whether the comparator can compare two values.
     *
     * @param  mixed $expected The first value to compare
     * @param  mixed $actual   The second value to compare
     * @return bool
     */
    abstract public function accepts($expected, $actual);

    /**
     * Asserts that two values are equal.
     *
     * @param  mixed             $expected     The first value to compare
     * @param  mixed             $actual       The second value to compare
     * @param  float             $delta        The allowed numerical distance between two values to
     *                                         consider them equal
     * @param  bool              $canonicalize If set to TRUE, arrays are sorted before
     *                                         comparison
     * @param  bool              $ignoreCase   If set to TRUE, upper- and lowercasing is
     *                                         ignored when comparing string values
     * @throws ComparisonFailure Thrown when the comparison
     *                                        fails. Contains information about the
     *                                        specific errors that lead to the failure.
     */
    abstract public function assertEquals($expected, $actual, $delta = 0.0, $canonicalize = false, $ignoreCase = false);
}
<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

/**
 * Compares \SplObjectStorage instances for equality.
 */
class SplObjectStorageComparator extends Comparator
{
    /**
     * Returns whether the comparator can compare two values.
     *
     * @param  mixed $expected The first value to compare
     * @param  mixed $actual   The second value to compare
     * @return bool
     */
    public function accepts($expected, $actual)
    {
        return $expected instanceof \SplObjectStorage && $actual instanceof \SplObjectStorage;
    }

    /**
     * Asserts that two values are equal.
     *
     * @param  mixed             $expected     The first value to compare
     * @param  mixed             $actual       The second value to compare
     * @param  float             $delta        The allowed numerical distance between two values to
     *                                         consider them equal
     * @param  bool              $canonicalize If set to TRUE, arrays are sorted before
     *                                         comparison
     * @param  bool              $ignoreCase   If set to TRUE, upper- and lowercasing is
     *                                         ignored when comparing string values
     * @throws ComparisonFailure Thrown when the comparison
     *                                        fails. Contains information about the
     *                                        specific errors that lead to the failure.
     */
    public function assertEquals($expected, $actual, $delta = 0.0, $canonicalize = false, $ignoreCase = false)
    {
        foreach ($actual as $object) {
            if (!$expected->contains($object)) {
                throw new ComparisonFailure(
                    $expected,
                    $actual,
                    $this->exporter->export($expected),
                    $this->exporter->export($actual),
                    false,
                    'Failed asserting that two objects are equal.'
                );
            }
        }

        foreach ($expected as $object) {
            if (!$actual->contains($object)) {
                throw new ComparisonFailure(
                    $expected,
                    $actual,
                    $this->exporter->export($expected),
                    $this->exporter->export($actual),
                    false,
                    'Failed asserting that two objects are equal.'
                );
            }
        }
    }
}
<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

/**
 * Compares values for type equality.
 */
class TypeComparator extends Comparator
{
    /**
     * Returns whether the comparator can compare two values.
     *
     * @param  mixed $expected The first value to compare
     * @param  mixed $actual   The second value to compare
     * @return bool
     */
    public function accepts($expected, $actual)
    {
        return true;
    }

    /**
     * Asserts that two values are equal.
     *
     * @param  mixed             $expected     The first value to compare
     * @param  mixed             $actual       The second value to compare
     * @param  float             $delta        The allowed numerical distance between two values to
     *                                         consider them equal
     * @param  bool              $canonicalize If set to TRUE, arrays are sorted before
     *                                         comparison
     * @param  bool              $ignoreCase   If set to TRUE, upper- and lowercasing is
     *                                         ignored when comparing string values
     * @throws ComparisonFailure Thrown when the comparison
     *                                        fails. Contains information about the
     *                                        specific errors that lead to the failure.
     */
    public function assertEquals($expected, $actual, $delta = 0.0, $canonicalize = false, $ignoreCase = false)
    {
        if (gettype($expected) != gettype($actual)) {
            throw new ComparisonFailure(
                $expected,
                $actual,
                // we don't need a diff
                '',
                '',
                false,
                sprintf(
                    '%s does not match expected type "%s".',
                    $this->exporter->shortenedExport($actual),
                    gettype($expected)
                )
            );
        }
    }
}
<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

/**
 * Compares objects for equality.
 */
class ObjectComparator extends ArrayComparator
{
    /**
     * Returns whether the comparator can compare two values.
     *
     * @param  mixed $expected The first value to compare
     * @param  mixed $actual   The second value to compare
     * @return bool
     */
    public function accepts($expected, $actual)
    {
        return is_object($expected) && is_object($actual);
    }

    /**
     * Asserts that two values are equal.
     *
     * @param  mixed             $expected     The first value to compare
     * @param  mixed             $actual       The second value to compare
     * @param  float             $delta        The allowed numerical distance between two values to
     *                                         consider them equal
     * @param  bool              $canonicalize If set to TRUE, arrays are sorted before
     *                                         comparison
     * @param  bool              $ignoreCase   If set to TRUE, upper- and lowercasing is
     *                                         ignored when comparing string values
     * @param  array             $processed
     * @throws ComparisonFailure Thrown when the comparison
     *                                        fails. Contains information about the
     *                                        specific errors that lead to the failure.
     */
    public function assertEquals($expected, $actual, $delta = 0.0, $canonicalize = false, $ignoreCase = false, array &$processed = array())
    {
        if (get_class($actual) !== get_class($expected)) {
            throw new ComparisonFailure(
                $expected,
                $actual,
                $this->exporter->export($expected),
                $this->exporter->export($actual),
                false,
                sprintf(
                    '%s is not instance of expected class "%s".',
                    $this->exporter->export($actual),
                    get_class($expected)
                )
            );
        }

        // don't compare twice to allow for cyclic dependencies
        if (in_array(array($actual, $expected), $processed, true) ||
            in_array(array($expected, $actual), $processed, true)) {
            return;
        }

        $processed[] = array($actual, $expected);

        // don't compare objects if they are identical
        // this helps to avoid the error "maximum function nesting level reached"
        // CAUTION: this conditional clause is not tested
        if ($actual !== $expected) {
            try {
                parent::assertEquals(
                    $this->toArray($expected),
                    $this->toArray($actual),
                    $delta,
                    $canonicalize,
                    $ignoreCase,
                    $processed
                );
            } catch (ComparisonFailure $e) {
                throw new ComparisonFailure(
                    $expected,
                    $actual,
                    // replace "Array" with "MyClass object"
                    substr_replace($e->getExpectedAsString(), get_class($expected) . ' Object', 0, 5),
                    substr_replace($e->getActualAsString(), get_class($actual) . ' Object', 0, 5),
                    false,
                    'Failed asserting that two objects are equal.'
                );
            }
        }
    }

    /**
     * Converts an object to an array containing all of its private, protected
     * and public properties.
     *
     * @param  object $object
     * @return array
     */
    protected function toArray($object)
    {
        return $this->exporter->toArray($object);
    }
}
<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

/**
 * Compares resources for equality.
 */
class ResourceComparator extends Comparator
{
    /**
     * Returns whether the comparator can compare two values.
     *
     * @param  mixed $expected The first value to compare
     * @param  mixed $actual   The second value to compare
     * @return bool
     */
    public function accepts($expected, $actual)
    {
        return is_resource($expected) && is_resource($actual);
    }

    /**
     * Asserts that two values are equal.
     *
     * @param  mixed             $expected     The first value to compare
     * @param  mixed             $actual       The second value to compare
     * @param  float             $delta        The allowed numerical distance between two values to
     *                                         consider them equal
     * @param  bool              $canonicalize If set to TRUE, arrays are sorted before
     *                                         comparison
     * @param  bool              $ignoreCase   If set to TRUE, upper- and lowercasing is
     *                                         ignored when comparing string values
     * @throws ComparisonFailure Thrown when the comparison
     *                                        fails. Contains information about the
     *                                        specific errors that lead to the failure.
     */
    public function assertEquals($expected, $actual, $delta = 0.0, $canonicalize = false, $ignoreCase = false)
    {
        if ($actual != $expected) {
            throw new ComparisonFailure(
                $expected,
                $actual,
                $this->exporter->export($expected),
                $this->exporter->export($actual)
            );
        }
    }
}
<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

/**
 * Compares arrays for equality.
 */
class ArrayComparator extends Comparator
{
    /**
     * Returns whether the comparator can compare two values.
     *
     * @param  mixed $expected The first value to compare
     * @param  mixed $actual   The second value to compare
     * @return bool
     */
    public function accepts($expected, $actual)
    {
        return is_array($expected) && is_array($actual);
    }

    /**
     * Asserts that two values are equal.
     *
     * @param  mixed             $expected     The first value to compare
     * @param  mixed             $actual       The second value to compare
     * @param  float             $delta        The allowed numerical distance between two values to
     *                                         consider them equal
     * @param  bool              $canonicalize If set to TRUE, arrays are sorted before
     *                                         comparison
     * @param  bool              $ignoreCase   If set to TRUE, upper- and lowercasing is
     *                                         ignored when comparing string values
     * @param  array             $processed
     * @throws ComparisonFailure Thrown when the comparison
     *                                        fails. Contains information about the
     *                                        specific errors that lead to the failure.
     */
    public function assertEquals($expected, $actual, $delta = 0.0, $canonicalize = false, $ignoreCase = false, array &$processed = array())
    {
        if ($canonicalize) {
            sort($expected);
            sort($actual);
        }

        $remaining = $actual;
        $expString = $actString = "Array (\n";
        $equal     = true;

        foreach ($expected as $key => $value) {
            unset($remaining[$key]);

            if (!array_key_exists($key, $actual)) {
                $expString .= sprintf(
                    "    %s => %s\n",
                    $this->exporter->export($key),
                    $this->exporter->shortenedExport($value)
                );

                $equal = false;

                continue;
            }

            try {
                $comparator = $this->factory->getComparatorFor($value, $actual[$key]);
                $comparator->assertEquals($value, $actual[$key], $delta, $canonicalize, $ignoreCase, $processed);

                $expString .= sprintf(
                    "    %s => %s\n",
                    $this->exporter->export($key),
                    $this->exporter->shortenedExport($value)
                );
                $actString .= sprintf(
                    "    %s => %s\n",
                    $this->exporter->export($key),
                    $this->exporter->shortenedExport($actual[$key])
                );
            } catch (ComparisonFailure $e) {
                $expString .= sprintf(
                    "    %s => %s\n",
                    $this->exporter->export($key),
                    $e->getExpectedAsString()
                    ? $this->indent($e->getExpectedAsString())
                    : $this->exporter->shortenedExport($e->getExpected())
                );

                $actString .= sprintf(
                    "    %s => %s\n",
                    $this->exporter->export($key),
                    $e->getActualAsString()
                    ? $this->indent($e->getActualAsString())
                    : $this->exporter->shortenedExport($e->getActual())
                );

                $equal = false;
            }
        }

        foreach ($remaining as $key => $value) {
            $actString .= sprintf(
                "    %s => %s\n",
                $this->exporter->export($key),
                $this->exporter->shortenedExport($value)
            );

            $equal = false;
        }

        $expString .= ')';
        $actString .= ')';

        if (!$equal) {
            throw new ComparisonFailure(
                $expected,
                $actual,
                $expString,
                $actString,
                false,
                'Failed asserting that two arrays are equal.'
            );
        }
    }

    protected function indent($lines)
    {
        return trim(str_replace("\n", "\n    ", $lines));
    }
}
<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

/**
 * Compares DateTimeInterface instances for equality.
 */
class DateTimeComparator extends ObjectComparator
{
    /**
     * Returns whether the comparator can compare two values.
     *
     * @param  mixed $expected The first value to compare
     * @param  mixed $actual   The second value to compare
     * @return bool
     */
    public function accepts($expected, $actual)
    {
        return ($expected instanceof \DateTime || $expected instanceof \DateTimeInterface) &&
            ($actual instanceof \DateTime || $actual instanceof \DateTimeInterface);
    }

    /**
     * Asserts that two values are equal.
     *
     * @param  mixed             $expected     The first value to compare
     * @param  mixed             $actual       The second value to compare
     * @param  float             $delta        The allowed numerical distance between two values to
     *                                         consider them equal
     * @param  bool              $canonicalize If set to TRUE, arrays are sorted before
     *                                         comparison
     * @param  bool              $ignoreCase   If set to TRUE, upper- and lowercasing is
     *                                         ignored when comparing string values
     * @throws ComparisonFailure Thrown when the comparison
     *                                        fails. Contains information about the
     *                                        specific errors that lead to the failure.
     */
    public function assertEquals($expected, $actual, $delta = 0.0, $canonicalize = false, $ignoreCase = false)
    {
        $delta = new \DateInterval(sprintf('PT%sS', abs($delta)));

        $expectedLower = clone $expected;
        $expectedUpper = clone $expected;

        if ($actual < $expectedLower->sub($delta) ||
            $actual > $expectedUpper->add($delta)) {
            throw new ComparisonFailure(
                $expected,
                $actual,
                $this->dateTimeToString($expected),
                $this->dateTimeToString($actual),
                false,
                'Failed asserting that two DateTime objects are equal.'
            );
        }
    }

    /**
     * Returns an ISO 8601 formatted string representation of a datetime or
     * 'Invalid DateTimeInterface object' if the provided DateTimeInterface was not properly
     * initialized.
     *
     * @param  \DateTimeInterface $datetime
     * @return string
     */
    protected function dateTimeToString($datetime)
    {
        $string = $datetime->format(\DateTime::ISO8601);

        return $string ? $string : 'Invalid DateTimeInterface object';
    }
}
<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

/**
 * Compares Exception instances for equality.
 */
class ExceptionComparator extends ObjectComparator
{
    /**
     * Returns whether the comparator can compare two values.
     *
     * @param  mixed $expected The first value to compare
     * @param  mixed $actual   The second value to compare
     * @return bool
     */
    public function accepts($expected, $actual)
    {
        return $expected instanceof \Exception && $actual instanceof \Exception;
    }

    /**
     * Converts an object to an array containing all of its private, protected
     * and public properties.
     *
     * @param  object $object
     * @return array
     */
    protected function toArray($object)
    {
        $array = parent::toArray($object);

        unset(
            $array['file'],
            $array['line'],
            $array['trace'],
            $array['string'],
            $array['xdebug_message']
        );

        return $array;
    }
}
<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

use DOMDocument;
use DOMNode;

/**
 * Compares DOMNode instances for equality.
 */
class DOMNodeComparator extends ObjectComparator
{
    /**
     * Returns whether the comparator can compare two values.
     *
     * @param  mixed $expected The first value to compare
     * @param  mixed $actual   The second value to compare
     * @return bool
     */
    public function accepts($expected, $actual)
    {
        return $expected instanceof DOMNode && $actual instanceof DOMNode;
    }

    /**
     * Asserts that two values are equal.
     *
     * @param  mixed             $expected     The first value to compare
     * @param  mixed             $actual       The second value to compare
     * @param  float             $delta        The allowed numerical distance between two values to
     *                                         consider them equal
     * @param  bool              $canonicalize If set to TRUE, arrays are sorted before
     *                                         comparison
     * @param  bool              $ignoreCase   If set to TRUE, upper- and lowercasing is
     *                                         ignored when comparing string values
     * @throws ComparisonFailure Thrown when the comparison
     *                                        fails. Contains information about the
     *                                        specific errors that lead to the failure.
     */
    public function assertEquals($expected, $actual, $delta = 0.0, $canonicalize = false, $ignoreCase = false)
    {
        $expectedAsString = $this->nodeToText($expected, true, $ignoreCase);
        $actualAsString   = $this->nodeToText($actual, true, $ignoreCase);

        if ($expectedAsString !== $actualAsString) {
            if ($expected instanceof DOMDocument) {
                $type = 'documents';
            } else {
                $type = 'nodes';
            }

            throw new ComparisonFailure(
                $expected,
                $actual,
                $expectedAsString,
                $actualAsString,
                false,
                sprintf("Failed asserting that two DOM %s are equal.\n", $type)
            );
        }
    }

    /**
     * Returns the normalized, whitespace-cleaned, and indented textual
     * representation of a DOMNode.
     *
     * @param  DOMNode $node
     * @param  bool    $canonicalize
     * @param  bool    $ignoreCase
     * @return string
     */
    private function nodeToText(DOMNode $node, $canonicalize, $ignoreCase)
    {
        if ($canonicalize) {
            $document = new DOMDocument;
            $document->loadXML($node->C14N());

            $node = $document;
        }

        if ($node instanceof DOMDocument) {
            $document = $node;
        } else {
            $document = $node->ownerDocument;
        }

        $document->formatOutput = true;
        $document->normalizeDocument();

        if ($node instanceof DOMDocument) {
            $text = $node->saveXML();
        } else {
            $text = $document->saveXML($node);
        }

        if ($ignoreCase) {
            $text = strtolower($text);
        }

        return $text;
    }
}
<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

/**
 * Compares scalar or NULL values for equality.
 */
class ScalarComparator extends Comparator
{
    /**
     * Returns whether the comparator can compare two values.
     *
     * @param  mixed $expected The first value to compare
     * @param  mixed $actual   The second value to compare
     * @return bool
     * @since  Method available since Release 3.6.0
     */
    public function accepts($expected, $actual)
    {
        return ((is_scalar($expected) xor null === $expected) &&
               (is_scalar($actual) xor null === $actual))
               // allow comparison between strings and objects featuring __toString()
               || (is_string($expected) && is_object($actual) && method_exists($actual, '__toString'))
               || (is_object($expected) && method_exists($expected, '__toString') && is_string($actual));
    }

    /**
     * Asserts that two values are equal.
     *
     * @param  mixed             $expected     The first value to compare
     * @param  mixed             $actual       The second value to compare
     * @param  float             $delta        The allowed numerical distance between two values to
     *                                         consider them equal
     * @param  bool              $canonicalize If set to TRUE, arrays are sorted before
     *                                         comparison
     * @param  bool              $ignoreCase   If set to TRUE, upper- and lowercasing is
     *                                         ignored when comparing string values
     * @throws ComparisonFailure Thrown when the comparison
     *                                        fails. Contains information about the
     *                                        specific errors that lead to the failure.
     */
    public function assertEquals($expected, $actual, $delta = 0.0, $canonicalize = false, $ignoreCase = false)
    {
        $expectedToCompare = $expected;
        $actualToCompare   = $actual;

        // always compare as strings to avoid strange behaviour
        // otherwise 0 == 'Foobar'
        if (is_string($expected) || is_string($actual)) {
            $expectedToCompare = (string) $expectedToCompare;
            $actualToCompare   = (string) $actualToCompare;

            if ($ignoreCase) {
                $expectedToCompare = strtolower($expectedToCompare);
                $actualToCompare   = strtolower($actualToCompare);
            }
        }

        if ($expectedToCompare != $actualToCompare) {
            if (is_string($expected) && is_string($actual)) {
                throw new ComparisonFailure(
                    $expected,
                    $actual,
                    $this->exporter->export($expected),
                    $this->exporter->export($actual),
                    false,
                    'Failed asserting that two strings are equal.'
                );
            }

            throw new ComparisonFailure(
                $expected,
                $actual,
                // no diff is required
                '',
                '',
                false,
                sprintf(
                    'Failed asserting that %s matches expected %s.',
                    $this->exporter->export($actual),
                    $this->exporter->export($expected)
                )
            );
        }
    }
}
<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

/**
 * Compares PHPUnit_Framework_MockObject_MockObject instances for equality.
 */
class MockObjectComparator extends ObjectComparator
{
    /**
     * Returns whether the comparator can compare two values.
     *
     * @param  mixed $expected The first value to compare
     * @param  mixed $actual   The second value to compare
     * @return bool
     */
    public function accepts($expected, $actual)
    {
        return $expected instanceof \PHPUnit_Framework_MockObject_MockObject && $actual instanceof \PHPUnit_Framework_MockObject_MockObject;
    }

    /**
     * Converts an object to an array containing all of its private, protected
     * and public properties.
     *
     * @param  object $object
     * @return array
     */
    protected function toArray($object)
    {
        $array = parent::toArray($object);

        unset($array['__phpunit_invocationMocker']);

        return $array;
    }
}<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

/**
 * Compares numerical values for equality.
 */
class NumericComparator extends ScalarComparator
{
    /**
     * Returns whether the comparator can compare two values.
     *
     * @param  mixed $expected The first value to compare
     * @param  mixed $actual   The second value to compare
     * @return bool
     */
    public function accepts($expected, $actual)
    {
        // all numerical values, but not if one of them is a double
        // or both of them are strings
        return is_numeric($expected) && is_numeric($actual) &&
               !(is_double($expected) || is_double($actual)) &&
               !(is_string($expected) && is_string($actual));
    }

    /**
     * Asserts that two values are equal.
     *
     * @param  mixed             $expected     The first value to compare
     * @param  mixed             $actual       The second value to compare
     * @param  float             $delta        The allowed numerical distance between two values to
     *                                         consider them equal
     * @param  bool              $canonicalize If set to TRUE, arrays are sorted before
     *                                         comparison
     * @param  bool              $ignoreCase   If set to TRUE, upper- and lowercasing is
     *                                         ignored when comparing string values
     * @throws ComparisonFailure Thrown when the comparison
     *                                        fails. Contains information about the
     *                                        specific errors that lead to the failure.
     */
    public function assertEquals($expected, $actual, $delta = 0.0, $canonicalize = false, $ignoreCase = false)
    {
        if (is_infinite($actual) && is_infinite($expected)) {
            return;
        }

        if ((is_infinite($actual) xor is_infinite($expected)) ||
            (is_nan($actual) or is_nan($expected)) ||
            abs($actual - $expected) > $delta) {
            throw new ComparisonFailure(
                $expected,
                $actual,
                '',
                '',
                false,
                sprintf(
                    'Failed asserting that %s matches expected %s.',
                    $this->exporter->export($actual),
                    $this->exporter->export($expected)
                )
            );
        }
    }
}
<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

/**
 * Factory for comparators which compare values for equality.
 */
class Factory
{
    /**
     * @var Comparator[]
     */
    private $comparators = array();

    /**
     * @var Factory
     */
    private static $instance;

    /**
     * Constructs a new factory.
     */
    public function __construct()
    {
        $this->register(new TypeComparator);
        $this->register(new ScalarComparator);
        $this->register(new NumericComparator);
        $this->register(new DoubleComparator);
        $this->register(new ArrayComparator);
        $this->register(new ResourceComparator);
        $this->register(new ObjectComparator);
        $this->register(new ExceptionComparator);
        $this->register(new SplObjectStorageComparator);
        $this->register(new DOMNodeComparator);
        $this->register(new MockObjectComparator);
        $this->register(new DateTimeComparator);
    }

    /**
     * @return Factory
     */
    public static function getInstance()
    {
        if (self::$instance === null) {
            self::$instance = new self;
        }

        return self::$instance;
    }

    /**
     * Returns the correct comparator for comparing two values.
     *
     * @param  mixed      $expected The first value to compare
     * @param  mixed      $actual   The second value to compare
     * @return Comparator
     */
    public function getComparatorFor($expected, $actual)
    {
        foreach ($this->comparators as $comparator) {
            if ($comparator->accepts($expected, $actual)) {
                return $comparator;
            }
        }
    }

    /**
     * Registers a new comparator.
     *
     * This comparator will be returned by getInstance() if its accept() method
     * returns TRUE for the compared values. It has higher priority than the
     * existing comparators, meaning that its accept() method will be tested
     * before those of the other comparators.
     *
     * @param Comparator $comparator The registered comparator
     */
    public function register(Comparator $comparator)
    {
        array_unshift($this->comparators, $comparator);

        $comparator->setFactory($this);
    }

    /**
     * Unregisters a comparator.
     *
     * This comparator will no longer be returned by getInstance().
     *
     * @param Comparator $comparator The unregistered comparator
     */
    public function unregister(Comparator $comparator)
    {
        foreach ($this->comparators as $key => $_comparator) {
            if ($comparator === $_comparator) {
                unset($this->comparators[$key]);
            }
        }
    }
}
<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

/**
 * Compares doubles for equality.
 */
class DoubleComparator extends NumericComparator
{
    /**
     * Smallest value available in PHP.
     *
     * @var float
     */
    const EPSILON = 0.0000000001;

    /**
     * Returns whether the comparator can compare two values.
     *
     * @param  mixed $expected The first value to compare
     * @param  mixed $actual   The second value to compare
     * @return bool
     */
    public function accepts($expected, $actual)
    {
        return (is_double($expected) || is_double($actual)) && is_numeric($expected) && is_numeric($actual);
    }

    /**
     * Asserts that two values are equal.
     *
     * @param  mixed             $expected     The first value to compare
     * @param  mixed             $actual       The second value to compare
     * @param  float             $delta        The allowed numerical distance between two values to
     *                                         consider them equal
     * @param  bool              $canonicalize If set to TRUE, arrays are sorted before
     *                                         comparison
     * @param  bool              $ignoreCase   If set to TRUE, upper- and lowercasing is
     *                                         ignored when comparing string values
     * @throws ComparisonFailure Thrown when the comparison
     *                                        fails. Contains information about the
     *                                        specific errors that lead to the failure.
     */
    public function assertEquals($expected, $actual, $delta = 0.0, $canonicalize = false, $ignoreCase = false)
    {
        if ($delta == 0) {
            $delta = self::EPSILON;
        }

        parent::assertEquals($expected, $actual, $delta, $canonicalize, $ignoreCase);
    }
}
<?php
/*
 * This file is part of the Comparator package.
 *
 * (c) Sebastian Bergmann <sebastian@phpunit.de>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace SebastianBergmann\Comparator;

use SebastianBergmann\Diff\Differ;

/**
 * Thrown when an assertion for string equality failed.
 */
class ComparisonFailure extends \RuntimeException
{
    /**
     * Expected value of the retrieval which does not match $actual.
     * @var mixed
     */
    protected $expected;

    /**
     * Actually retrieved value which does not match $expected.
     * @var mixed
     */
    protected $actual;

    /**
     * The string representation of the expected value
     * @var string
     */
    protected $expectedAsString;

    /**
     * The string representation of the actual value
     * @var string
     */
    protected $actualAsString;

    /**
     * @var bool
     */
    protected $identical;

    /**
     * Optional message which is placed in front of the first line
     * returned by toString().
     * @var string
     */
    protected $message;

    /**
     * Initialises with the expected value and the actual value.
     *
     * @param mixed  $expected         Expected value retrieved.
     * @param mixed  $actual           Actual value retrieved.
     * @param string $expectedAsString
     * @param string $actualAsString
     * @param bool   $identical
     * @param string $message          A string which is prefixed on all returned lines
     *                                 in the difference output.
     */
    public function __construct($expected, $actual, $expectedAsString, $actualAsString, $identical = false, $message = '')
    {
        $this->expected         = $expected;
        $this->actual           = $actual;
        $this->expectedAsString = $expectedAsString;
        $this->actualAsString   = $actualAsString;
        $this->message          = $message;
    }

    /**
     * @return mixed
     */
    public function getActual()
    {
        return $this->actual;
    }

    /**
     * @return mixed
     */
    public function getExpected()
    {
        return $this->expected;
    }

    /**
     * @return string
     */
    public function getActualAsString()
    {
        return $this->actualAsString;
    }

    /**
     * @return string
     */
    public function getExpectedAsString()
    {
        return $this->expectedAsString;
    }

    /**
     * @return string
     */
    public function getDiff()
    {
        if (!$this->actualAsString && !$this->expectedAsString) {
            return '';
        }

        $differ = new Differ("\n--- Expected\n+++ Actual\n");

        return $differ->diff($this->expectedAsString, $this->actualAsString);
    }

    /**
     * @return string
     */
    public function toString()
    {
        return $this->message . $this->getDiff();
    }
}
Copyright (c) 2013 Konstantin Kudryashov <ever.zet@gmail.com>
                   Marcello Duarte <marcello.duarte@gmail.com>

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Prophecy;

/**
 * Prophecies revealer interface.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
interface RevealerInterface
{
    /**
     * Unwraps value(s).
     *
     * @param mixed $value
     *
     * @return mixed
     */
    public function reveal($value);
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Prophecy;

/**
 * Controllable doubles interface.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
interface ProphecySubjectInterface
{
    /**
     * Sets subject prophecy.
     *
     * @param ProphecyInterface $prophecy
     */
    public function setProphecy(ProphecyInterface $prophecy);

    /**
     * Returns subject prophecy.
     *
     * @return ProphecyInterface
     */
    public function getProphecy();
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Prophecy;

/**
 * Basic prophecies revealer.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class Revealer implements RevealerInterface
{
    /**
     * Unwraps value(s).
     *
     * @param mixed $value
     *
     * @return mixed
     */
    public function reveal($value)
    {
        if (is_array($value)) {
            return array_map(array($this, __FUNCTION__), $value);
        }

        if (!is_object($value)) {
            return $value;
        }

        if ($value instanceof ProphecyInterface) {
            $value = $value->reveal();
        }

        return $value;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Prophecy;

/**
 * Core Prophecy interface.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
interface ProphecyInterface
{
    /**
     * Reveals prophecy object (double) .
     *
     * @return object
     */
    public function reveal();
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Prophecy;

use SebastianBergmann\Comparator\ComparisonFailure;
use Prophecy\Comparator\Factory as ComparatorFactory;
use Prophecy\Call\Call;
use Prophecy\Doubler\LazyDouble;
use Prophecy\Argument\ArgumentsWildcard;
use Prophecy\Call\CallCenter;
use Prophecy\Exception\Prophecy\ObjectProphecyException;
use Prophecy\Exception\Prophecy\MethodProphecyException;
use Prophecy\Exception\Prediction\AggregateException;
use Prophecy\Exception\Prediction\PredictionException;

/**
 * Object prophecy.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class ObjectProphecy implements ProphecyInterface
{
    private $lazyDouble;
    private $callCenter;
    private $revealer;
    private $comparatorFactory;

    /**
     * @var MethodProphecy[][]
     */
    private $methodProphecies = array();

    /**
     * Initializes object prophecy.
     *
     * @param LazyDouble        $lazyDouble
     * @param CallCenter        $callCenter
     * @param RevealerInterface $revealer
     * @param ComparatorFactory $comparatorFactory
     */
    public function __construct(
        LazyDouble $lazyDouble,
        CallCenter $callCenter = null,
        RevealerInterface $revealer = null,
        ComparatorFactory $comparatorFactory = null
    ) {
        $this->lazyDouble = $lazyDouble;
        $this->callCenter = $callCenter ?: new CallCenter;
        $this->revealer   = $revealer ?: new Revealer;

        $this->comparatorFactory = $comparatorFactory ?: ComparatorFactory::getInstance();
    }

    /**
     * Forces double to extend specific class.
     *
     * @param string $class
     *
     * @return $this
     */
    public function willExtend($class)
    {
        $this->lazyDouble->setParentClass($class);

        return $this;
    }

    /**
     * Forces double to implement specific interface.
     *
     * @param string $interface
     *
     * @return $this
     */
    public function willImplement($interface)
    {
        $this->lazyDouble->addInterface($interface);

        return $this;
    }

    /**
     * Sets constructor arguments.
     *
     * @param array $arguments
     *
     * @return $this
     */
    public function willBeConstructedWith(array $arguments = null)
    {
        $this->lazyDouble->setArguments($arguments);

        return $this;
    }

    /**
     * Reveals double.
     *
     * @return object
     *
     * @throws \Prophecy\Exception\Prophecy\ObjectProphecyException If double doesn't implement needed interface
     */
    public function reveal()
    {
        $double = $this->lazyDouble->getInstance();

        if (null === $double || !$double instanceof ProphecySubjectInterface) {
            throw new ObjectProphecyException(
                "Generated double must implement ProphecySubjectInterface, but it does not.\n".
                'It seems you have wrongly configured doubler without required ClassPatch.',
                $this
            );
        }

        $double->setProphecy($this);

        return $double;
    }

    /**
     * Adds method prophecy to object prophecy.
     *
     * @param MethodProphecy $methodProphecy
     *
     * @throws \Prophecy\Exception\Prophecy\MethodProphecyException If method prophecy doesn't
     *                                                              have arguments wildcard
     */
    public function addMethodProphecy(MethodProphecy $methodProphecy)
    {
        $argumentsWildcard = $methodProphecy->getArgumentsWildcard();
        if (null === $argumentsWildcard) {
            throw new MethodProphecyException(sprintf(
                "Can not add prophecy for a method `%s::%s()`\n".
                "as you did not specify arguments wildcard for it.",
                get_class($this->reveal()),
                $methodProphecy->getMethodName()
            ), $methodProphecy);
        }

        $methodName = $methodProphecy->getMethodName();

        if (!isset($this->methodProphecies[$methodName])) {
            $this->methodProphecies[$methodName] = array();
        }

        $this->methodProphecies[$methodName][] = $methodProphecy;
    }

    /**
     * Returns either all or related to single method prophecies.
     *
     * @param null|string $methodName
     *
     * @return MethodProphecy[]
     */
    public function getMethodProphecies($methodName = null)
    {
        if (null === $methodName) {
            return $this->methodProphecies;
        }

        if (!isset($this->methodProphecies[$methodName])) {
            return array();
        }

        return $this->methodProphecies[$methodName];
    }

    /**
     * Makes specific method call.
     *
     * @param string $methodName
     * @param array  $arguments
     *
     * @return mixed
     */
    public function makeProphecyMethodCall($methodName, array $arguments)
    {
        $arguments = $this->revealer->reveal($arguments);
        $return    = $this->callCenter->makeCall($this, $methodName, $arguments);

        return $this->revealer->reveal($return);
    }

    /**
     * Finds calls by method name & arguments wildcard.
     *
     * @param string            $methodName
     * @param ArgumentsWildcard $wildcard
     *
     * @return Call[]
     */
    public function findProphecyMethodCalls($methodName, ArgumentsWildcard $wildcard)
    {
        return $this->callCenter->findCalls($methodName, $wildcard);
    }

    /**
     * Checks that registered method predictions do not fail.
     *
     * @throws \Prophecy\Exception\Prediction\AggregateException If any of registered predictions fail
     */
    public function checkProphecyMethodsPredictions()
    {
        $exception = new AggregateException(sprintf("%s:\n", get_class($this->reveal())));
        $exception->setObjectProphecy($this);

        foreach ($this->methodProphecies as $prophecies) {
            foreach ($prophecies as $prophecy) {
                try {
                    $prophecy->checkPrediction();
                } catch (PredictionException $e) {
                    $exception->append($e);
                }
            }
        }

        if (count($exception->getExceptions())) {
            throw $exception;
        }
    }

    /**
     * Creates new method prophecy using specified method name and arguments.
     *
     * @param string $methodName
     * @param array  $arguments
     *
     * @return MethodProphecy
     */
    public function __call($methodName, array $arguments)
    {
        $arguments = new ArgumentsWildcard($this->revealer->reveal($arguments));

        foreach ($this->getMethodProphecies($methodName) as $prophecy) {
            $argumentsWildcard = $prophecy->getArgumentsWildcard();
            $comparator = $this->comparatorFactory->getComparatorFor(
                $argumentsWildcard, $arguments
            );

            try {
                $comparator->assertEquals($argumentsWildcard, $arguments);
                return $prophecy;
            } catch (ComparisonFailure $failure) {}
        }

        return new MethodProphecy($this, $methodName, $arguments);
    }

    /**
     * Tries to get property value from double.
     *
     * @param string $name
     */
    public function __get($name)
    {
        return $this->reveal()->$name;
    }

    /**
     * Tries to set property value to double.
     *
     * @param string $name
     * @param string $value
     */
    public function __set($name, $value)
    {
        $this->reveal()->$name = $this->revealer->reveal($value);
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Prophecy;

use Prophecy\Argument;
use Prophecy\Prophet;
use Prophecy\Promise;
use Prophecy\Prediction;
use Prophecy\Exception\Doubler\MethodNotFoundException;
use Prophecy\Exception\InvalidArgumentException;
use Prophecy\Exception\Prophecy\MethodProphecyException;

/**
 * Method prophecy.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class MethodProphecy
{
    private $objectProphecy;
    private $methodName;
    private $argumentsWildcard;
    private $promise;
    private $prediction;
    private $checkedPredictions = array();
    private $bound = false;

    /**
     * Initializes method prophecy.
     *
     * @param ObjectProphecy                        $objectProphecy
     * @param string                                $methodName
     * @param null|Argument\ArgumentsWildcard|array $arguments
     *
     * @throws \Prophecy\Exception\Doubler\MethodNotFoundException If method not found
     */
    public function __construct(ObjectProphecy $objectProphecy, $methodName, $arguments = null)
    {
        $double = $objectProphecy->reveal();
        if (!method_exists($double, $methodName)) {
            throw new MethodNotFoundException(sprintf(
                'Method `%s::%s()` is not defined.', get_class($double), $methodName
            ), get_class($double), $methodName, $arguments);
        }

        $this->objectProphecy = $objectProphecy;
        $this->methodName     = $methodName;

        $reflectedMethod = new \ReflectionMethod($double, $methodName);
        if ($reflectedMethod->isFinal()) {
            throw new MethodProphecyException(sprintf(
                "Can not add prophecy for a method `%s::%s()`\n".
                "as it is a final method.",
                get_class($double),
                $methodName
            ), $this);
        }

        if (null !== $arguments) {
            $this->withArguments($arguments);
        }

        if (version_compare(PHP_VERSION, '7.0', '>=') && true === $reflectedMethod->hasReturnType()) {
            $type = (string) $reflectedMethod->getReturnType();
            $this->will(function () use ($type) {
                switch ($type) {
                    case 'string': return '';
                    case 'float':  return 0.0;
                    case 'int':    return 0;
                    case 'bool':   return false;
                    case 'array':  return array();

                    case 'callable':
                    case 'Closure':
                        return function () {};

                    case 'Traversable':
                    case 'Generator':
                        // Remove eval() when minimum version >=5.5
                        $generator = eval('return function () { yield; };');
                        return $generator();

                    default:
                        $prophet = new Prophet;
                        return $prophet->prophesize($type)->reveal();
                }
            });
        }
    }

    /**
     * Sets argument wildcard.
     *
     * @param array|Argument\ArgumentsWildcard $arguments
     *
     * @return $this
     *
     * @throws \Prophecy\Exception\InvalidArgumentException
     */
    public function withArguments($arguments)
    {
        if (is_array($arguments)) {
            $arguments = new Argument\ArgumentsWildcard($arguments);
        }

        if (!$arguments instanceof Argument\ArgumentsWildcard) {
            throw new InvalidArgumentException(sprintf(
                "Either an array or an instance of ArgumentsWildcard expected as\n".
                'a `MethodProphecy::withArguments()` argument, but got %s.',
                gettype($arguments)
            ));
        }

        $this->argumentsWildcard = $arguments;

        return $this;
    }

    /**
     * Sets custom promise to the prophecy.
     *
     * @param callable|Promise\PromiseInterface $promise
     *
     * @return $this
     *
     * @throws \Prophecy\Exception\InvalidArgumentException
     */
    public function will($promise)
    {
        if (is_callable($promise)) {
            $promise = new Promise\CallbackPromise($promise);
        }

        if (!$promise instanceof Promise\PromiseInterface) {
            throw new InvalidArgumentException(sprintf(
                'Expected callable or instance of PromiseInterface, but got %s.',
                gettype($promise)
            ));
        }

        $this->bindToObjectProphecy();
        $this->promise = $promise;

        return $this;
    }

    /**
     * Sets return promise to the prophecy.
     *
     * @see Prophecy\Promise\ReturnPromise
     *
     * @return $this
     */
    public function willReturn()
    {
        return $this->will(new Promise\ReturnPromise(func_get_args()));
    }

    /**
     * Sets return argument promise to the prophecy.
     *
     * @param int $index The zero-indexed number of the argument to return
     *
     * @see Prophecy\Promise\ReturnArgumentPromise
     *
     * @return $this
     */
    public function willReturnArgument($index = 0)
    {
        return $this->will(new Promise\ReturnArgumentPromise($index));
    }

    /**
     * Sets throw promise to the prophecy.
     *
     * @see Prophecy\Promise\ThrowPromise
     *
     * @param string|\Exception $exception Exception class or instance
     *
     * @return $this
     */
    public function willThrow($exception)
    {
        return $this->will(new Promise\ThrowPromise($exception));
    }

    /**
     * Sets custom prediction to the prophecy.
     *
     * @param callable|Prediction\PredictionInterface $prediction
     *
     * @return $this
     *
     * @throws \Prophecy\Exception\InvalidArgumentException
     */
    public function should($prediction)
    {
        if (is_callable($prediction)) {
            $prediction = new Prediction\CallbackPrediction($prediction);
        }

        if (!$prediction instanceof Prediction\PredictionInterface) {
            throw new InvalidArgumentException(sprintf(
                'Expected callable or instance of PredictionInterface, but got %s.',
                gettype($prediction)
            ));
        }

        $this->bindToObjectProphecy();
        $this->prediction = $prediction;

        return $this;
    }

    /**
     * Sets call prediction to the prophecy.
     *
     * @see Prophecy\Prediction\CallPrediction
     *
     * @return $this
     */
    public function shouldBeCalled()
    {
        return $this->should(new Prediction\CallPrediction);
    }

    /**
     * Sets no calls prediction to the prophecy.
     *
     * @see Prophecy\Prediction\NoCallsPrediction
     *
     * @return $this
     */
    public function shouldNotBeCalled()
    {
        return $this->should(new Prediction\NoCallsPrediction);
    }

    /**
     * Sets call times prediction to the prophecy.
     *
     * @see Prophecy\Prediction\CallTimesPrediction
     *
     * @param $count
     *
     * @return $this
     */
    public function shouldBeCalledTimes($count)
    {
        return $this->should(new Prediction\CallTimesPrediction($count));
    }

    /**
     * Checks provided prediction immediately.
     *
     * @param callable|Prediction\PredictionInterface $prediction
     *
     * @return $this
     *
     * @throws \Prophecy\Exception\InvalidArgumentException
     */
    public function shouldHave($prediction)
    {
        if (is_callable($prediction)) {
            $prediction = new Prediction\CallbackPrediction($prediction);
        }

        if (!$prediction instanceof Prediction\PredictionInterface) {
            throw new InvalidArgumentException(sprintf(
                'Expected callable or instance of PredictionInterface, but got %s.',
                gettype($prediction)
            ));
        }

        if (null === $this->promise) {
            $this->willReturn();
        }

        $calls = $this->getObjectProphecy()->findProphecyMethodCalls(
            $this->getMethodName(),
            $this->getArgumentsWildcard()
        );

        try {
            $prediction->check($calls, $this->getObjectProphecy(), $this);
            $this->checkedPredictions[] = $prediction;
        } catch (\Exception $e) {
            $this->checkedPredictions[] = $prediction;

            throw $e;
        }

        return $this;
    }

    /**
     * Checks call prediction.
     *
     * @see Prophecy\Prediction\CallPrediction
     *
     * @return $this
     */
    public function shouldHaveBeenCalled()
    {
        return $this->shouldHave(new Prediction\CallPrediction);
    }

    /**
     * Checks no calls prediction.
     *
     * @see Prophecy\Prediction\NoCallsPrediction
     *
     * @return $this
     */
    public function shouldNotHaveBeenCalled()
    {
        return $this->shouldHave(new Prediction\NoCallsPrediction);
    }

    /**
     * Checks no calls prediction.
     *
     * @see Prophecy\Prediction\NoCallsPrediction
     * @deprecated
     *
     * @return $this
     */
    public function shouldNotBeenCalled()
    {
        return $this->shouldNotHaveBeenCalled();
    }

    /**
     * Checks call times prediction.
     *
     * @see Prophecy\Prediction\CallTimesPrediction
     *
     * @param int $count
     *
     * @return $this
     */
    public function shouldHaveBeenCalledTimes($count)
    {
        return $this->shouldHave(new Prediction\CallTimesPrediction($count));
    }

    /**
     * Checks currently registered [with should(...)] prediction.
     */
    public function checkPrediction()
    {
        if (null === $this->prediction) {
            return;
        }

        $this->shouldHave($this->prediction);
    }

    /**
     * Returns currently registered promise.
     *
     * @return null|Promise\PromiseInterface
     */
    public function getPromise()
    {
        return $this->promise;
    }

    /**
     * Returns currently registered prediction.
     *
     * @return null|Prediction\PredictionInterface
     */
    public function getPrediction()
    {
        return $this->prediction;
    }

    /**
     * Returns predictions that were checked on this object.
     *
     * @return Prediction\PredictionInterface[]
     */
    public function getCheckedPredictions()
    {
        return $this->checkedPredictions;
    }

    /**
     * Returns object prophecy this method prophecy is tied to.
     *
     * @return ObjectProphecy
     */
    public function getObjectProphecy()
    {
        return $this->objectProphecy;
    }

    /**
     * Returns method name.
     *
     * @return string
     */
    public function getMethodName()
    {
        return $this->methodName;
    }

    /**
     * Returns arguments wildcard.
     *
     * @return Argument\ArgumentsWildcard
     */
    public function getArgumentsWildcard()
    {
        return $this->argumentsWildcard;
    }

    private function bindToObjectProphecy()
    {
        if ($this->bound) {
            return;
        }

        $this->getObjectProphecy()->addMethodProphecy($this);
        $this->bound = true;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Comparator;

use SebastianBergmann\Comparator\Comparator;
use SebastianBergmann\Comparator\ComparisonFailure;

/**
 * Closure comparator.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
final class ClosureComparator extends Comparator
{
    public function accepts($expected, $actual)
    {
        return is_object($expected) && $expected instanceof \Closure
            && is_object($actual) && $actual instanceof \Closure;
    }

    public function assertEquals($expected, $actual, $delta = 0.0, $canonicalize = false, $ignoreCase = false)
    {
        throw new ComparisonFailure(
            $expected,
            $actual,
            // we don't need a diff
            '',
            '',
            false,
            'all closures are born different'
        );
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Comparator;

use SebastianBergmann\Comparator\Factory as BaseFactory;

/**
 * Prophecy comparator factory.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
final class Factory extends BaseFactory
{
    /**
     * @var Factory
     */
    private static $instance;

    public function __construct()
    {
        parent::__construct();

        $this->register(new ClosureComparator());
    }

    /**
     * @return Factory
     */
    public static function getInstance()
    {
        if (self::$instance === null) {
            self::$instance = new Factory;
        }

        return self::$instance;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy;

use Prophecy\Argument\Token;

/**
 * Argument tokens shortcuts.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class Argument
{
    /**
     * Checks that argument is exact value or object.
     *
     * @param mixed $value
     *
     * @return Token\ExactValueToken
     */
    public static function exact($value)
    {
        return new Token\ExactValueToken($value);
    }

    /**
     * Checks that argument is of specific type or instance of specific class.
     *
     * @param string $type Type name (`integer`, `string`) or full class name
     *
     * @return Token\TypeToken
     */
    public static function type($type)
    {
        return new Token\TypeToken($type);
    }

    /**
     * Checks that argument object has specific state.
     *
     * @param string $methodName
     * @param mixed  $value
     *
     * @return Token\ObjectStateToken
     */
    public static function which($methodName, $value)
    {
        return new Token\ObjectStateToken($methodName, $value);
    }

    /**
     * Checks that argument matches provided callback.
     *
     * @param callable $callback
     *
     * @return Token\CallbackToken
     */
    public static function that($callback)
    {
        return new Token\CallbackToken($callback);
    }

    /**
     * Matches any single value.
     *
     * @return Token\AnyValueToken
     */
    public static function any()
    {
        return new Token\AnyValueToken;
    }

    /**
     * Matches all values to the rest of the signature.
     *
     * @return Token\AnyValuesToken
     */
    public static function cetera()
    {
        return new Token\AnyValuesToken;
    }

    /**
     * Checks that argument matches all tokens
     *
     * @param mixed ... a list of tokens
     *
     * @return Token\LogicalAndToken
     */
    public static function allOf()
    {
        return new Token\LogicalAndToken(func_get_args());
    }

    /**
     * Checks that argument array or countable object has exact number of elements.
     *
     * @param integer $value array elements count
     *
     * @return Token\ArrayCountToken
     */
    public static function size($value)
    {
        return new Token\ArrayCountToken($value);
    }

    /**
     * Checks that argument array contains (key, value) pair
     *
     * @param mixed $key   exact value or token
     * @param mixed $value exact value or token
     *
     * @return Token\ArrayEntryToken
     */
    public static function withEntry($key, $value)
    {
        return new Token\ArrayEntryToken($key, $value);
    }

    /**
     * Checks that arguments array entries all match value
     *
     * @param mixed $value
     *
     * @return Token\ArrayEveryEntryToken
     */
    public static function withEveryEntry($value)
    {
        return new Token\ArrayEveryEntryToken($value);
    }

    /**
     * Checks that argument array contains value
     *
     * @param mixed $value
     *
     * @return Token\ArrayEntryToken
     */
    public static function containing($value)
    {
        return new Token\ArrayEntryToken(self::any(), $value);
    }

    /**
     * Checks that argument array has key
     *
     * @param mixed $key exact value or token
     *
     * @return Token\ArrayEntryToken
     */
    public static function withKey($key)
    {
        return new Token\ArrayEntryToken($key, self::any());
    }

    /**
     * Checks that argument does not match the value|token.
     *
     * @param mixed $value either exact value or argument token
     *
     * @return Token\LogicalNotToken
     */
    public static function not($value)
    {
        return new Token\LogicalNotToken($value);
    }

    /**
     * @param string $value
     *
     * @return Token\StringContainsToken
     */
    public static function containingString($value)
    {
        return new Token\StringContainsToken($value);
    }

    /**
     * Checks that argument is identical value.
     *
     * @param mixed $value
     *
     * @return Token\IdenticalValueToken
     */
    public static function is($value)
    {
        return new Token\IdenticalValueToken($value);
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy;

use Prophecy\Doubler\Doubler;
use Prophecy\Doubler\LazyDouble;
use Prophecy\Doubler\ClassPatch;
use Prophecy\Prophecy\ObjectProphecy;
use Prophecy\Prophecy\RevealerInterface;
use Prophecy\Prophecy\Revealer;
use Prophecy\Call\CallCenter;
use Prophecy\Util\StringUtil;
use Prophecy\Exception\Prediction\PredictionException;
use Prophecy\Exception\Prediction\AggregateException;

/**
 * Prophet creates prophecies.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class Prophet
{
    private $doubler;
    private $revealer;
    private $util;

    /**
     * @var ObjectProphecy[]
     */
    private $prophecies = array();

    /**
     * Initializes Prophet.
     *
     * @param null|Doubler           $doubler
     * @param null|RevealerInterface $revealer
     * @param null|StringUtil        $util
     */
    public function __construct(Doubler $doubler = null, RevealerInterface $revealer = null,
                                StringUtil $util = null)
    {
        if (null === $doubler) {
            $doubler = new Doubler;
            $doubler->registerClassPatch(new ClassPatch\SplFileInfoPatch);
            $doubler->registerClassPatch(new ClassPatch\TraversablePatch);
            $doubler->registerClassPatch(new ClassPatch\DisableConstructorPatch);
            $doubler->registerClassPatch(new ClassPatch\ProphecySubjectPatch);
            $doubler->registerClassPatch(new ClassPatch\ReflectionClassNewInstancePatch);
            $doubler->registerClassPatch(new ClassPatch\HhvmExceptionPatch());
            $doubler->registerClassPatch(new ClassPatch\MagicCallPatch);
            $doubler->registerClassPatch(new ClassPatch\KeywordPatch);
        }

        $this->doubler  = $doubler;
        $this->revealer = $revealer ?: new Revealer;
        $this->util     = $util ?: new StringUtil;
    }

    /**
     * Creates new object prophecy.
     *
     * @param null|string $classOrInterface Class or interface name
     *
     * @return ObjectProphecy
     */
    public function prophesize($classOrInterface = null)
    {
        $this->prophecies[] = $prophecy = new ObjectProphecy(
            new LazyDouble($this->doubler),
            new CallCenter($this->util),
            $this->revealer
        );

        if ($classOrInterface && class_exists($classOrInterface)) {
            return $prophecy->willExtend($classOrInterface);
        }

        if ($classOrInterface && interface_exists($classOrInterface)) {
            return $prophecy->willImplement($classOrInterface);
        }

        return $prophecy;
    }

    /**
     * Returns all created object prophecies.
     *
     * @return ObjectProphecy[]
     */
    public function getProphecies()
    {
        return $this->prophecies;
    }

    /**
     * Returns Doubler instance assigned to this Prophet.
     *
     * @return Doubler
     */
    public function getDoubler()
    {
        return $this->doubler;
    }

    /**
     * Checks all predictions defined by prophecies of this Prophet.
     *
     * @throws Exception\Prediction\AggregateException If any prediction fails
     */
    public function checkPredictions()
    {
        $exception = new AggregateException("Some predictions failed:\n");
        foreach ($this->prophecies as $prophecy) {
            try {
                $prophecy->checkProphecyMethodsPredictions();
            } catch (PredictionException $e) {
                $exception->append($e);
            }
        }

        if (count($exception->getExceptions())) {
            throw $exception;
        }
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception;

/**
 * Core Prophecy exception interface.
 * All Prophecy exceptions implement it.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
interface Exception
{
    /**
     * @return string
     */
    public function getMessage();
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Prophecy;

use Prophecy\Prophecy\ObjectProphecy;

class ObjectProphecyException extends \RuntimeException implements ProphecyException
{
    private $objectProphecy;

    public function __construct($message, ObjectProphecy $objectProphecy)
    {
        parent::__construct($message);

        $this->objectProphecy = $objectProphecy;
    }

    /**
     * @return ObjectProphecy
     */
    public function getObjectProphecy()
    {
        return $this->objectProphecy;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Prophecy;

use Prophecy\Exception\Exception;

interface ProphecyException extends Exception
{
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Prophecy;

use Prophecy\Prophecy\MethodProphecy;

class MethodProphecyException extends ObjectProphecyException
{
    private $methodProphecy;

    public function __construct($message, MethodProphecy $methodProphecy)
    {
        parent::__construct($message, $methodProphecy->getObjectProphecy());

        $this->methodProphecy = $methodProphecy;
    }

    /**
     * @return MethodProphecy
     */
    public function getMethodProphecy()
    {
        return $this->methodProphecy;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Doubler;

class InterfaceNotFoundException extends ClassNotFoundException
{
    public function getInterfaceName()
    {
        return $this->getClassname();
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Doubler;

use ReflectionClass;

class ClassMirrorException extends \RuntimeException implements DoublerException
{
    private $class;

    public function __construct($message, ReflectionClass $class)
    {
        parent::__construct($message);

        $this->class = $class;
    }

    public function getReflectedClass()
    {
        return $this->class;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Doubler;

use RuntimeException;

class DoubleException extends RuntimeException implements DoublerException
{
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Doubler;

use Prophecy\Exception\Exception;

interface DoublerException extends Exception
{
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Doubler;

class MethodNotFoundException extends DoubleException
{
    /**
     * @var string
     */
    private $classname;

    /**
     * @var string
     */
    private $methodName;

    /**
     * @var array
     */
    private $arguments;

    /**
     * @param string $message
     * @param string $classname
     * @param string $methodName
     * @param null|Argument\ArgumentsWildcard|array $arguments
     */
    public function __construct($message, $classname, $methodName, $arguments = null)
    {
        parent::__construct($message);

        $this->classname  = $classname;
        $this->methodName = $methodName;
        $this->arguments = $arguments;
    }

    public function getClassname()
    {
        return $this->classname;
    }

    public function getMethodName()
    {
        return $this->methodName;
    }

    public function getArguments()
    {
        return $this->arguments;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Doubler;

class ReturnByReferenceException extends DoubleException
{
    private $classname;
    private $methodName;

    /**
     * @param string $message
     * @param string $classname
     * @param string $methodName
     */
    public function __construct($message, $classname, $methodName)
    {
        parent::__construct($message);

        $this->classname  = $classname;
        $this->methodName = $methodName;
    }

    public function getClassname()
    {
        return $this->classname;
    }

    public function getMethodName()
    {
        return $this->methodName;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Doubler;

use Prophecy\Doubler\Generator\Node\ClassNode;

class ClassCreatorException extends \RuntimeException implements DoublerException
{
    private $node;

    public function __construct($message, ClassNode $node)
    {
        parent::__construct($message);

        $this->node = $node;
    }

    public function getClassNode()
    {
        return $this->node;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Doubler;

class ClassNotFoundException extends DoubleException
{
    private $classname;

    /**
     * @param string $message
     * @param string $classname
     */
    public function __construct($message, $classname)
    {
        parent::__construct($message);

        $this->classname = $classname;
    }

    public function getClassname()
    {
        return $this->classname;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Prediction;

use Prophecy\Prophecy\MethodProphecy;
use Prophecy\Exception\Prophecy\MethodProphecyException;

class UnexpectedCallsException extends MethodProphecyException implements PredictionException
{
    private $calls = array();

    public function __construct($message, MethodProphecy $methodProphecy, array $calls)
    {
        parent::__construct($message, $methodProphecy);

        $this->calls = $calls;
    }

    public function getCalls()
    {
        return $this->calls;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Prediction;

use Prophecy\Exception\Exception;

interface PredictionException extends Exception
{
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Prediction;

use RuntimeException;

/**
 * Basic failed prediction exception.
 * Use it for custom prediction failures.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class FailedPredictionException extends RuntimeException implements PredictionException
{
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Prediction;

use Prophecy\Exception\Prophecy\MethodProphecyException;

class NoCallsException extends MethodProphecyException implements PredictionException
{
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Prediction;

use Prophecy\Prophecy\ObjectProphecy;

class AggregateException extends \RuntimeException implements PredictionException
{
    private $exceptions = array();
    private $objectProphecy;

    public function append(PredictionException $exception)
    {
        $message = $exception->getMessage();
        $message = '  '.strtr($message, array("\n" => "\n  "))."\n";

        $this->message      = rtrim($this->message.$message);
        $this->exceptions[] = $exception;
    }

    /**
     * @return PredictionException[]
     */
    public function getExceptions()
    {
        return $this->exceptions;
    }

    public function setObjectProphecy(ObjectProphecy $objectProphecy)
    {
        $this->objectProphecy = $objectProphecy;
    }

    /**
     * @return ObjectProphecy
     */
    public function getObjectProphecy()
    {
        return $this->objectProphecy;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Prediction;

use Prophecy\Prophecy\MethodProphecy;

class UnexpectedCallsCountException extends UnexpectedCallsException
{
    private $expectedCount;

    public function __construct($message, MethodProphecy $methodProphecy, $count, array $calls)
    {
        parent::__construct($message, $methodProphecy, $calls);

        $this->expectedCount = intval($count);
    }

    public function getExpectedCount()
    {
        return $this->expectedCount;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception\Call;

use Prophecy\Exception\Prophecy\ObjectProphecyException;
use Prophecy\Prophecy\ObjectProphecy;

class UnexpectedCallException extends ObjectProphecyException
{
    private $methodName;
    private $arguments;

    public function __construct($message, ObjectProphecy $objectProphecy,
                                $methodName, array $arguments)
    {
        parent::__construct($message, $objectProphecy);

        $this->methodName = $methodName;
        $this->arguments = $arguments;
    }

    public function getMethodName()
    {
        return $this->methodName;
    }

    public function getArguments()
    {
        return $this->arguments;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Exception;

class InvalidArgumentException extends \InvalidArgumentException implements Exception
{
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Doubler;

use ReflectionClass;

/**
 * Cached class doubler.
 * Prevents mirroring/creation of the same structure twice.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class CachedDoubler extends Doubler
{
    private $classes = array();

    /**
     * {@inheritdoc}
     */
    public function registerClassPatch(ClassPatch\ClassPatchInterface $patch)
    {
        $this->classes[] = array();

        parent::registerClassPatch($patch);
    }

    /**
     * {@inheritdoc}
     */
    protected function createDoubleClass(ReflectionClass $class = null, array $interfaces)
    {
        $classId = $this->generateClassId($class, $interfaces);
        if (isset($this->classes[$classId])) {
            return $this->classes[$classId];
        }

        return $this->classes[$classId] = parent::createDoubleClass($class, $interfaces);
    }

    /**
     * @param ReflectionClass   $class
     * @param ReflectionClass[] $interfaces
     *
     * @return string
     */
    private function generateClassId(ReflectionClass $class = null, array $interfaces)
    {
        $parts = array();
        if (null !== $class) {
            $parts[] = $class->getName();
        }
        foreach ($interfaces as $interface) {
            $parts[] = $interface->getName();
        }
        sort($parts);

        return md5(implode('', $parts));
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Doubler;

/**
 * Core double interface.
 * All doubled classes will implement this one.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
interface DoubleInterface
{
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Doubler;

use Doctrine\Instantiator\Instantiator;
use Prophecy\Doubler\ClassPatch\ClassPatchInterface;
use Prophecy\Doubler\Generator\ClassMirror;
use Prophecy\Doubler\Generator\ClassCreator;
use Prophecy\Exception\InvalidArgumentException;
use ReflectionClass;

/**
 * Cached class doubler.
 * Prevents mirroring/creation of the same structure twice.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class Doubler
{
    private $mirror;
    private $creator;
    private $namer;

    /**
     * @var ClassPatchInterface[]
     */
    private $patches = array();

    /**
     * @var \Doctrine\Instantiator\Instantiator
     */
    private $instantiator;

    /**
     * Initializes doubler.
     *
     * @param ClassMirror   $mirror
     * @param ClassCreator  $creator
     * @param NameGenerator $namer
     */
    public function __construct(ClassMirror $mirror = null, ClassCreator $creator = null,
                                NameGenerator $namer = null)
    {
        $this->mirror  = $mirror  ?: new ClassMirror;
        $this->creator = $creator ?: new ClassCreator;
        $this->namer   = $namer   ?: new NameGenerator;
    }

    /**
     * Returns list of registered class patches.
     *
     * @return ClassPatchInterface[]
     */
    public function getClassPatches()
    {
        return $this->patches;
    }

    /**
     * Registers new class patch.
     *
     * @param ClassPatchInterface $patch
     */
    public function registerClassPatch(ClassPatchInterface $patch)
    {
        $this->patches[] = $patch;

        @usort($this->patches, function (ClassPatchInterface $patch1, ClassPatchInterface $patch2) {
            return $patch2->getPriority() - $patch1->getPriority();
        });
    }

    /**
     * Creates double from specific class or/and list of interfaces.
     *
     * @param ReflectionClass   $class
     * @param ReflectionClass[] $interfaces Array of ReflectionClass instances
     * @param array             $args       Constructor arguments
     *
     * @return DoubleInterface
     *
     * @throws \Prophecy\Exception\InvalidArgumentException
     */
    public function double(ReflectionClass $class = null, array $interfaces, array $args = null)
    {
        foreach ($interfaces as $interface) {
            if (!$interface instanceof ReflectionClass) {
                throw new InvalidArgumentException(sprintf(
                    "[ReflectionClass \$interface1 [, ReflectionClass \$interface2]] array expected as\n".
                    "a second argument to `Doubler::double(...)`, but got %s.",
                    is_object($interface) ? get_class($interface).' class' : gettype($interface)
                ));
            }
        }

        $classname  = $this->createDoubleClass($class, $interfaces);
        $reflection = new ReflectionClass($classname);

        if (null !== $args) {
            return $reflection->newInstanceArgs($args);
        }
        if ((null === $constructor = $reflection->getConstructor())
            || ($constructor->isPublic() && !$constructor->isFinal())) {
            return $reflection->newInstance();
        }

        if (!$this->instantiator) {
            $this->instantiator = new Instantiator();
        }

        return $this->instantiator->instantiate($classname);
    }

    /**
     * Creates double class and returns its FQN.
     *
     * @param ReflectionClass   $class
     * @param ReflectionClass[] $interfaces
     *
     * @return string
     */
    protected function createDoubleClass(ReflectionClass $class = null, array $interfaces)
    {
        $name = $this->namer->name($class, $interfaces);
        $node = $this->mirror->reflect($class, $interfaces);

        foreach ($this->patches as $patch) {
            if ($patch->supports($node)) {
                $patch->apply($node);
            }
        }

        $this->creator->create($name, $node);

        return $name;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Doubler\Generator;

/**
 * Class code creator.
 * Generates PHP code for specific class node tree.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class ClassCodeGenerator
{
    /**
     * Generates PHP code for class node.
     *
     * @param string         $classname
     * @param Node\ClassNode $class
     *
     * @return string
     */
    public function generate($classname, Node\ClassNode $class)
    {
        $parts     = explode('\\', $classname);
        $classname = array_pop($parts);
        $namespace = implode('\\', $parts);

        $code = sprintf("class %s extends \%s implements %s {\n",
            $classname, $class->getParentClass(), implode(', ',
                array_map(function ($interface) {return '\\'.$interface;}, $class->getInterfaces())
            )
        );

        foreach ($class->getProperties() as $name => $visibility) {
            $code .= sprintf("%s \$%s;\n", $visibility, $name);
        }
        $code .= "\n";

        foreach ($class->getMethods() as $method) {
            $code .= $this->generateMethod($method)."\n";
        }
        $code .= "\n}";

        return sprintf("namespace %s {\n%s\n}", $namespace, $code);
    }

    private function generateMethod(Node\MethodNode $method)
    {
        $php = sprintf("%s %s function %s%s(%s)%s {\n",
            $method->getVisibility(),
            $method->isStatic() ? 'static' : '',
            $method->returnsReference() ? '&':'',
            $method->getName(),
            implode(', ', $this->generateArguments($method->getArguments())),
            $method->hasReturnType() ? sprintf(': %s', $method->getReturnType()) : ''
        );
        $php .= $method->getCode()."\n";

        return $php.'}';
    }

    private function generateArguments(array $arguments)
    {
        return array_map(function (Node\ArgumentNode $argument) {
            $php = '';

            if ($hint = $argument->getTypeHint()) {
                if ('array' === $hint || 'callable' === $hint) {
                    $php .= $hint;
                } else {
                    $php .= '\\'.$hint;
                }
            }

            $php .= ' '.($argument->isPassedByReference() ? '&' : '').'$'.$argument->getName();

            if ($argument->isOptional()) {
                $php .= ' = '.var_export($argument->getDefault(), true);
            }

            return $php;
        }, $arguments);
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Doubler\Generator;

use Prophecy\Exception\Doubler\ClassCreatorException;

/**
 * Class creator.
 * Creates specific class in current environment.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class ClassCreator
{
    private $generator;

    /**
     * Initializes creator.
     *
     * @param ClassCodeGenerator $generator
     */
    public function __construct(ClassCodeGenerator $generator = null)
    {
        $this->generator = $generator ?: new ClassCodeGenerator;
    }

    /**
     * Creates class.
     *
     * @param string         $classname
     * @param Node\ClassNode $class
     *
     * @return mixed
     *
     * @throws \Prophecy\Exception\Doubler\ClassCreatorException
     */
    public function create($classname, Node\ClassNode $class)
    {
        $code = $this->generator->generate($classname, $class);
        $return = eval($code);

        if (!class_exists($classname, false)) {
            if (count($class->getInterfaces())) {
                throw new ClassCreatorException(sprintf(
                    'Could not double `%s` and implement interfaces: [%s].',
                    $class->getParentClass(), implode(', ', $class->getInterfaces())
                ), $class);
            }

            throw new ClassCreatorException(
                sprintf('Could not double `%s`.', $class->getParentClass()),
                $class
            );
        }

        return $return;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Doubler\Generator;

/**
 * Reflection interface.
 * All reflected classes implement this interface.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
interface ReflectionInterface
{
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Doubler\Generator;

use Prophecy\Exception\InvalidArgumentException;
use Prophecy\Exception\Doubler\ClassMirrorException;
use ReflectionClass;
use ReflectionMethod;
use ReflectionParameter;

/**
 * Class mirror.
 * Core doubler class. Mirrors specific class and/or interfaces into class node tree.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class ClassMirror
{
    private static $reflectableMethods = array(
        '__construct',
        '__destruct',
        '__sleep',
        '__wakeup',
        '__toString',
        '__call',
    );

    /**
     * Reflects provided arguments into class node.
     *
     * @param ReflectionClass   $class
     * @param ReflectionClass[] $interfaces
     *
     * @return Node\ClassNode
     *
     * @throws \Prophecy\Exception\InvalidArgumentException
     */
    public function reflect(ReflectionClass $class = null, array $interfaces)
    {
        $node = new Node\ClassNode;

        if (null !== $class) {
            if (true === $class->isInterface()) {
                throw new InvalidArgumentException(sprintf(
                    "Could not reflect %s as a class, because it\n".
                    "is interface - use the second argument instead.",
                    $class->getName()
                ));
            }

            $this->reflectClassToNode($class, $node);
        }

        foreach ($interfaces as $interface) {
            if (!$interface instanceof ReflectionClass) {
                throw new InvalidArgumentException(sprintf(
                    "[ReflectionClass \$interface1 [, ReflectionClass \$interface2]] array expected as\n".
                    "a second argument to `ClassMirror::reflect(...)`, but got %s.",
                    is_object($interface) ? get_class($interface).' class' : gettype($interface)
                ));
            }
            if (false === $interface->isInterface()) {
                throw new InvalidArgumentException(sprintf(
                    "Could not reflect %s as an interface, because it\n".
                    "is class - use the first argument instead.",
                    $interface->getName()
                ));
            }

            $this->reflectInterfaceToNode($interface, $node);
        }

        $node->addInterface('Prophecy\Doubler\Generator\ReflectionInterface');

        return $node;
    }

    private function reflectClassToNode(ReflectionClass $class, Node\ClassNode $node)
    {
        if (true === $class->isFinal()) {
            throw new ClassMirrorException(sprintf(
                'Could not reflect class %s as it is marked final.', $class->getName()
            ), $class);
        }

        $node->setParentClass($class->getName());

        foreach ($class->getMethods(ReflectionMethod::IS_ABSTRACT) as $method) {
            if (false === $method->isProtected()) {
                continue;
            }

            $this->reflectMethodToNode($method, $node);
        }

        foreach ($class->getMethods(ReflectionMethod::IS_PUBLIC) as $method) {
            if (0 === strpos($method->getName(), '_')
                && !in_array($method->getName(), self::$reflectableMethods)) {
                continue;
            }

            if (true === $method->isFinal()) {
                continue;
            }

            $this->reflectMethodToNode($method, $node);
        }
    }

    private function reflectInterfaceToNode(ReflectionClass $interface, Node\ClassNode $node)
    {
        $node->addInterface($interface->getName());

        foreach ($interface->getMethods() as $method) {
            $this->reflectMethodToNode($method, $node);
        }
    }

    private function reflectMethodToNode(ReflectionMethod $method, Node\ClassNode $classNode)
    {
        $node = new Node\MethodNode($method->getName());

        if (true === $method->isProtected()) {
            $node->setVisibility('protected');
        }

        if (true === $method->isStatic()) {
            $node->setStatic();
        }

        if (true === $method->returnsReference()) {
            $node->setReturnsReference();
        }

        if (version_compare(PHP_VERSION, '7.0', '>=') && true === $method->hasReturnType()) {
            $node->setReturnType((string) $method->getReturnType());
        }

        if (is_array($params = $method->getParameters()) && count($params)) {
            foreach ($params as $param) {
                $this->reflectArgumentToNode($param, $node);
            }
        }

        $classNode->addMethod($node);
    }

    private function reflectArgumentToNode(ReflectionParameter $parameter, Node\MethodNode $methodNode)
    {
        $name = $parameter->getName() == '...' ? '__dot_dot_dot__' : $parameter->getName();
        $node = new Node\ArgumentNode($name);

        $typeHint = $this->getTypeHint($parameter);
        $node->setTypeHint($typeHint);

        if (true === $parameter->isDefaultValueAvailable()) {
            $node->setDefault($parameter->getDefaultValue());
        } elseif (true === $parameter->isOptional()
              || (true === $parameter->allowsNull() && $typeHint)) {
            $node->setDefault(null);
        }

        if (true === $parameter->isPassedByReference()) {
            $node->setAsPassedByReference();
        }

        $methodNode->addArgument($node);
    }

    private function getTypeHint(ReflectionParameter $parameter)
    {
        if (null !== $className = $this->getParameterClassName($parameter)) {
            return $className;
        }

        if (true === $parameter->isArray()) {
            return 'array';
        }

        if (version_compare(PHP_VERSION, '5.4', '>=') && true === $parameter->isCallable()) {
            return 'callable';
        }

        if (version_compare(PHP_VERSION, '7.0', '>=') && true === $parameter->hasType()) {
            return (string) $parameter->getType();
        }

        return null;
    }

    private function getParameterClassName(ReflectionParameter $parameter)
    {
        try {
            return $parameter->getClass() ? $parameter->getClass()->getName() : null;
        } catch (\ReflectionException $e) {
            preg_match('/\[\s\<\w+?>\s([\w,\\\]+)/s', $parameter, $matches);

            return isset($matches[1]) ? $matches[1] : null;
        }
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Doubler\Generator\Node;

/**
 * Argument node.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class ArgumentNode
{
    private $name;
    private $typeHint;
    private $default;
    private $optional    = false;
    private $byReference = false;

    /**
     * @param string $name
     */
    public function __construct($name)
    {
        $this->name = $name;
    }

    public function getName()
    {
        return $this->name;
    }

    public function getTypeHint()
    {
        return $this->typeHint;
    }

    public function setTypeHint($typeHint = null)
    {
        $this->typeHint = $typeHint;
    }

    public function getDefault()
    {
        return $this->default;
    }

    public function setDefault($default = null)
    {
        $this->optional = true;
        $this->default  = $default;
    }

    public function isOptional()
    {
        return $this->optional;
    }

    public function setAsPassedByReference($byReference = true)
    {
        $this->byReference = $byReference;
    }

    public function isPassedByReference()
    {
        return $this->byReference;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Doubler\Generator\Node;

use Prophecy\Exception\InvalidArgumentException;

/**
 * Method node.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class MethodNode
{
    private $name;
    private $code;
    private $visibility = 'public';
    private $static = false;
    private $returnsReference = false;
    private $returnType;

    /**
     * @var ArgumentNode[]
     */
    private $arguments = array();

    /**
     * @param string $name
     * @param string $code
     */
    public function __construct($name, $code = null)
    {
        $this->name = $name;
        $this->code = $code;
    }

    public function getVisibility()
    {
        return $this->visibility;
    }

    /**
     * @param string $visibility
     */
    public function setVisibility($visibility)
    {
        $visibility = strtolower($visibility);

        if (!in_array($visibility, array('public', 'private', 'protected'))) {
            throw new InvalidArgumentException(sprintf(
                '`%s` method visibility is not supported.', $visibility
            ));
        }

        $this->visibility = $visibility;
    }

    public function isStatic()
    {
        return $this->static;
    }

    public function setStatic($static = true)
    {
        $this->static = (bool) $static;
    }

    public function returnsReference()
    {
        return $this->returnsReference;
    }

    public function setReturnsReference()
    {
        $this->returnsReference = true;
    }

    public function getName()
    {
        return $this->name;
    }

    public function addArgument(ArgumentNode $argument)
    {
        $this->arguments[] = $argument;
    }

    /**
     * @return ArgumentNode[]
     */
    public function getArguments()
    {
        return $this->arguments;
    }

    public function hasReturnType()
    {
        return null !== $this->returnType;
    }

    /**
     * @param string $type
     */
    public function setReturnType($type = null)
    {
        switch ($type) {
            case '':
                $this->returnType = null;
                break;

            case 'string';
            case 'float':
            case 'int':
            case 'bool':
            case 'array':
            case 'callable':
                $this->returnType = $type;
                break;

            case 'double':
            case 'real':
                $this->returnType = 'float';
                break;

            case 'boolean':
                $this->returnType = 'bool';
                break;

            case 'integer':
                $this->returnType = 'int';
                break;

            default:
                $this->returnType = '\\' . ltrim($type, '\\');
        }
    }

    public function getReturnType()
    {
        return $this->returnType;
    }

    /**
     * @param string $code
     */
    public function setCode($code)
    {
        $this->code = $code;
    }

    public function getCode()
    {
        if ($this->returnsReference)
        {
            return "throw new \Prophecy\Exception\Doubler\ReturnByReferenceException('Returning by reference not supported', get_class(\$this), '{$this->name}');";
        }

        return (string) $this->code;
    }

    public function useParentCode()
    {
        $this->code = sprintf(
            'return parent::%s(%s);', $this->getName(), implode(', ',
                array_map(function (ArgumentNode $arg) { return '$'.$arg->getName(); }, $this->arguments)
            )
        );
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Doubler\Generator\Node;

use Prophecy\Exception\InvalidArgumentException;

/**
 * Class node.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class ClassNode
{
    private $parentClass = 'stdClass';
    private $interfaces  = array();
    private $properties  = array();

    /**
     * @var MethodNode[]
     */
    private $methods     = array();

    public function getParentClass()
    {
        return $this->parentClass;
    }

    /**
     * @param string $class
     */
    public function setParentClass($class)
    {
        $this->parentClass = $class ?: 'stdClass';
    }

    /**
     * @return string[]
     */
    public function getInterfaces()
    {
        return $this->interfaces;
    }

    /**
     * @param string $interface
     */
    public function addInterface($interface)
    {
        if ($this->hasInterface($interface)) {
            return;
        }

        array_unshift($this->interfaces, $interface);
    }

    /**
     * @param string $interface
     *
     * @return bool
     */
    public function hasInterface($interface)
    {
        return in_array($interface, $this->interfaces);
    }

    public function getProperties()
    {
        return $this->properties;
    }

    public function addProperty($name, $visibility = 'public')
    {
        $visibility = strtolower($visibility);

        if (!in_array($visibility, array('public', 'private', 'protected'))) {
            throw new InvalidArgumentException(sprintf(
                '`%s` property visibility is not supported.', $visibility
            ));
        }

        $this->properties[$name] = $visibility;
    }

    /**
     * @return MethodNode[]
     */
    public function getMethods()
    {
        return $this->methods;
    }

    public function addMethod(MethodNode $method)
    {
        $this->methods[$method->getName()] = $method;
    }

    public function removeMethod($name)
    {
        unset($this->methods[$name]);
    }

    /**
     * @param string $name
     *
     * @return MethodNode|null
     */
    public function getMethod($name)
    {
        return $this->hasMethod($name) ? $this->methods[$name] : null;
    }

    /**
     * @param string $name
     *
     * @return bool
     */
    public function hasMethod($name)
    {
        return isset($this->methods[$name]);
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Doubler;

use Prophecy\Exception\Doubler\DoubleException;
use Prophecy\Exception\Doubler\ClassNotFoundException;
use Prophecy\Exception\Doubler\InterfaceNotFoundException;
use ReflectionClass;

/**
 * Lazy double.
 * Gives simple interface to describe double before creating it.
 *
 * @author Konstantin Kudryashov <ever.zet@gmail.com>
 */
class LazyDouble
{
    private $doubler;
    private $class;
    private $interfaces = array();
    private $arguments  = null;
    private $double;

    /**
     * Initializes lazy double.
     *
     * @param Doubler $doubler
     */
    public function __construct(Doubler $doubler)
    {
        $this->doubler = $doubler;
    }

    /**
     * Tells doubler to use specific class as parent one for double.
     *
     * @param string|ReflectionClass $class
     *
     * @throws \Prophecy\Exception\Doubler\ClassNotFoundException
     * @throws \Prophecy\Exception\Doubler\DoubleException
     */
    public function setParentClass($class)
    {
        if (null !== $this->double) {
            throw new DoubleException('Can not extend class with already instantiated double.');
        }

        if (!$class instanceof ReflectionClass) {
            if (!class_exists($class)) {
                throw new ClassNotFoundException(sprintf('Class %s not found.', $class), $class);
            }

            $class = new ReflectionClass($class);
        }

        $this->class = $class;
    }

    /**
     * Tells doubler to implement specific interface with double.
     *
     * @param string|ReflectionClass $interface
     *
     * @throws \Prophecy\Exception\Doubler\InterfaceNotFoundException
     * @throws \Prophecy\Exception\Doubler\DoubleException
     */
    public function addInterface($interface)
    {
        if (null !== $this->double) {
            throw new DoubleException(
                'Can not implement interface with already instantiated double.'
            );
        }

        if (!$interface instanceof ReflectionClass) {
            if (!interface_exists($interface)) {
                throw new InterfaceNotFoundException(
                    sprintf('Interface %s not found.', $interface),
                    $interface
                );
            }

            $interface = new ReflectionClass($interface);
        }

        $this->interfaces[] = $interface;
    }

    /**
     * Sets constructor arguments.
     *
     * @param array $arguments
     */
    public function setArguments(array $arguments = null)
    {
        $this->arguments = $arguments;
    }

    /**
     * Creates double instance or returns already created one.
     *
     * @return DoubleInterface
     */
    public function getInstance()
    {
        if (null === $this->double) {
            if (null !== $this->arguments) {
                return $this->double = $this->doubler->double(
                    $this->class, $this->interfaces, $this->arguments
                );
            }

            $this->double = $this->doubler->double($this->class, $this->interfaces);
        }

        return $this->double;
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace Prophecy\Doubler\ClassPatch;

use Prophecy\Doubler\Generator\Node\ClassNode;

/**
 * Remove method functionality from the double which will clash with php keywords.
 *
 * @author Milan Magudia <milan@magudia.com>
 */
class KeywordPatch implements ClassPatchInterface
{
    /**
     * Support any class
     *
     * @param ClassNode $node
     *
     * @return boolean
     */
    public function supports(ClassNode $node)
    {
        return true;
    }

    /**
     * Remove methods that clash with php keywords
     *
     * @param ClassNode $node
     */
    public function apply(ClassNode $node)
    {
        $methodNames = array_keys($node->getMethods());
        $methodsToRemove = array_intersect($methodNames, $this->getKeywords());
        foreach ($methodsToRemove as $methodName) {
            $node->removeMethod($methodName);
        }
    }

    /**
     * Returns patch priority, which determines when patch will be applied.
     *
     * @return int Priority number (higher - earlier)
     */
    public function getPriority() {
        return 49;
    }

    /**
     * Returns array of php keywords.
     *
     * @return array
     */
    private function getKeywords() {

        return array(
            '__halt_compiler',
            'abstract',
            'and',
            'array',
            'as',
            'break',
            'callable',
            'case',
            'catch',
            'class',
            'clone',
            'const',
            'continue',
            'declare',
            'default',
            'die',
            'do',
            'echo',
            'else',
            'elseif',
            'empty',
            'enddeclare',
            'endfor',
            'endforeach',
            'endif',
            'endswitch',
            'endwhile',
            'eval',
            'exit',
            'extends',
            'final',
            'finally',
            'for',
            'foreach',
            'function',
            'global',
            'goto',
            'if',
            'implements',
            'include',
            'include_once',
            'instanceof',
            'insteadof',
            'interface',
            'isset',
            'list',
            'namespace',
            'new',
            'or',
            'print',
            'private',
            'protected',
            'public',
            'require',
            'require_once',
            'return',
            'static',
            'switch',
            'throw',
            'trait',
            'try',
            'unset',
            'use',
            'var',
            'while',
            'xor',
            'yield',
        );
    }
}
<?php

/*
 * This file is part of the Prophecy.
 * (c) Konstantin Kudryashov <ever.zet@gmail.com>
 *     Marcello Duarte <marcello.duarte@gmail.com>
 *
 * For t